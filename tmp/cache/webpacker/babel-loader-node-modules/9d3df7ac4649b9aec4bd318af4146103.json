{"ast":null,"code":"/*!\n * bootstrap-fileinput v4.3.5\n * http://plugins.krajee.com/file-input\n *\n * Author: Kartik Visweswaran\n * Copyright: 2014 - 2016, Kartik Visweswaran, Krajee.com\n *\n * Licensed under the BSD 3-Clause\n * https://github.com/kartik-v/bootstrap-fileinput/blob/master/LICENSE.md\n */\n(function (factory) {\n  \"use strict\"; //noinspection JSUnresolvedVariable\n\n  if (typeof define === 'function' && define.amd) {\n    // jshint ignore:line\n    // AMD. Register as an anonymous module.\n    define(['jquery'], factory); // jshint ignore:line\n  } else {\n    // noinspection JSUnresolvedVariable\n    if (typeof module === 'object' && module.exports) {\n      // jshint ignore:line\n      // Node/CommonJS\n      // noinspection JSUnresolvedVariable\n      module.exports = factory(require('jquery')); // jshint ignore:line\n    } else {\n      // Browser globals\n      factory(window.jQuery);\n    }\n  }\n})(function ($) {\n  \"use strict\";\n\n  $.fn.fileinputLocales = {};\n  $.fn.fileinputThemes = {};\n  var NAMESPACE, MODAL_ID, STYLE_SETTING, OBJECT_PARAMS, DEFAULT_PREVIEW, objUrl, compare, isIE, handler, previewCache, getNum, hasFileAPISupport, hasDragDropSupport, hasFileUploadSupport, addCss, tMain1, tMain2, tPreview, tFileIcon, tClose, tCaption, tBtnDefault, tBtnLink, tBtnBrowse, tModalMain, tModal, tProgress, tSize, tFooter, tActions, tActionDelete, tActionUpload, tActionZoom, tActionDrag, tTagBef, tTagBef1, tTagBef2, tTagAft, tGeneric, tHtml, tImage, tText, tVideo, tAudio, tFlash, tObject, tPdf, tOther, defaultFileActionSettings, defaultLayoutTemplates, defaultPreviewTemplates, defaultPreviewZoomSettings, defaultPreviewTypes, getElement, defaultPreviewSettings, defaultFileTypeSettings, isEmpty, isArray, ifSet, uniqId, htmlEncode, replaceTags, cleanMemory, findFileName, checkFullScreen, toggleFullScreen, moveArray, FileInput;\n  NAMESPACE = '.fileinput';\n  MODAL_ID = 'kvFileinputModal';\n  STYLE_SETTING = 'style=\"width:{width};height:{height};\"';\n  OBJECT_PARAMS = '<param name=\"controller\" value=\"true\" />\\n' + '<param name=\"allowFullScreen\" value=\"true\" />\\n' + '<param name=\"allowScriptAccess\" value=\"always\" />\\n' + '<param name=\"autoPlay\" value=\"false\" />\\n' + '<param name=\"autoStart\" value=\"false\" />\\n' + '<param name=\"quality\" value=\"high\" />\\n';\n  DEFAULT_PREVIEW = '<div class=\"file-preview-other\">\\n' + '<span class=\"{previewFileIconClass}\">{previewFileIcon}</span>\\n' + '</div>'; //noinspection JSUnresolvedVariable\n\n  objUrl = window.URL || window.webkitURL;\n\n  compare = function compare(input, str, exact) {\n    return input !== undefined && (exact ? input === str : input.match(str));\n  };\n\n  isIE = function isIE(ver) {\n    // check for IE versions < 11\n    if (navigator.appName !== 'Microsoft Internet Explorer') {\n      return false;\n    }\n\n    if (ver === 10) {\n      return new RegExp('msie\\\\s' + ver, 'i').test(navigator.userAgent);\n    }\n\n    var div = document.createElement(\"div\"),\n        status;\n    div.innerHTML = \"<!--[if IE \" + ver + \"]> <i></i> <![endif]-->\";\n    status = div.getElementsByTagName(\"i\").length;\n    document.body.appendChild(div);\n    div.parentNode.removeChild(div);\n    return status;\n  };\n\n  handler = function handler($el, event, callback, skipNS) {\n    var ev = skipNS ? event : event.split(' ').join(NAMESPACE + ' ') + NAMESPACE;\n    $el.off(ev).on(ev, callback);\n  };\n\n  previewCache = {\n    data: {},\n    init: function init(obj) {\n      var content = obj.initialPreview,\n          id = obj.id;\n\n      if (content.length > 0 && !isArray(content)) {\n        content = content.split(obj.initialPreviewDelimiter);\n      }\n\n      previewCache.data[id] = {\n        content: content,\n        config: obj.initialPreviewConfig,\n        tags: obj.initialPreviewThumbTags,\n        delimiter: obj.initialPreviewDelimiter,\n        previewFileType: obj.initialPreviewFileType,\n        previewAsData: obj.initialPreviewAsData,\n        template: obj.previewGenericTemplate,\n        showZoom: obj.fileActionSettings.showZoom,\n        showDrag: obj.fileActionSettings.showDrag,\n        getSize: function getSize(size) {\n          return obj._getSize(size);\n        },\n        parseTemplate: function parseTemplate(cat, data, fname, ftype, pId, ftr, ind) {\n          var fc = ' file-preview-initial';\n          return obj._generatePreviewTemplate(cat, data, fname, ftype, pId, false, null, fc, ftr, ind);\n        },\n        msg: function msg(n) {\n          return obj._getMsgSelected(n);\n        },\n        initId: obj.previewInitId,\n        footer: obj._getLayoutTemplate('footer').replace(/\\{progress}/g, obj._renderThumbProgress()),\n        isDelete: obj.initialPreviewShowDelete,\n        caption: obj.initialCaption,\n        actions: function actions(showUpload, showDelete, showZoom, showDrag, disabled, url, key) {\n          return obj._renderFileActions(showUpload, showDelete, showZoom, showDrag, disabled, url, key, true);\n        }\n      };\n    },\n    fetch: function fetch(id) {\n      return previewCache.data[id].content.filter(function (n) {\n        return n !== null;\n      });\n    },\n    count: function count(id, all) {\n      return !!previewCache.data[id] && !!previewCache.data[id].content ? all ? previewCache.data[id].content.length : previewCache.fetch(id).length : 0;\n    },\n    get: function get(id, i, isDisabled) {\n      var ind = 'init_' + i,\n          data = previewCache.data[id],\n          config = data.config[i],\n          content = data.content[i],\n          previewId = data.initId + '-' + ind,\n          out,\n          $tmp,\n          frameClass = ' file-preview-initial',\n          cat,\n          cap,\n          ftr,\n          ftype,\n          asData = ifSet('previewAsData', config, data.previewAsData);\n      isDisabled = isDisabled === undefined ? true : isDisabled;\n      /** @namespace config.frameAttr */\n\n      /** @namespace config.frameClass */\n\n      /** @namespace config.filetype */\n\n      if (!content) {\n        return '';\n      }\n\n      if (config && config.frameClass) {\n        frameClass += ' ' + config.frameClass;\n      }\n\n      if (asData) {\n        cat = data.previewAsData ? ifSet('type', config, data.previewFileType || 'generic') : 'generic';\n        cap = ifSet('caption', config);\n        ftr = previewCache.footer(id, i, isDisabled, config && config.size || null);\n        ftype = ifSet('filetype', config, cat);\n        out = data.parseTemplate(cat, content, cap, ftype, previewId, ftr, ind, null);\n      } else {\n        out = data.template.replace(/\\{previewId}/g, previewId).replace(/\\{frameClass}/g, frameClass).replace(/\\{fileindex}/g, ind).replace(/\\{content}/g, data.content[i]).replace(/\\{template}/g, ifSet('type', config, data.previewFileType)).replace(/\\{footer}/g, previewCache.footer(id, i, isDisabled, config && config.size || null));\n      }\n\n      if (data.tags.length && data.tags[i]) {\n        out = replaceTags(out, data.tags[i]);\n      }\n\n      if (!isEmpty(config) && !isEmpty(config.frameAttr)) {\n        $tmp = $(document.createElement('div')).html(out);\n        $tmp.find('.file-preview-initial').attr(config.frameAttr);\n        out = $tmp.html();\n        $tmp.remove();\n      }\n\n      return out;\n    },\n    add: function add(id, content, config, tags, append) {\n      var data = $.extend(true, {}, previewCache.data[id]),\n          index;\n\n      if (!isArray(content)) {\n        content = content.split(data.delimiter);\n      }\n\n      if (append) {\n        index = data.content.push(content) - 1;\n        data.config[index] = config;\n        data.tags[index] = tags;\n      } else {\n        index = content.length - 1;\n        data.content = content;\n        data.config = config;\n        data.tags = tags;\n      }\n\n      previewCache.data[id] = data;\n      return index;\n    },\n    set: function set(id, content, config, tags, append) {\n      var data = $.extend(true, {}, previewCache.data[id]),\n          i,\n          chk;\n\n      if (!content || !content.length) {\n        return;\n      }\n\n      if (!isArray(content)) {\n        content = content.split(data.delimiter);\n      }\n\n      chk = content.filter(function (n) {\n        return n !== null;\n      });\n\n      if (!chk.length) {\n        return;\n      }\n\n      if (data.content === undefined) {\n        data.content = [];\n      }\n\n      if (data.config === undefined) {\n        data.config = [];\n      }\n\n      if (data.tags === undefined) {\n        data.tags = [];\n      }\n\n      if (append) {\n        for (i = 0; i < content.length; i++) {\n          if (content[i]) {\n            data.content.push(content[i]);\n          }\n        }\n\n        for (i = 0; i < config.length; i++) {\n          if (config[i]) {\n            data.config.push(config[i]);\n          }\n        }\n\n        for (i = 0; i < tags.length; i++) {\n          if (tags[i]) {\n            data.tags.push(tags[i]);\n          }\n        }\n      } else {\n        data.content = content;\n        data.config = config;\n        data.tags = tags;\n      }\n\n      previewCache.data[id] = data;\n    },\n    unset: function unset(id, index) {\n      var chk = previewCache.count(id);\n\n      if (!chk) {\n        return;\n      }\n\n      if (chk === 1) {\n        previewCache.data[id].content = [];\n        previewCache.data[id].config = [];\n        previewCache.data[id].tags = [];\n        return;\n      }\n\n      previewCache.data[id].content[index] = null;\n      previewCache.data[id].config[index] = null;\n      previewCache.data[id].tags[index] = null;\n    },\n    out: function out(id) {\n      var html = '',\n          data = previewCache.data[id],\n          caption,\n          len = previewCache.count(id, true);\n\n      if (len === 0) {\n        return {\n          content: '',\n          caption: ''\n        };\n      }\n\n      for (var i = 0; i < len; i++) {\n        html += previewCache.get(id, i);\n      }\n\n      caption = data.msg(previewCache.count(id));\n      return {\n        content: '<div class=\"file-initial-thumbs\">' + html + '</div>',\n        caption: caption\n      };\n    },\n    footer: function footer(id, i, isDisabled, size) {\n      var data = previewCache.data[id];\n      isDisabled = isDisabled === undefined ? true : isDisabled;\n\n      if (data.config.length === 0 || isEmpty(data.config[i])) {\n        return '';\n      }\n\n      var config = data.config[i],\n          caption = ifSet('caption', config),\n          width = ifSet('width', config, 'auto'),\n          url = ifSet('url', config, false),\n          key = ifSet('key', config, null),\n          showDel = ifSet('showDelete', config, true),\n          showZoom = ifSet('showZoom', config, data.showZoom),\n          showDrag = ifSet('showDrag', config, data.showDrag),\n          disabled = url === false && isDisabled,\n          actions = data.isDelete ? data.actions(false, showDel, showZoom, showDrag, disabled, url, key) : '',\n          footer = data.footer.replace(/\\{actions}/g, actions);\n      return footer.replace(/\\{caption}/g, caption).replace(/\\{size}/g, data.getSize(size)).replace(/\\{width}/g, width).replace(/\\{indicator}/g, '').replace(/\\{indicatorTitle}/g, '');\n    }\n  };\n\n  getNum = function getNum(num, def) {\n    def = def || 0;\n\n    if (typeof num === \"number\") {\n      return num;\n    }\n\n    if (typeof num === \"string\") {\n      num = parseFloat(num);\n    }\n\n    return isNaN(num) ? def : num;\n  };\n\n  hasFileAPISupport = function hasFileAPISupport() {\n    return !!(window.File && window.FileReader);\n  };\n\n  hasDragDropSupport = function hasDragDropSupport() {\n    var div = document.createElement('div');\n    /** @namespace div.draggable */\n\n    /** @namespace div.ondragstart */\n\n    /** @namespace div.ondrop */\n\n    return !isIE(9) && (div.draggable !== undefined || div.ondragstart !== undefined && div.ondrop !== undefined);\n  };\n\n  hasFileUploadSupport = function hasFileUploadSupport() {\n    return hasFileAPISupport() && window.FormData;\n  };\n\n  addCss = function addCss($el, css) {\n    $el.removeClass(css).addClass(css);\n  };\n\n  defaultFileActionSettings = {\n    showRemove: true,\n    showUpload: true,\n    showZoom: true,\n    showDrag: true,\n    removeIcon: '<i class=\"glyphicon glyphicon-trash text-danger\"></i>',\n    removeClass: 'btn btn-xs btn-default',\n    removeTitle: 'Remove file',\n    uploadIcon: '<i class=\"glyphicon glyphicon-upload text-info\"></i>',\n    uploadClass: 'btn btn-xs btn-default',\n    uploadTitle: 'Upload file',\n    zoomIcon: '<i class=\"glyphicon glyphicon-zoom-in\"></i>',\n    zoomClass: 'btn btn-xs btn-default',\n    zoomTitle: 'View Details',\n    dragIcon: '<i class=\"glyphicon glyphicon-menu-hamburger\"></i>',\n    dragClass: 'text-info',\n    dragTitle: 'Move / Rearrange',\n    dragSettings: {},\n    indicatorNew: '<i class=\"glyphicon glyphicon-hand-down text-warning\"></i>',\n    indicatorSuccess: '<i class=\"glyphicon glyphicon-ok-sign text-success\"></i>',\n    indicatorError: '<i class=\"glyphicon glyphicon-exclamation-sign text-danger\"></i>',\n    indicatorLoading: '<i class=\"glyphicon glyphicon-hand-up text-muted\"></i>',\n    indicatorNewTitle: 'Not uploaded yet',\n    indicatorSuccessTitle: 'Uploaded',\n    indicatorErrorTitle: 'Upload Error',\n    indicatorLoadingTitle: 'Uploading ...'\n  };\n  tMain1 = '{preview}\\n' + '<div class=\"kv-upload-progress hide\"></div>\\n' + '<div class=\"input-group {class}\">\\n' + '   {caption}\\n' + '   <div class=\"input-group-btn\">\\n' + '       {remove}\\n' + '       {cancel}\\n' + '       {upload}\\n' + '       {browse}\\n' + '   </div>\\n' + '</div>';\n  tMain2 = '{preview}\\n<div class=\"kv-upload-progress hide\"></div>\\n{remove}\\n{cancel}\\n{upload}\\n{browse}\\n';\n  tPreview = '<div class=\"file-preview {class}\">\\n' + '    {close}' + '    <div class=\"{dropClass}\">\\n' + '    <div class=\"file-preview-thumbnails\">\\n' + '    </div>\\n' + '    <div class=\"clearfix\"></div>' + '    <div class=\"file-preview-status text-center text-success\"></div>\\n' + '    <div class=\"kv-fileinput-error\"></div>\\n' + '    </div>\\n' + '</div>';\n  tClose = '<div class=\"close fileinput-remove\">&times;</div>\\n';\n  tFileIcon = '<i class=\"glyphicon glyphicon-file kv-caption-icon\"></i>';\n  tCaption = '<div tabindex=\"500\" class=\"form-control file-caption {class}\">\\n' + '   <div class=\"file-caption-name\"></div>\\n' + '</div>\\n'; //noinspection HtmlUnknownAttribute\n\n  tBtnDefault = '<button type=\"{type}\" tabindex=\"500\" title=\"{title}\" class=\"{css}\" {status}>{icon} {label}</button>'; //noinspection HtmlUnknownAttribute\n\n  tBtnLink = '<a href=\"{href}\" tabindex=\"500\" title=\"{title}\" class=\"{css}\" {status}>{icon} {label}</a>'; //noinspection HtmlUnknownAttribute\n\n  tBtnBrowse = '<div tabindex=\"500\" class=\"{css}\" {status}>{icon} {label}</div>';\n  tModalMain = '<div id=\"' + MODAL_ID + '\" class=\"file-zoom-dialog modal fade\" tabindex=\"-1\" aria-labelledby=\"' + MODAL_ID + 'Label\"></div>';\n  tModal = '<div class=\"modal-dialog modal-lg\" role=\"document\">\\n' + '  <div class=\"modal-content\">\\n' + '    <div class=\"modal-header\">\\n' + '      <div class=\"kv-zoom-actions pull-right\">{toggleheader}{fullscreen}{borderless}{close}</div>\\n' + '      <h3 class=\"modal-title\">{heading} <small><span class=\"kv-zoom-title\"></span></small></h3>\\n' + '    </div>\\n' + '    <div class=\"modal-body\">\\n' + '      <div class=\"floating-buttons\"></div>\\n' + '      <div class=\"kv-zoom-body file-zoom-content\"></div>\\n' + '{prev} {next}\\n' + '    </div>\\n' + '  </div>\\n' + '</div>\\n';\n  tProgress = '<div class=\"progress\">\\n' + '    <div class=\"{class}\" role=\"progressbar\"' + ' aria-valuenow=\"{percent}\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width:{percent}%;\">\\n' + '        {percent}%\\n' + '     </div>\\n' + '</div>';\n  tSize = ' <br><samp>({sizeText})</samp>';\n  tFooter = '<div class=\"file-thumbnail-footer\">\\n' + '    <div class=\"file-footer-caption\" title=\"{caption}\">{caption}{size}</div>\\n' + '    {progress} {actions}\\n' + '</div>';\n  tActions = '<div class=\"file-actions\">\\n' + '    <div class=\"file-footer-buttons\">\\n' + '        {upload} {delete} {zoom} {other}' + '    </div>\\n' + '    {drag}\\n' + '    <div class=\"file-upload-indicator\" title=\"{indicatorTitle}\">{indicator}</div>\\n' + '    <div class=\"clearfix\"></div>\\n' + '</div>'; //noinspection HtmlUnknownAttribute\n\n  tActionDelete = '<button type=\"button\" class=\"kv-file-remove {removeClass}\" ' + 'title=\"{removeTitle}\" {dataUrl}{dataKey}>{removeIcon}</button>\\n';\n  tActionUpload = '<button type=\"button\" class=\"kv-file-upload {uploadClass}\" title=\"{uploadTitle}\">' + '{uploadIcon}</button>';\n  tActionZoom = '<button type=\"button\" class=\"kv-file-zoom {zoomClass}\" title=\"{zoomTitle}\">{zoomIcon}</button>';\n  tActionDrag = '<span class=\"file-drag-handle {dragClass}\" title=\"{dragTitle}\">{dragIcon}</span>';\n  tTagBef = '<div class=\"file-preview-frame{frameClass}\" id=\"{previewId}\" data-fileindex=\"{fileindex}\"' + ' data-template=\"{template}\"';\n  tTagBef1 = tTagBef + '><div class=\"kv-file-content\">\\n';\n  tTagBef2 = tTagBef + ' title=\"{caption}\" ' + STYLE_SETTING + '><div class=\"kv-file-content\">\\n';\n  tTagAft = '</div>{footer}\\n</div>\\n';\n  tGeneric = '{content}\\n';\n  tHtml = '<div class=\"kv-preview-data file-preview-html\" title=\"{caption}\" ' + STYLE_SETTING + '>{data}</div>\\n';\n  tImage = '<img src=\"{data}\" class=\"kv-preview-data file-preview-image\" title=\"{caption}\" alt=\"{caption}\" ' + STYLE_SETTING + '>\\n';\n  tText = '<textarea class=\"kv-preview-data file-preview-text\" title=\"{caption}\" readonly ' + STYLE_SETTING + '>{data}</textarea>\\n';\n  tVideo = '<video class=\"kv-preview-data\" width=\"{width}\" height=\"{height}\" controls>\\n' + '<source src=\"{data}\" type=\"{type}\">\\n' + DEFAULT_PREVIEW + '\\n</video>\\n';\n  tAudio = '<audio class=\"kv-preview-data\" controls>\\n<source src=\"' + '{data}' + '\" type=\"{type}\">\\n' + DEFAULT_PREVIEW + '\\n</audio>\\n';\n  tFlash = '<object class=\"kv-preview-data file-object\" type=\"application/x-shockwave-flash\" ' + 'width=\"{width}\" height=\"{height}\" data=\"{data}\">\\n' + OBJECT_PARAMS + ' ' + DEFAULT_PREVIEW + '\\n</object>\\n';\n  tObject = '<object class=\"kv-preview-data file-object\" data=\"{data}\" type=\"{type}\" width=\"{width}\" height=\"{height}\">\\n' + '<param name=\"movie\" value=\"{caption}\" />\\n' + OBJECT_PARAMS + ' ' + DEFAULT_PREVIEW + '\\n</object>\\n';\n  tPdf = '<embed class=\"kv-preview-data\" src=\"{data}\" width=\"{width}\" height=\"{height}\" type=\"application/pdf\">\\n';\n  tOther = '<div class=\"kv-preview-data file-preview-other-frame\">\\n' + DEFAULT_PREVIEW + '\\n</div>\\n';\n  defaultLayoutTemplates = {\n    main1: tMain1,\n    main2: tMain2,\n    preview: tPreview,\n    close: tClose,\n    fileIcon: tFileIcon,\n    caption: tCaption,\n    modalMain: tModalMain,\n    modal: tModal,\n    progress: tProgress,\n    size: tSize,\n    footer: tFooter,\n    actions: tActions,\n    actionDelete: tActionDelete,\n    actionUpload: tActionUpload,\n    actionZoom: tActionZoom,\n    actionDrag: tActionDrag,\n    btnDefault: tBtnDefault,\n    btnLink: tBtnLink,\n    btnBrowse: tBtnBrowse\n  };\n  defaultPreviewTemplates = {\n    generic: tTagBef1 + tGeneric + tTagAft,\n    html: tTagBef1 + tHtml + tTagAft,\n    image: tTagBef1 + tImage + tTagAft,\n    text: tTagBef1 + tText + tTagAft,\n    video: tTagBef2 + tVideo + tTagAft,\n    audio: tTagBef2 + tAudio + tTagAft,\n    flash: tTagBef2 + tFlash + tTagAft,\n    object: tTagBef2 + tObject + tTagAft,\n    pdf: tTagBef2 + tPdf + tTagAft,\n    other: tTagBef2 + tOther + tTagAft\n  };\n  defaultPreviewTypes = ['image', 'html', 'text', 'video', 'audio', 'flash', 'pdf', 'object'];\n  defaultPreviewSettings = {\n    image: {\n      width: \"auto\",\n      height: \"160px\"\n    },\n    html: {\n      width: \"213px\",\n      height: \"160px\"\n    },\n    text: {\n      width: \"213px\",\n      height: \"160px\"\n    },\n    video: {\n      width: \"213px\",\n      height: \"160px\"\n    },\n    audio: {\n      width: \"213px\",\n      height: \"80px\"\n    },\n    flash: {\n      width: \"213px\",\n      height: \"160px\"\n    },\n    object: {\n      width: \"160px\",\n      height: \"160px\"\n    },\n    pdf: {\n      width: \"160px\",\n      height: \"160px\"\n    },\n    other: {\n      width: \"160px\",\n      height: \"160px\"\n    }\n  };\n  defaultPreviewZoomSettings = {\n    image: {\n      width: \"100%\",\n      height: \"100%\"\n    },\n    html: {\n      width: \"100%\",\n      height: \"100%\",\n      'min-height': \"480px\"\n    },\n    text: {\n      width: \"100%\",\n      height: \"100%\",\n      'min-height': \"480px\"\n    },\n    video: {\n      width: \"auto\",\n      height: \"100%\",\n      'max-width': \"100%\"\n    },\n    audio: {\n      width: \"100%\",\n      height: \"30px\"\n    },\n    flash: {\n      width: \"auto\",\n      height: \"480px\"\n    },\n    object: {\n      width: \"auto\",\n      height: \"100%\",\n      'min-height': \"480px\"\n    },\n    pdf: {\n      width: \"100%\",\n      height: \"100%\",\n      'min-height': \"480px\"\n    },\n    other: {\n      width: \"auto\",\n      height: \"100%\",\n      'min-height': \"480px\"\n    }\n  };\n  defaultFileTypeSettings = {\n    image: function image(vType, vName) {\n      return compare(vType, 'image.*') || compare(vName, /\\.(gif|png|jpe?g)$/i);\n    },\n    html: function html(vType, vName) {\n      return compare(vType, 'text/html') || compare(vName, /\\.(htm|html)$/i);\n    },\n    text: function text(vType, vName) {\n      return compare(vType, 'text.*') || compare(vName, /\\.(xml|javascript)$/i) || compare(vName, /\\.(txt|md|csv|nfo|ini|json|php|js|css)$/i);\n    },\n    video: function video(vType, vName) {\n      return compare(vType, 'video.*') && (compare(vType, /(ogg|mp4|mp?g|webm|3gp)$/i) || compare(vName, /\\.(og?|mp4|webm|mp?g|3gp)$/i));\n    },\n    audio: function audio(vType, vName) {\n      return compare(vType, 'audio.*') && (compare(vName, /(ogg|mp3|mp?g|wav)$/i) || compare(vName, /\\.(og?|mp3|mp?g|wav)$/i));\n    },\n    flash: function flash(vType, vName) {\n      return compare(vType, 'application/x-shockwave-flash', true) || compare(vName, /\\.(swf)$/i);\n    },\n    pdf: function pdf(vType, vName) {\n      return compare(vType, 'application/pdf', true) || compare(vName, /\\.(pdf)$/i);\n    },\n    object: function object() {\n      return true;\n    },\n    other: function other() {\n      return true;\n    }\n  };\n\n  isEmpty = function isEmpty(value, trim) {\n    return value === undefined || value === null || value.length === 0 || trim && $.trim(value) === '';\n  };\n\n  isArray = function isArray(a) {\n    return Array.isArray(a) || Object.prototype.toString.call(a) === '[object Array]';\n  };\n\n  ifSet = function ifSet(needle, haystack, def) {\n    def = def || '';\n    return haystack && typeof haystack === 'object' && needle in haystack ? haystack[needle] : def;\n  };\n\n  getElement = function getElement(options, param, value) {\n    return isEmpty(options) || isEmpty(options[param]) ? value : $(options[param]);\n  };\n\n  uniqId = function uniqId() {\n    return Math.round(new Date().getTime() + Math.random() * 100);\n  };\n\n  htmlEncode = function htmlEncode(str) {\n    return str.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;').replace(/\"/g, '&quot;').replace(/'/g, '&apos;');\n  };\n\n  replaceTags = function replaceTags(str, tags) {\n    var out = str;\n\n    if (!tags) {\n      return out;\n    }\n\n    $.each(tags, function (key, value) {\n      if (typeof value === \"function\") {\n        value = value();\n      }\n\n      out = out.split(key).join(value);\n    });\n    return out;\n  };\n\n  cleanMemory = function cleanMemory($thumb) {\n    var data = $thumb.is('img') ? $thumb.attr('src') : $thumb.find('source').attr('src');\n    /** @namespace objUrl.revokeObjectURL */\n\n    objUrl.revokeObjectURL(data);\n  };\n\n  findFileName = function findFileName(filePath) {\n    var sepIndex = filePath.lastIndexOf('/');\n\n    if (sepIndex === -1) {\n      sepIndex = filePath.lastIndexOf('\\\\');\n    }\n\n    return filePath.split(filePath.substring(sepIndex, sepIndex + 1)).pop();\n  };\n\n  checkFullScreen = function checkFullScreen() {\n    //noinspection JSUnresolvedVariable\n    return document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement || document.msFullscreenElement;\n  };\n\n  toggleFullScreen = function toggleFullScreen(maximize) {\n    if (maximize && !checkFullScreen()) {\n      /** @namespace document.documentElement.requestFullscreen */\n\n      /** @namespace document.documentElement.msRequestFullscreen */\n\n      /** @namespace document.documentElement.mozRequestFullScreen */\n\n      /** @namespace document.documentElement.webkitRequestFullscreen */\n\n      /** @namespace Element.ALLOW_KEYBOARD_INPUT */\n      if (document.documentElement.requestFullscreen) {\n        document.documentElement.requestFullscreen();\n      } else if (document.documentElement.msRequestFullscreen) {\n        document.documentElement.msRequestFullscreen();\n      } else if (document.documentElement.mozRequestFullScreen) {\n        document.documentElement.mozRequestFullScreen();\n      } else if (document.documentElement.webkitRequestFullscreen) {\n        document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n      }\n    } else {\n      /** @namespace document.exitFullscreen */\n\n      /** @namespace document.msExitFullscreen */\n\n      /** @namespace document.mozCancelFullScreen */\n\n      /** @namespace document.webkitExitFullscreen */\n      if (document.exitFullscreen) {\n        document.exitFullscreen();\n      } else if (document.msExitFullscreen) {\n        document.msExitFullscreen();\n      } else if (document.mozCancelFullScreen) {\n        document.mozCancelFullScreen();\n      } else if (document.webkitExitFullscreen) {\n        document.webkitExitFullscreen();\n      }\n    }\n  };\n\n  moveArray = function moveArray(arr, oldIndex, newIndex) {\n    if (newIndex >= arr.length) {\n      var k = newIndex - arr.length;\n\n      while (k-- + 1) {\n        arr.push(undefined);\n      }\n    }\n\n    arr.splice(newIndex, 0, arr.splice(oldIndex, 1)[0]);\n    return arr;\n  };\n\n  FileInput = function FileInput(element, options) {\n    var self = this;\n    self.$element = $(element);\n\n    if (!self._validate()) {\n      return;\n    }\n\n    self.isPreviewable = hasFileAPISupport();\n    self.isIE9 = isIE(9);\n    self.isIE10 = isIE(10);\n\n    if (self.isPreviewable || self.isIE9) {\n      self._init(options);\n\n      self._listen();\n    } else {\n      self.$element.removeClass('file-loading');\n    }\n  };\n\n  FileInput.prototype = {\n    constructor: FileInput,\n    _init: function _init(options) {\n      var self = this,\n          $el = self.$element,\n          t;\n      $.each(options, function (key, value) {\n        switch (key) {\n          case 'minFileCount':\n          case 'maxFileCount':\n          case 'maxFileSize':\n            self[key] = getNum(value);\n            break;\n\n          default:\n            self[key] = value;\n            break;\n        }\n      });\n      self.fileInputCleared = false;\n      self.fileBatchCompleted = true;\n\n      if (!self.isPreviewable) {\n        self.showPreview = false;\n      }\n\n      self.uploadFileAttr = !isEmpty($el.attr('name')) ? $el.attr('name') : 'file_data';\n      self.reader = null;\n      self.formdata = {};\n      self.clearStack();\n      self.uploadCount = 0;\n      self.uploadStatus = {};\n      self.uploadLog = [];\n      self.uploadAsyncCount = 0;\n      self.loadedImages = [];\n      self.totalImagesCount = 0;\n      self.ajaxRequests = [];\n      self.isError = false;\n      self.ajaxAborted = false;\n      self.cancelling = false;\n      t = self._getLayoutTemplate('progress');\n      self.progressTemplate = t.replace('{class}', self.progressClass);\n      self.progressCompleteTemplate = t.replace('{class}', self.progressCompleteClass);\n      self.progressErrorTemplate = t.replace('{class}', self.progressErrorClass);\n      self.dropZoneEnabled = hasDragDropSupport() && self.dropZoneEnabled;\n      self.isDisabled = self.$element.attr('disabled') || self.$element.attr('readonly');\n      self.isUploadable = hasFileUploadSupport() && !isEmpty(self.uploadUrl);\n      self.isClickable = self.browseOnZoneClick && self.showPreview && (self.isUploadable && self.dropZoneEnabled || !isEmpty(self.defaultPreviewContent));\n      self.slug = typeof options.slugCallback === \"function\" ? options.slugCallback : self._slugDefault;\n      self.mainTemplate = self.showCaption ? self._getLayoutTemplate('main1') : self._getLayoutTemplate('main2');\n      self.captionTemplate = self._getLayoutTemplate('caption');\n      self.previewGenericTemplate = self._getPreviewTemplate('generic');\n\n      if (self.resizeImage && (self.maxImageWidth || self.maxImageHeight)) {\n        self.imageCanvas = document.createElement('canvas');\n        self.imageCanvasContext = self.imageCanvas.getContext('2d');\n      }\n\n      if (isEmpty(self.$element.attr('id'))) {\n        self.$element.attr('id', uniqId());\n      }\n\n      if (self.$container === undefined) {\n        self.$container = self._createContainer();\n      } else {\n        self._refreshContainer();\n      }\n\n      self.$dropZone = self.$container.find('.file-drop-zone');\n      self.$progress = self.$container.find('.kv-upload-progress');\n      self.$btnUpload = self.$container.find('.fileinput-upload');\n      self.$captionContainer = getElement(options, 'elCaptionContainer', self.$container.find('.file-caption'));\n      self.$caption = getElement(options, 'elCaptionText', self.$container.find('.file-caption-name'));\n      self.$previewContainer = getElement(options, 'elPreviewContainer', self.$container.find('.file-preview'));\n      self.$preview = getElement(options, 'elPreviewImage', self.$container.find('.file-preview-thumbnails'));\n      self.$previewStatus = getElement(options, 'elPreviewStatus', self.$container.find('.file-preview-status'));\n      self.$errorContainer = getElement(options, 'elErrorContainer', self.$previewContainer.find('.kv-fileinput-error'));\n\n      if (!isEmpty(self.msgErrorClass)) {\n        addCss(self.$errorContainer, self.msgErrorClass);\n      }\n\n      self.$errorContainer.hide();\n      self.fileActionSettings = $.extend(true, defaultFileActionSettings, options.fileActionSettings);\n      self.previewInitId = \"preview-\" + uniqId();\n      self.id = self.$element.attr('id');\n      previewCache.init(self);\n\n      self._initPreview(true);\n\n      self._initPreviewActions();\n\n      self.options = options;\n\n      self._setFileDropZoneTitle();\n\n      self.$element.removeClass('file-loading');\n\n      if (self.$element.attr('disabled')) {\n        self.disable();\n      }\n\n      self._initZoom();\n    },\n    _validate: function _validate() {\n      var self = this,\n          $exception;\n\n      if (self.$element.attr('type') === 'file') {\n        return true;\n      }\n\n      $exception = '<div class=\"help-block alert alert-warning\">' + '<h4>Invalid Input Type</h4>' + 'You must set an input <code>type = file</code> for <b>bootstrap-fileinput</b> plugin to initialize.' + '</div>';\n      self.$element.after($exception);\n      return false;\n    },\n    _errorsExist: function _errorsExist() {\n      var self = this,\n          $err;\n\n      if (self.$errorContainer.find('li').length) {\n        return true;\n      }\n\n      $err = $(document.createElement('div')).html(self.$errorContainer.html());\n      $err.find('span.kv-error-close').remove();\n      $err.find('ul').remove();\n      return $.trim($err.text()).length ? true : false;\n    },\n    _errorHandler: function _errorHandler(evt, caption) {\n      var self = this,\n          err = evt.target.error;\n      /** @namespace err.NOT_FOUND_ERR */\n\n      /** @namespace err.SECURITY_ERR */\n\n      /** @namespace err.NOT_READABLE_ERR */\n\n      if (err.code === err.NOT_FOUND_ERR) {\n        self._showError(self.msgFileNotFound.replace('{name}', caption));\n      } else if (err.code === err.SECURITY_ERR) {\n        self._showError(self.msgFileSecured.replace('{name}', caption));\n      } else if (err.code === err.NOT_READABLE_ERR) {\n        self._showError(self.msgFileNotReadable.replace('{name}', caption));\n      } else if (err.code === err.ABORT_ERR) {\n        self._showError(self.msgFilePreviewAborted.replace('{name}', caption));\n      } else {\n        self._showError(self.msgFilePreviewError.replace('{name}', caption));\n      }\n    },\n    _addError: function _addError(msg) {\n      var self = this,\n          $error = self.$errorContainer;\n\n      if (msg && $error.length) {\n        $error.html(self.errorCloseButton + msg);\n        handler($error.find('.kv-error-close'), 'click', function () {\n          $error.fadeOut('slow');\n        });\n      }\n    },\n    _resetErrors: function _resetErrors(fade) {\n      var self = this,\n          $error = self.$errorContainer;\n      self.isError = false;\n      self.$container.removeClass('has-error');\n      $error.html('');\n\n      if (fade) {\n        $error.fadeOut('slow');\n      } else {\n        $error.hide();\n      }\n    },\n    _showFolderError: function _showFolderError(folders) {\n      var self = this,\n          $error = self.$errorContainer,\n          msg;\n\n      if (!folders) {\n        return;\n      }\n\n      msg = self.msgFoldersNotAllowed.replace(/\\{n}/g, folders);\n\n      self._addError(msg);\n\n      addCss(self.$container, 'has-error');\n      $error.fadeIn(800);\n\n      self._raise('filefoldererror', [folders, msg]);\n    },\n    _showUploadError: function _showUploadError(msg, params, event) {\n      var self = this,\n          $error = self.$errorContainer,\n          ev = event || 'fileuploaderror',\n          e = params && params.id ? '<li data-file-id=\"' + params.id + '\">' + msg + '</li>' : '<li>' + msg + '</li>';\n\n      if ($error.find('ul').length === 0) {\n        self._addError('<ul>' + e + '</ul>');\n      } else {\n        $error.find('ul').append(e);\n      }\n\n      $error.fadeIn(800);\n\n      self._raise(ev, [params, msg]);\n\n      self.$container.removeClass('file-input-new');\n      addCss(self.$container, 'has-error');\n      return true;\n    },\n    _showError: function _showError(msg, params, event) {\n      var self = this,\n          $error = self.$errorContainer,\n          ev = event || 'fileerror';\n      params = params || {};\n      params.reader = self.reader;\n\n      self._addError(msg);\n\n      $error.fadeIn(800);\n\n      self._raise(ev, [params, msg]);\n\n      if (!self.isUploadable) {\n        self._clearFileInput();\n      }\n\n      self.$container.removeClass('file-input-new');\n      addCss(self.$container, 'has-error');\n      self.$btnUpload.attr('disabled', true);\n      return true;\n    },\n    _noFilesError: function _noFilesError(params) {\n      var self = this,\n          label = self.minFileCount > 1 ? self.filePlural : self.fileSingle,\n          msg = self.msgFilesTooLess.replace('{n}', self.minFileCount).replace('{files}', label),\n          $error = self.$errorContainer;\n\n      self._addError(msg);\n\n      self.isError = true;\n\n      self._updateFileDetails(0);\n\n      $error.fadeIn(800);\n\n      self._raise('fileerror', [params, msg]);\n\n      self._clearFileInput();\n\n      addCss(self.$container, 'has-error');\n    },\n    _parseError: function _parseError(jqXHR, errorThrown, fileName) {\n      /** @namespace jqXHR.responseJSON */\n      var self = this,\n          errMsg = $.trim(errorThrown + ''),\n          dot = errMsg.slice(-1) === '.' ? '' : '.',\n          text = jqXHR.responseJSON !== undefined && jqXHR.responseJSON.error !== undefined ? jqXHR.responseJSON.error : jqXHR.responseText;\n\n      if (self.cancelling && self.msgUploadAborted) {\n        errMsg = self.msgUploadAborted;\n      }\n\n      if (self.showAjaxErrorDetails && text) {\n        text = $.trim(text.replace(/\\n\\s*\\n/g, '\\n'));\n        text = text.length > 0 ? '<pre>' + text + '</pre>' : '';\n        errMsg += dot + text;\n      } else {\n        errMsg += dot;\n      }\n\n      self.cancelling = false;\n      return fileName ? '<b>' + fileName + ': </b>' + errMsg : errMsg;\n    },\n    _parseFileType: function _parseFileType(file) {\n      var self = this,\n          isValid,\n          vType,\n          cat,\n          i;\n\n      for (i = 0; i < defaultPreviewTypes.length; i += 1) {\n        cat = defaultPreviewTypes[i];\n        isValid = ifSet(cat, self.fileTypeSettings, defaultFileTypeSettings[cat]);\n        vType = isValid(file.type, file.name) ? cat : '';\n\n        if (!isEmpty(vType)) {\n          return vType;\n        }\n      }\n\n      return 'other';\n    },\n    _parseFilePreviewIcon: function _parseFilePreviewIcon(content, fname) {\n      var self = this,\n          proceed,\n          ext,\n          icn = self.previewFileIcon;\n\n      if (fname && fname.indexOf('.') > -1) {\n        ext = fname.split('.').pop();\n\n        if (self.previewFileIconSettings && self.previewFileIconSettings[ext]) {\n          icn = self.previewFileIconSettings[ext];\n        }\n\n        if (self.previewFileExtSettings) {\n          $.each(self.previewFileExtSettings, function (key, func) {\n            if (self.previewFileIconSettings[key] && func(ext)) {\n              icn = self.previewFileIconSettings[key];\n              return;\n            }\n\n            proceed = true;\n          });\n        }\n      }\n\n      if (content.indexOf('{previewFileIcon}') > -1) {\n        return content.replace(/\\{previewFileIconClass}/g, self.previewFileIconClass).replace(/\\{previewFileIcon}/g, icn);\n      }\n\n      return content;\n    },\n    _raise: function _raise(event, params) {\n      var self = this,\n          e = $.Event(event);\n\n      if (params !== undefined) {\n        self.$element.trigger(e, params);\n      } else {\n        self.$element.trigger(e);\n      }\n\n      if (e.isDefaultPrevented()) {\n        return false;\n      }\n\n      if (!e.result) {\n        return e.result;\n      }\n\n      switch (event) {\n        // ignore these events\n        case 'filebatchuploadcomplete':\n        case 'filebatchuploadsuccess':\n        case 'fileuploaded':\n        case 'fileclear':\n        case 'filecleared':\n        case 'filereset':\n        case 'fileerror':\n        case 'filefoldererror':\n        case 'fileuploaderror':\n        case 'filebatchuploaderror':\n        case 'filedeleteerror':\n        case 'filecustomerror':\n        case 'filesuccessremove':\n          break;\n        // receive data response via `filecustomerror` event`\n\n        default:\n          self.ajaxAborted = e.result;\n          break;\n      }\n\n      return true;\n    },\n    _listenFullScreen: function _listenFullScreen(isFullScreen) {\n      var self = this,\n          $modal = self.$modal,\n          $btnFull,\n          $btnBord;\n\n      if (!$modal || !$modal.length) {\n        return;\n      }\n\n      $btnFull = $modal && $modal.find('.btn-fullscreen');\n      $btnBord = $modal && $modal.find('.btn-borderless');\n\n      if (!$btnFull.length || !$btnBord.length) {\n        return;\n      }\n\n      $btnFull.removeClass('active').attr('aria-pressed', 'false');\n      $btnBord.removeClass('active').attr('aria-pressed', 'false');\n\n      if (isFullScreen) {\n        $btnFull.addClass('active').attr('aria-pressed', 'true');\n      } else {\n        $btnBord.addClass('active').attr('aria-pressed', 'true');\n      }\n\n      if ($modal.hasClass('file-zoom-fullscreen')) {\n        self._maximizeZoomDialog();\n      } else {\n        if (isFullScreen) {\n          self._maximizeZoomDialog();\n        } else {\n          $btnBord.removeClass('active').attr('aria-pressed', 'false');\n        }\n      }\n    },\n    _listen: function _listen() {\n      var self = this,\n          $el = self.$element,\n          $form = $el.closest('form'),\n          $cont = self.$container;\n      handler($el, 'change', $.proxy(self._change, self));\n\n      if (self.showBrowse) {\n        handler(self.$btnFile, 'click', $.proxy(self._browse, self));\n      }\n\n      handler($form, 'reset', $.proxy(self.reset, self));\n      handler($cont.find('.fileinput-remove:not([disabled])'), 'click', $.proxy(self.clear, self));\n      handler($cont.find('.fileinput-cancel'), 'click', $.proxy(self.cancel, self));\n\n      self._initDragDrop();\n\n      if (!self.isUploadable) {\n        handler($form, 'submit', $.proxy(self._submitForm, self));\n      }\n\n      handler(self.$container.find('.fileinput-upload'), 'click', $.proxy(self._uploadClick, self));\n      handler($(window), 'resize', function () {\n        self._listenFullScreen(screen.width === window.innerWidth && screen.height === window.innerHeight);\n      });\n      handler($(document), 'webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange', function () {\n        self._listenFullScreen(checkFullScreen());\n      });\n\n      self._initClickable();\n    },\n    _initClickable: function _initClickable() {\n      var self = this,\n          $zone;\n\n      if (!self.isClickable) {\n        return;\n      }\n\n      $zone = self.isUploadable ? self.$dropZone : self.$preview.find('.file-default-preview');\n      addCss($zone, 'clickable');\n      $zone.attr('tabindex', -1);\n      handler($zone, 'click', function (e) {\n        var $target = $(e.target);\n\n        if (!$target.parents('.file-preview-thumbnails').length || $target.parents('.file-default-preview').length) {\n          self.$element.trigger('click');\n          $zone.blur();\n        }\n      });\n    },\n    _initDragDrop: function _initDragDrop() {\n      var self = this,\n          $zone = self.$dropZone;\n\n      if (self.isUploadable && self.dropZoneEnabled && self.showPreview) {\n        handler($zone, 'dragenter dragover', $.proxy(self._zoneDragEnter, self));\n        handler($zone, 'dragleave', $.proxy(self._zoneDragLeave, self));\n        handler($zone, 'drop', $.proxy(self._zoneDrop, self));\n        handler($(document), 'dragenter dragover drop', self._zoneDragDropInit);\n      }\n    },\n    _zoneDragDropInit: function _zoneDragDropInit(e) {\n      e.stopPropagation();\n      e.preventDefault();\n    },\n    _zoneDragEnter: function _zoneDragEnter(e) {\n      var self = this,\n          hasFiles = $.inArray('Files', e.originalEvent.dataTransfer.types) > -1;\n\n      self._zoneDragDropInit(e);\n\n      if (self.isDisabled || !hasFiles) {\n        e.originalEvent.dataTransfer.effectAllowed = 'none';\n        e.originalEvent.dataTransfer.dropEffect = 'none';\n        return;\n      }\n\n      addCss(self.$dropZone, 'file-highlighted');\n    },\n    _zoneDragLeave: function _zoneDragLeave(e) {\n      var self = this;\n\n      self._zoneDragDropInit(e);\n\n      if (self.isDisabled) {\n        return;\n      }\n\n      self.$dropZone.removeClass('file-highlighted');\n    },\n    _zoneDrop: function _zoneDrop(e) {\n      var self = this;\n      e.preventDefault();\n      /** @namespace e.originalEvent.dataTransfer */\n\n      if (self.isDisabled || isEmpty(e.originalEvent.dataTransfer.files)) {\n        return;\n      }\n\n      self._change(e, 'dragdrop');\n\n      self.$dropZone.removeClass('file-highlighted');\n    },\n    _uploadClick: function _uploadClick(e) {\n      var self = this,\n          $btn = self.$container.find('.fileinput-upload'),\n          $form,\n          isEnabled = !$btn.hasClass('disabled') && isEmpty($btn.attr('disabled'));\n\n      if (e && e.isDefaultPrevented()) {\n        return;\n      }\n\n      if (!self.isUploadable) {\n        if (isEnabled && $btn.attr('type') !== 'submit') {\n          $form = $btn.closest('form'); // downgrade to normal form submit if possible\n\n          if ($form.length) {\n            $form.trigger('submit');\n          }\n\n          e.preventDefault();\n        }\n\n        return;\n      }\n\n      e.preventDefault();\n\n      if (isEnabled) {\n        self.upload();\n      }\n    },\n    _submitForm: function _submitForm() {\n      var self = this,\n          $el = self.$element,\n          files = $el.get(0).files;\n\n      if (files && self.minFileCount > 0 && self._getFileCount(files.length) < self.minFileCount) {\n        self._noFilesError({});\n\n        return false;\n      }\n\n      return !self._abort({});\n    },\n    _clearPreview: function _clearPreview() {\n      var self = this,\n          $thumbs = !self.showUploadedThumbs ? self.$preview.find('.file-preview-frame') : self.$preview.find('.file-preview-frame:not(.file-preview-success)');\n      $thumbs.remove();\n\n      if (!self.$preview.find('.file-preview-frame').length || !self.showPreview) {\n        self._resetUpload();\n      }\n\n      self._validateDefaultPreview();\n    },\n    _initSortable: function _initSortable() {\n      var self = this,\n          $preview = self.$preview,\n          $el,\n          settings;\n\n      if (!window.KvSortable) {\n        return;\n      }\n\n      $el = $preview.find('.file-initial-thumbs'); //noinspection JSUnusedGlobalSymbols\n\n      settings = {\n        handle: '.drag-handle-init',\n        dataIdAttr: 'data-preview-id',\n        draggable: '.file-preview-initial',\n        onSort: function onSort(e) {\n          var oldIndex = e.oldIndex,\n              newIndex = e.newIndex;\n          self.initialPreview = moveArray(self.initialPreview, oldIndex, newIndex);\n          self.initialPreviewConfig = moveArray(self.initialPreviewConfig, oldIndex, newIndex);\n          previewCache.init(self);\n\n          self._raise('filesorted', {\n            previewId: $(e.item).attr('id'),\n            'oldIndex': oldIndex,\n            'newIndex': newIndex,\n            stack: self.initialPreviewConfig\n          });\n        }\n      };\n\n      if ($el.data('kvsortable')) {\n        $el.kvsortable('destroy');\n      }\n\n      $.extend(true, settings, self.fileActionSettings.dragSettings);\n      $el.kvsortable(settings);\n    },\n    _initPreview: function _initPreview(isInit) {\n      var self = this,\n          cap = self.initialCaption || '',\n          out;\n\n      if (!previewCache.count(self.id)) {\n        self._clearPreview();\n\n        if (isInit) {\n          self._setCaption(cap);\n        } else {\n          self._initCaption();\n        }\n\n        return;\n      }\n\n      out = previewCache.out(self.id);\n      cap = isInit && self.initialCaption ? self.initialCaption : out.caption;\n      self.$preview.html(out.content);\n\n      self._setCaption(cap);\n\n      self._initSortable();\n\n      if (!isEmpty(out.content)) {\n        self.$container.removeClass('file-input-new');\n      }\n    },\n    _getZoomButton: function _getZoomButton(type) {\n      var self = this,\n          label = self.previewZoomButtonIcons[type],\n          css = self.previewZoomButtonClasses[type],\n          title = ' title=\"' + (self.previewZoomButtonTitles[type] || '') + '\" ',\n          params = title + (type === 'close' ? ' data-dismiss=\"modal\" aria-hidden=\"true\"' : '');\n\n      if (type === 'fullscreen' || type === 'borderless' || type === 'toggleheader') {\n        params += ' data-toggle=\"button\" aria-pressed=\"false\" autocomplete=\"off\"';\n      }\n\n      return '<button type=\"button\" class=\"' + css + ' btn-' + type + '\"' + params + '>' + label + '</button>';\n    },\n    _getModalContent: function _getModalContent() {\n      var self = this;\n      return self._getLayoutTemplate('modal').replace(/\\{heading}/g, self.msgZoomModalHeading).replace(/\\{prev}/g, self._getZoomButton('prev')).replace(/\\{next}/g, self._getZoomButton('next')).replace(/\\{toggleheader}/g, self._getZoomButton('toggleheader')).replace(/\\{fullscreen}/g, self._getZoomButton('fullscreen')).replace(/\\{borderless}/g, self._getZoomButton('borderless')).replace(/\\{close}/g, self._getZoomButton('close'));\n    },\n    _listenModalEvent: function _listenModalEvent(event) {\n      var self = this,\n          $modal = self.$modal,\n          getParams = function getParams(e) {\n        return {\n          sourceEvent: e,\n          previewId: $modal.data('previewId'),\n          modal: $modal\n        };\n      };\n\n      $modal.on(event + '.bs.modal', function (e) {\n        var $btnFull = $modal.find('.btn-fullscreen'),\n            $btnBord = $modal.find('.btn-borderless');\n\n        self._raise('filezoom' + event, getParams(e));\n\n        if (event === 'shown') {\n          $btnBord.removeClass('active').attr('aria-pressed', 'false');\n          $btnFull.removeClass('active').attr('aria-pressed', 'false');\n\n          if ($modal.hasClass('file-zoom-fullscreen')) {\n            self._maximizeZoomDialog();\n\n            if (checkFullScreen()) {\n              $btnFull.addClass('active').attr('aria-pressed', 'true');\n            } else {\n              $btnBord.addClass('active').attr('aria-pressed', 'true');\n            }\n          }\n        }\n      });\n    },\n    _initZoom: function _initZoom() {\n      var self = this,\n          $dialog,\n          modalMain = self._getLayoutTemplate('modalMain'),\n          modalId = '#' + MODAL_ID;\n\n      self.$modal = $(modalId);\n\n      if (!self.$modal || !self.$modal.length) {\n        $dialog = $(document.createElement('div')).html(modalMain).insertAfter(self.$container);\n        self.$modal = $('#' + MODAL_ID).insertBefore($dialog);\n        $dialog.remove();\n      }\n\n      self.$modal.html(self._getModalContent());\n\n      self._listenModalEvent('show');\n\n      self._listenModalEvent('shown');\n\n      self._listenModalEvent('hide');\n\n      self._listenModalEvent('hidden');\n\n      self._listenModalEvent('loaded');\n    },\n    _initZoomButtons: function _initZoomButtons() {\n      var self = this,\n          previewId = self.$modal.data('previewId') || '',\n          $first,\n          $last,\n          frames = self.$preview.find('.file-preview-frame').toArray(),\n          len = frames.length,\n          $prev = self.$modal.find('.btn-prev'),\n          $next = self.$modal.find('.btn-next');\n\n      if (!len) {\n        return;\n      }\n\n      $first = $(frames[0]);\n      $last = $(frames[len - 1]);\n      $prev.removeAttr('disabled');\n      $next.removeAttr('disabled');\n\n      if ($first.length && $first.attr('id') === previewId) {\n        $prev.attr('disabled', true);\n      }\n\n      if ($last.length && $last.attr('id') === previewId) {\n        $next.attr('disabled', true);\n      }\n    },\n    _maximizeZoomDialog: function _maximizeZoomDialog() {\n      var self = this,\n          $modal = self.$modal,\n          $head = $modal.find('.modal-header:visible'),\n          $foot = $modal.find('.modal-footer:visible'),\n          $body = $modal.find('.modal-body'),\n          h = $(window).height(),\n          diff = 0;\n      $modal.addClass('file-zoom-fullscreen');\n\n      if ($head && $head.length) {\n        h -= $head.outerHeight(true);\n      }\n\n      if ($foot && $foot.length) {\n        h -= $foot.outerHeight(true);\n      }\n\n      if ($body && $body.length) {\n        diff = $body.outerHeight(true) - $body.height();\n        h -= diff;\n      }\n\n      $modal.find('.kv-zoom-body').height(h);\n    },\n    _resizeZoomDialog: function _resizeZoomDialog(fullScreen) {\n      var self = this,\n          $modal = self.$modal,\n          $btnFull = $modal.find('.btn-fullscreen'),\n          $btnBord = $modal.find('.btn-borderless');\n\n      if ($modal.hasClass('file-zoom-fullscreen')) {\n        toggleFullScreen(false);\n\n        if (!fullScreen) {\n          if (!$btnFull.hasClass('active')) {\n            $modal.removeClass('file-zoom-fullscreen');\n            self.$modal.find('.kv-zoom-body').css('height', self.zoomModalHeight);\n          } else {\n            $btnFull.removeClass('active').attr('aria-pressed', 'false');\n          }\n        } else {\n          if (!$btnFull.hasClass('active')) {\n            $modal.removeClass('file-zoom-fullscreen');\n\n            self._resizeZoomDialog(true);\n\n            if ($btnBord.hasClass('active')) {\n              $btnBord.removeClass('active').attr('aria-pressed', 'false');\n            }\n          }\n        }\n      } else {\n        if (!fullScreen) {\n          self._maximizeZoomDialog();\n\n          return;\n        }\n\n        toggleFullScreen(true);\n      }\n\n      $modal.focus();\n    },\n    _setZoomContent: function _setZoomContent($preview, animate) {\n      var self = this,\n          $content,\n          tmplt,\n          body,\n          title,\n          $body,\n          $dataEl,\n          config,\n          previewId = $preview.attr('id'),\n          $modal = self.$modal,\n          $prev = $modal.find('.btn-prev'),\n          $next = $modal.find('.btn-next'),\n          $tmp,\n          $btnFull = $modal.find('.btn-fullscreen'),\n          $btnBord = $modal.find('.btn-borderless'),\n          $btnTogh = $modal.find('.btn-toggleheader');\n      tmplt = $preview.data('template') || 'generic';\n      $content = $preview.find('.kv-file-content');\n      body = $content.length ? $content.html() : '';\n      title = $preview.find('.file-footer-caption').text() || '';\n      $modal.find('.kv-zoom-title').html(title);\n      $body = $modal.find('.kv-zoom-body');\n\n      if (animate) {\n        $tmp = $body.clone().insertAfter($body);\n        $body.html(body).hide();\n        $tmp.fadeOut('fast', function () {\n          $body.fadeIn('fast');\n          $tmp.remove();\n        });\n      } else {\n        $body.html(body);\n      }\n\n      config = self.previewZoomSettings[tmplt];\n\n      if (config) {\n        $dataEl = $body.find('.kv-preview-data');\n        addCss($dataEl, 'file-zoom-detail');\n        $.each(config, function (key, value) {\n          $dataEl.css(key, value);\n\n          if ($dataEl.attr('width') && key === 'width' || $dataEl.attr('height') && key === 'height') {\n            $dataEl.removeAttr(key);\n          }\n        });\n      }\n\n      $modal.data('previewId', previewId);\n      handler($prev, 'click', function () {\n        self._zoomSlideShow('prev', previewId);\n      });\n      handler($next, 'click', function () {\n        self._zoomSlideShow('next', previewId);\n      });\n      handler($btnFull, 'click', function () {\n        self._resizeZoomDialog(true);\n      });\n      handler($btnBord, 'click', function () {\n        self._resizeZoomDialog(false);\n      });\n      handler($btnTogh, 'click', function () {\n        var $header = $modal.find('.modal-header'),\n            $floatBar = $modal.find('.modal-body .floating-buttons'),\n            ht,\n            $actions = $header.find('.kv-zoom-actions'),\n            resize = function resize(height) {\n          var $body = self.$modal.find('.kv-zoom-body'),\n              h = self.zoomModalHeight;\n\n          if ($modal.hasClass('file-zoom-fullscreen')) {\n            h = $body.outerHeight(true);\n\n            if (!height) {\n              h = h - $header.outerHeight(true);\n            }\n          }\n\n          $body.css('height', height ? h + height : h);\n        };\n\n        if ($header.is(':visible')) {\n          ht = $header.outerHeight(true);\n          $header.slideUp('slow', function () {\n            $actions.find('.btn').appendTo($floatBar);\n            resize(ht);\n          });\n        } else {\n          $floatBar.find('.btn').appendTo($actions);\n          $header.slideDown('slow', function () {\n            resize();\n          });\n        }\n\n        $modal.focus();\n      });\n      handler($modal, 'keydown', function (e) {\n        var key = e.which || e.keyCode;\n\n        if (key === 37 && !$prev.attr('disabled')) {\n          self._zoomSlideShow('prev', previewId);\n        }\n\n        if (key === 39 && !$next.attr('disabled')) {\n          self._zoomSlideShow('next', previewId);\n        }\n      });\n    },\n    _zoomPreview: function _zoomPreview($btn) {\n      var self = this,\n          $preview;\n\n      if (!$btn.length) {\n        throw 'Cannot zoom to detailed preview!';\n      }\n\n      self.$modal.html(self._getModalContent());\n      $preview = $btn.closest('.file-preview-frame');\n\n      self._setZoomContent($preview);\n\n      self.$modal.modal('show');\n\n      self._initZoomButtons();\n    },\n    _zoomSlideShow: function _zoomSlideShow(dir, previewId) {\n      var self = this,\n          $btn = self.$modal.find('.kv-zoom-actions .btn-' + dir),\n          $targFrame,\n          i,\n          frames = self.$preview.find('.file-preview-frame').toArray(),\n          len = frames.length,\n          out;\n\n      if ($btn.attr('disabled')) {\n        return;\n      }\n\n      for (i = 0; i < len; i++) {\n        if ($(frames[i]).attr('id') === previewId) {\n          out = dir === 'prev' ? i - 1 : i + 1;\n          break;\n        }\n      }\n\n      if (out < 0 || out >= len || !frames[out]) {\n        return;\n      }\n\n      $targFrame = $(frames[out]);\n\n      if ($targFrame.length) {\n        self._setZoomContent($targFrame, true);\n      }\n\n      self._initZoomButtons();\n\n      self._raise('filezoom' + dir, {\n        'previewId': previewId,\n        modal: self.$modal\n      });\n    },\n    _initZoomButton: function _initZoomButton() {\n      var self = this;\n      self.$preview.find('.kv-file-zoom').each(function () {\n        var $el = $(this);\n        handler($el, 'click', function () {\n          self._zoomPreview($el);\n        });\n      });\n    },\n    _initPreviewActions: function _initPreviewActions() {\n      var self = this,\n          deleteExtraData = self.deleteExtraData || {},\n          resetProgress = function resetProgress() {\n        var hasFiles = self.isUploadable ? previewCache.count(self.id) : self.$element.get(0).files.length;\n\n        if (self.$preview.find('.kv-file-remove').length === 0 && !hasFiles) {\n          self.reset();\n          self.initialCaption = '';\n        }\n      };\n\n      self._initZoomButton();\n\n      self.$preview.find('.kv-file-remove').each(function () {\n        var $el = $(this),\n            vUrl = $el.data('url') || self.deleteUrl,\n            vKey = $el.data('key');\n\n        if (isEmpty(vUrl) || vKey === undefined) {\n          return;\n        }\n\n        var $frame = $el.closest('.file-preview-frame'),\n            cache = previewCache.data[self.id],\n            settings,\n            params,\n            index = $frame.data('fileindex'),\n            config,\n            extraData;\n        index = parseInt(index.replace('init_', ''));\n        config = isEmpty(cache.config) && isEmpty(cache.config[index]) ? null : cache.config[index];\n        extraData = isEmpty(config) || isEmpty(config.extra) ? deleteExtraData : config.extra;\n\n        if (typeof extraData === \"function\") {\n          extraData = extraData();\n        }\n\n        params = {\n          id: $el.attr('id'),\n          key: vKey,\n          extra: extraData\n        };\n        settings = $.extend(true, {}, {\n          url: vUrl,\n          type: 'POST',\n          dataType: 'json',\n          data: $.extend(true, {}, {\n            key: vKey\n          }, extraData),\n          beforeSend: function beforeSend(jqXHR) {\n            self.ajaxAborted = false;\n\n            self._raise('filepredelete', [vKey, jqXHR, extraData]);\n\n            if (self.ajaxAborted) {\n              jqXHR.abort();\n            } else {\n              addCss($frame, 'file-uploading');\n              addCss($el, 'disabled');\n            }\n          },\n          success: function success(data, textStatus, jqXHR) {\n            var n, cap;\n\n            if (isEmpty(data) || isEmpty(data.error)) {\n              previewCache.unset(self.id, index);\n              n = previewCache.count(self.id);\n              cap = n > 0 ? self._getMsgSelected(n) : '';\n\n              self._raise('filedeleted', [vKey, jqXHR, extraData]);\n\n              self._setCaption(cap);\n            } else {\n              params.jqXHR = jqXHR;\n              params.response = data;\n\n              self._showError(data.error, params, 'filedeleteerror');\n\n              $frame.removeClass('file-uploading');\n              $el.removeClass('disabled');\n              resetProgress();\n              return;\n            }\n\n            $frame.removeClass('file-uploading').addClass('file-deleted');\n            $frame.fadeOut('slow', function () {\n              self._clearObjects($frame);\n\n              $frame.remove();\n              resetProgress();\n\n              if (!n && self.getFileStack().length === 0) {\n                self._setCaption('');\n\n                self.reset();\n              }\n            });\n          },\n          error: function error(jqXHR, textStatus, errorThrown) {\n            var errMsg = self._parseError(jqXHR, errorThrown);\n\n            params.jqXHR = jqXHR;\n            params.response = {};\n\n            self._showError(errMsg, params, 'filedeleteerror');\n\n            $frame.removeClass('file-uploading');\n            resetProgress();\n          }\n        }, self.ajaxDeleteSettings);\n        handler($el, 'click', function () {\n          if (!self._validateMinCount()) {\n            return false;\n          }\n\n          $.ajax(settings);\n        });\n      });\n    },\n    _clearObjects: function _clearObjects($el) {\n      $el.find('video audio').each(function () {\n        this.pause();\n        $(this).remove();\n      });\n      $el.find('img object div').each(function () {\n        $(this).remove();\n      });\n    },\n    _clearFileInput: function _clearFileInput() {\n      var self = this,\n          $el = self.$element,\n          $srcFrm,\n          $tmpFrm,\n          $tmpEl;\n\n      if (isEmpty($el.val())) {\n        return;\n      } // Fix for IE ver < 11, that does not clear file inputs. Requires a sequence of steps to prevent IE\n      // crashing but still allow clearing of the file input.\n\n\n      if (self.isIE9 || self.isIE10) {\n        $srcFrm = $el.closest('form');\n        $tmpFrm = $(document.createElement('form'));\n        $tmpEl = $(document.createElement('div'));\n        $el.before($tmpEl);\n\n        if ($srcFrm.length) {\n          $srcFrm.after($tmpFrm);\n        } else {\n          $tmpEl.after($tmpFrm);\n        }\n\n        $tmpFrm.append($el).trigger('reset');\n        $tmpEl.before($el).remove();\n        $tmpFrm.remove();\n      } else {\n        // normal input clear behavior for other sane browsers\n        $el.val('');\n      }\n\n      self.fileInputCleared = true;\n    },\n    _resetUpload: function _resetUpload() {\n      var self = this;\n      self.uploadCache = {\n        content: [],\n        config: [],\n        tags: [],\n        append: true\n      };\n      self.uploadCount = 0;\n      self.uploadStatus = {};\n      self.uploadLog = [];\n      self.uploadAsyncCount = 0;\n      self.loadedImages = [];\n      self.totalImagesCount = 0;\n      self.$btnUpload.removeAttr('disabled');\n\n      self._setProgress(0);\n\n      addCss(self.$progress, 'hide');\n\n      self._resetErrors(false);\n\n      self.ajaxAborted = false;\n      self.ajaxRequests = [];\n\n      self._resetCanvas();\n    },\n    _resetCanvas: function _resetCanvas() {\n      var self = this;\n\n      if (self.canvas && self.imageCanvasContext) {\n        self.imageCanvasContext.clearRect(0, 0, self.canvas.width, self.canvas.height);\n      }\n    },\n    _hasInitialPreview: function _hasInitialPreview() {\n      var self = this;\n      return !self.overwriteInitial && previewCache.count(self.id);\n    },\n    _resetPreview: function _resetPreview() {\n      var self = this,\n          out,\n          cap;\n\n      if (previewCache.count(self.id)) {\n        out = previewCache.out(self.id);\n        self.$preview.html(out.content);\n        cap = self.initialCaption ? self.initialCaption : out.caption;\n\n        self._setCaption(cap);\n      } else {\n        self._clearPreview();\n\n        self._initCaption();\n      }\n\n      if (self.showPreview) {\n        self._initZoom();\n\n        self._initSortable();\n      }\n    },\n    _clearDefaultPreview: function _clearDefaultPreview() {\n      var self = this;\n      self.$preview.find('.file-default-preview').remove();\n    },\n    _validateDefaultPreview: function _validateDefaultPreview() {\n      var self = this;\n\n      if (!self.showPreview || isEmpty(self.defaultPreviewContent)) {\n        return;\n      }\n\n      self.$preview.html('<div class=\"file-default-preview\">' + self.defaultPreviewContent + '</div>');\n      self.$container.removeClass('file-input-new');\n\n      self._initClickable();\n    },\n    _resetPreviewThumbs: function _resetPreviewThumbs(isAjax) {\n      var self = this,\n          out;\n\n      if (isAjax) {\n        self._clearPreview();\n\n        self.clearStack();\n        return;\n      }\n\n      if (self._hasInitialPreview()) {\n        out = previewCache.out(self.id);\n        self.$preview.html(out.content);\n\n        self._setCaption(out.caption);\n\n        self._initPreviewActions();\n      } else {\n        self._clearPreview();\n      }\n    },\n    _getLayoutTemplate: function _getLayoutTemplate(t) {\n      var self = this,\n          template = ifSet(t, self.layoutTemplates, defaultLayoutTemplates[t]);\n\n      if (isEmpty(self.customLayoutTags)) {\n        return template;\n      }\n\n      return replaceTags(template, self.customLayoutTags);\n    },\n    _getPreviewTemplate: function _getPreviewTemplate(t) {\n      var self = this,\n          template = ifSet(t, self.previewTemplates, defaultPreviewTemplates[t]);\n\n      if (isEmpty(self.customPreviewTags)) {\n        return template;\n      }\n\n      return replaceTags(template, self.customPreviewTags);\n    },\n    _getOutData: function _getOutData(jqXHR, responseData, filesData) {\n      var self = this;\n      jqXHR = jqXHR || {};\n      responseData = responseData || {};\n      filesData = filesData || self.filestack.slice(0) || {};\n      return {\n        form: self.formdata,\n        files: filesData,\n        filenames: self.filenames,\n        filescount: self.getFilesCount(),\n        extra: self._getExtraData(),\n        response: responseData,\n        reader: self.reader,\n        jqXHR: jqXHR\n      };\n    },\n    _getMsgSelected: function _getMsgSelected(n) {\n      var self = this,\n          strFiles = n === 1 ? self.fileSingle : self.filePlural;\n      return n > 0 ? self.msgSelected.replace('{n}', n).replace('{files}', strFiles) : self.msgNoFilesSelected;\n    },\n    _getThumbs: function _getThumbs(css) {\n      css = css || '';\n      return this.$preview.find('.file-preview-frame:not(.file-preview-initial)' + css);\n    },\n    _getExtraData: function _getExtraData(previewId, index) {\n      var self = this,\n          data = self.uploadExtraData;\n\n      if (typeof self.uploadExtraData === \"function\") {\n        data = self.uploadExtraData(previewId, index);\n      }\n\n      return data;\n    },\n    _initXhr: function _initXhr(xhrobj, previewId, fileCount) {\n      var self = this;\n\n      if (xhrobj.upload) {\n        xhrobj.upload.addEventListener('progress', function (event) {\n          var pct = 0,\n              total = event.total,\n              position = event.loaded || event.position;\n          /** @namespace event.lengthComputable */\n\n          if (event.lengthComputable) {\n            pct = Math.floor(position / total * 100);\n          }\n\n          if (previewId) {\n            self._setAsyncUploadStatus(previewId, pct, fileCount);\n          } else {\n            self._setProgress(pct);\n          }\n        }, false);\n      }\n\n      return xhrobj;\n    },\n    _ajaxSubmit: function _ajaxSubmit(fnBefore, fnSuccess, fnComplete, fnError, previewId, index) {\n      var self = this,\n          settings;\n\n      self._raise('filepreajax', [previewId, index]);\n\n      self._uploadExtra(previewId, index);\n\n      settings = $.extend(true, {}, {\n        xhr: function xhr() {\n          var xhrobj = $.ajaxSettings.xhr();\n          return self._initXhr(xhrobj, previewId, self.getFileStack().length);\n        },\n        url: self.uploadUrl,\n        type: 'POST',\n        dataType: 'json',\n        data: self.formdata,\n        cache: false,\n        processData: false,\n        contentType: false,\n        beforeSend: fnBefore,\n        success: fnSuccess,\n        complete: fnComplete,\n        error: fnError\n      }, self.ajaxSettings);\n      self.ajaxRequests.push($.ajax(settings));\n    },\n    _initUploadSuccess: function _initUploadSuccess(out, $thumb, allFiles) {\n      var self = this,\n          append,\n          data,\n          index,\n          $newThumb,\n          content,\n          config,\n          tags,\n          i,\n          mergeArray = function mergeArray(prop, content) {\n        if (!(self[prop] instanceof Array)) {\n          self[prop] = [];\n        }\n\n        if (content && content.length) {\n          self[prop] = self[prop].concat(content);\n        }\n      };\n\n      if (!self.showPreview || typeof out !== 'object' || $.isEmptyObject(out)) {\n        return;\n      }\n\n      if (out.initialPreview !== undefined && out.initialPreview.length > 0) {\n        self.hasInitData = true;\n        content = out.initialPreview || [];\n        config = out.initialPreviewConfig || [];\n        tags = out.initialPreviewThumbTags || [];\n        append = out.append === undefined || out.append ? true : false;\n\n        if (content.length > 0 && !isArray(content)) {\n          content = content.split(self.initialPreviewDelimiter);\n        }\n\n        self.overwriteInitial = false;\n        mergeArray('initialPreview', content);\n        mergeArray('initialPreviewConfig', config);\n        mergeArray('initialPreviewThumbTags', tags);\n\n        if ($thumb !== undefined) {\n          if (!allFiles) {\n            index = previewCache.add(self.id, content, config[0], tags[0], append);\n            data = previewCache.get(self.id, index, false);\n            $newThumb = $(data).hide();\n            $thumb.after($newThumb).fadeOut('slow', function () {\n              $newThumb.fadeIn('slow').css('display:inline-block');\n\n              self._initPreviewActions();\n\n              self._clearFileInput();\n\n              $thumb.remove();\n            });\n          } else {\n            i = $thumb.attr('data-fileindex');\n            self.uploadCache.content[i] = content[0];\n            self.uploadCache.config[i] = config[0] || [];\n            self.uploadCache.tags[i] = tags[0] || [];\n            self.uploadCache.append = append;\n          }\n        } else {\n          previewCache.set(self.id, content, config, tags, append);\n\n          self._initPreview();\n\n          self._initPreviewActions();\n        }\n      }\n    },\n    _initSuccessThumbs: function _initSuccessThumbs() {\n      var self = this;\n\n      if (!self.showPreview) {\n        return;\n      }\n\n      self._getThumbs('.file-preview-success').each(function () {\n        var $thumb = $(this),\n            $remove = $thumb.find('.kv-file-remove');\n        $remove.removeAttr('disabled');\n        handler($remove, 'click', function () {\n          var out = self._raise('filesuccessremove', [$thumb.attr('id'), $thumb.data('fileindex')]);\n\n          cleanMemory($thumb);\n\n          if (out === false) {\n            return;\n          }\n\n          $thumb.fadeOut('slow', function () {\n            $thumb.remove();\n\n            if (!self.$preview.find('.file-preview-frame').length) {\n              self.reset();\n            }\n          });\n        });\n      });\n    },\n    _checkAsyncComplete: function _checkAsyncComplete() {\n      var self = this,\n          previewId,\n          i;\n\n      for (i = 0; i < self.filestack.length; i++) {\n        if (self.filestack[i]) {\n          previewId = self.previewInitId + \"-\" + i;\n\n          if ($.inArray(previewId, self.uploadLog) === -1) {\n            return false;\n          }\n        }\n      }\n\n      return self.uploadAsyncCount === self.uploadLog.length;\n    },\n    _uploadExtra: function _uploadExtra(previewId, index) {\n      var self = this,\n          data = self._getExtraData(previewId, index);\n\n      if (data.length === 0) {\n        return;\n      }\n\n      $.each(data, function (key, value) {\n        self.formdata.append(key, value);\n      });\n    },\n    _uploadSingle: function _uploadSingle(i, files, allFiles) {\n      var self = this,\n          total = self.getFileStack().length,\n          formdata = new FormData(),\n          outData,\n          previewId = self.previewInitId + \"-\" + i,\n          $thumb,\n          chkComplete,\n          $btnUpload,\n          $btnDelete,\n          hasPostData = self.filestack.length > 0 || !$.isEmptyObject(self.uploadExtraData),\n          fnBefore,\n          fnSuccess,\n          fnComplete,\n          fnError,\n          updateUploadLog,\n          params = {\n        id: previewId,\n        index: i\n      };\n      self.formdata = formdata;\n\n      if (self.showPreview) {\n        $thumb = $('#' + previewId + ':not(.file-preview-initial)');\n        $btnUpload = $thumb.find('.kv-file-upload');\n        $btnDelete = $thumb.find('.kv-file-remove');\n        $('#' + previewId).find('.file-thumb-progress').removeClass('hide');\n      }\n\n      if (total === 0 || !hasPostData || $btnUpload && $btnUpload.hasClass('disabled') || self._abort(params)) {\n        return;\n      }\n\n      updateUploadLog = function updateUploadLog(i, previewId) {\n        self.updateStack(i, undefined);\n        self.uploadLog.push(previewId);\n\n        if (self._checkAsyncComplete()) {\n          self.fileBatchCompleted = true;\n        }\n      };\n\n      chkComplete = function chkComplete() {\n        var u = self.uploadCache;\n\n        if (!self.fileBatchCompleted) {\n          return;\n        }\n\n        setTimeout(function () {\n          if (self.showPreview) {\n            previewCache.set(self.id, u.content, u.config, u.tags, u.append);\n\n            if (self.hasInitData) {\n              self._initPreview();\n\n              self._initPreviewActions();\n            }\n          }\n\n          self.unlock();\n\n          self._clearFileInput();\n\n          self._raise('filebatchuploadcomplete', [self.filestack, self._getExtraData()]);\n\n          self.uploadCount = 0;\n          self.uploadStatus = {};\n          self.uploadLog = [];\n\n          self._setProgress(101);\n        }, 100);\n      };\n\n      fnBefore = function fnBefore(jqXHR) {\n        outData = self._getOutData(jqXHR);\n        self.fileBatchCompleted = false;\n\n        if (self.showPreview) {\n          if (!$thumb.hasClass('file-preview-success')) {\n            self._setThumbStatus($thumb, 'Loading');\n\n            addCss($thumb, 'file-uploading');\n          }\n\n          $btnUpload.attr('disabled', true);\n          $btnDelete.attr('disabled', true);\n        }\n\n        if (!allFiles) {\n          self.lock();\n        }\n\n        self._raise('filepreupload', [outData, previewId, i]);\n\n        $.extend(true, params, outData);\n\n        if (self._abort(params)) {\n          jqXHR.abort();\n\n          self._setProgressCancelled();\n        }\n      };\n\n      fnSuccess = function fnSuccess(data, textStatus, jqXHR) {\n        var pid = self.showPreview && $thumb.attr('id') ? $thumb.attr('id') : previewId;\n        outData = self._getOutData(jqXHR, data);\n        $.extend(true, params, outData);\n        setTimeout(function () {\n          if (isEmpty(data) || isEmpty(data.error)) {\n            if (self.showPreview) {\n              self._setThumbStatus($thumb, 'Success');\n\n              $btnUpload.hide();\n\n              self._initUploadSuccess(data, $thumb, allFiles);\n            }\n\n            self._raise('fileuploaded', [outData, pid, i]);\n\n            if (!allFiles) {\n              self.updateStack(i, undefined);\n            } else {\n              updateUploadLog(i, pid);\n            }\n          } else {\n            self._showUploadError(data.error, params);\n\n            self._setPreviewError($thumb, i);\n\n            if (allFiles) {\n              updateUploadLog(i, pid);\n            }\n          }\n        }, 100);\n      };\n\n      fnComplete = function fnComplete() {\n        setTimeout(function () {\n          if (self.showPreview) {\n            $btnUpload.removeAttr('disabled');\n            $btnDelete.removeAttr('disabled');\n            $thumb.removeClass('file-uploading');\n\n            self._setProgress(101, $('#' + previewId).find('.file-thumb-progress'));\n          }\n\n          if (!allFiles) {\n            self.unlock(false);\n\n            self._clearFileInput();\n          } else {\n            chkComplete();\n          }\n\n          self._initSuccessThumbs();\n        }, 100);\n      };\n\n      fnError = function fnError(jqXHR, textStatus, errorThrown) {\n        var errMsg = self._parseError(jqXHR, errorThrown, allFiles ? files[i].name : null);\n\n        setTimeout(function () {\n          if (allFiles) {\n            updateUploadLog(i, previewId);\n          }\n\n          self.uploadStatus[previewId] = 100;\n\n          self._setPreviewError($thumb, i);\n\n          $.extend(true, params, self._getOutData(jqXHR));\n\n          self._showUploadError(errMsg, params);\n        }, 100);\n      };\n\n      formdata.append(self.uploadFileAttr, files[i], self.filenames[i]);\n      formdata.append('file_id', i);\n\n      self._ajaxSubmit(fnBefore, fnSuccess, fnComplete, fnError, previewId, i);\n    },\n    _uploadBatch: function _uploadBatch() {\n      var self = this,\n          files = self.filestack,\n          total = files.length,\n          params = {},\n          fnBefore,\n          fnSuccess,\n          fnError,\n          fnComplete,\n          hasPostData = self.filestack.length > 0 || !$.isEmptyObject(self.uploadExtraData),\n          setAllUploaded;\n      self.formdata = new FormData();\n\n      if (total === 0 || !hasPostData || self._abort(params)) {\n        return;\n      }\n\n      setAllUploaded = function setAllUploaded() {\n        $.each(files, function (key) {\n          self.updateStack(key, undefined);\n        });\n\n        self._clearFileInput();\n      };\n\n      fnBefore = function fnBefore(jqXHR) {\n        self.lock();\n\n        var outData = self._getOutData(jqXHR);\n\n        if (self.showPreview) {\n          self._getThumbs().each(function () {\n            var $thumb = $(this),\n                $btnUpload = $thumb.find('.kv-file-upload'),\n                $btnDelete = $thumb.find('.kv-file-remove');\n\n            if (!$thumb.hasClass('file-preview-success')) {\n              self._setThumbStatus($thumb, 'Loading');\n\n              addCss($thumb, 'file-uploading');\n            }\n\n            $btnUpload.attr('disabled', true);\n            $btnDelete.attr('disabled', true);\n          });\n        }\n\n        self._raise('filebatchpreupload', [outData]);\n\n        if (self._abort(outData)) {\n          jqXHR.abort();\n\n          self._setProgressCancelled();\n        }\n      };\n\n      fnSuccess = function fnSuccess(data, textStatus, jqXHR) {\n        /** @namespace data.errorkeys */\n        var outData = self._getOutData(jqXHR, data),\n            $thumbs = self._getThumbs(':not(.file-preview-error)'),\n            key = 0,\n            keys = isEmpty(data) || isEmpty(data.errorkeys) ? [] : data.errorkeys;\n\n        if (isEmpty(data) || isEmpty(data.error)) {\n          self._raise('filebatchuploadsuccess', [outData]);\n\n          setAllUploaded();\n\n          if (self.showPreview) {\n            $thumbs.each(function () {\n              var $thumb = $(this),\n                  $btnUpload = $thumb.find('.kv-file-upload');\n              $thumb.find('.kv-file-upload').hide();\n\n              self._setThumbStatus($thumb, 'Success');\n\n              $thumb.removeClass('file-uploading');\n              $btnUpload.removeAttr('disabled');\n            });\n\n            self._initUploadSuccess(data);\n          } else {\n            self.reset();\n          }\n        } else {\n          if (self.showPreview) {\n            $thumbs.each(function () {\n              var $thumb = $(this),\n                  $btnDelete = $thumb.find('.kv-file-remove'),\n                  $btnUpload = $thumb.find('.kv-file-upload');\n              $thumb.removeClass('file-uploading');\n              $btnUpload.removeAttr('disabled');\n              $btnDelete.removeAttr('disabled');\n\n              if (keys.length === 0) {\n                self._setPreviewError($thumb);\n\n                return;\n              }\n\n              if ($.inArray(key, keys) !== -1) {\n                self._setPreviewError($thumb);\n              } else {\n                $thumb.find('.kv-file-upload').hide();\n\n                self._setThumbStatus($thumb, 'Success');\n\n                self.updateStack(key, undefined);\n              }\n\n              key++;\n            });\n\n            self._initUploadSuccess(data);\n          }\n\n          self._showUploadError(data.error, outData, 'filebatchuploaderror');\n        }\n      };\n\n      fnComplete = function fnComplete() {\n        self._setProgress(101);\n\n        self.unlock();\n\n        self._initSuccessThumbs();\n\n        self._clearFileInput();\n\n        self._raise('filebatchuploadcomplete', [self.filestack, self._getExtraData()]);\n      };\n\n      fnError = function fnError(jqXHR, textStatus, errorThrown) {\n        var outData = self._getOutData(jqXHR),\n            errMsg = self._parseError(jqXHR, errorThrown);\n\n        self._showUploadError(errMsg, outData, 'filebatchuploaderror');\n\n        self.uploadFileCount = total - 1;\n\n        if (!self.showPreview) {\n          return;\n        }\n\n        self._getThumbs().each(function () {\n          var $thumb = $(this),\n              key = $thumb.attr('data-fileindex');\n          $thumb.removeClass('file-uploading');\n\n          if (self.filestack[key] !== undefined) {\n            self._setPreviewError($thumb);\n          }\n        });\n\n        self._getThumbs().removeClass('file-uploading');\n\n        self._getThumbs(' .kv-file-upload').removeAttr('disabled');\n\n        self._getThumbs(' .kv-file-delete').removeAttr('disabled');\n      };\n\n      $.each(files, function (key, data) {\n        if (!isEmpty(files[key])) {\n          self.formdata.append(self.uploadFileAttr, data, self.filenames[key]);\n        }\n      });\n\n      self._ajaxSubmit(fnBefore, fnSuccess, fnComplete, fnError);\n    },\n    _uploadExtraOnly: function _uploadExtraOnly() {\n      var self = this,\n          params = {},\n          fnBefore,\n          fnSuccess,\n          fnComplete,\n          fnError;\n      self.formdata = new FormData();\n\n      if (self._abort(params)) {\n        return;\n      }\n\n      fnBefore = function fnBefore(jqXHR) {\n        self.lock();\n\n        var outData = self._getOutData(jqXHR);\n\n        self._raise('filebatchpreupload', [outData]);\n\n        self._setProgress(50);\n\n        params.data = outData;\n        params.xhr = jqXHR;\n\n        if (self._abort(params)) {\n          jqXHR.abort();\n\n          self._setProgressCancelled();\n        }\n      };\n\n      fnSuccess = function fnSuccess(data, textStatus, jqXHR) {\n        var outData = self._getOutData(jqXHR, data);\n\n        if (isEmpty(data) || isEmpty(data.error)) {\n          self._raise('filebatchuploadsuccess', [outData]);\n\n          self._clearFileInput();\n\n          self._initUploadSuccess(data);\n        } else {\n          self._showUploadError(data.error, outData, 'filebatchuploaderror');\n        }\n      };\n\n      fnComplete = function fnComplete() {\n        self._setProgress(101);\n\n        self.unlock();\n\n        self._clearFileInput();\n\n        self._raise('filebatchuploadcomplete', [self.filestack, self._getExtraData()]);\n      };\n\n      fnError = function fnError(jqXHR, textStatus, errorThrown) {\n        var outData = self._getOutData(jqXHR),\n            errMsg = self._parseError(jqXHR, errorThrown);\n\n        params.data = outData;\n\n        self._showUploadError(errMsg, outData, 'filebatchuploaderror');\n      };\n\n      self._ajaxSubmit(fnBefore, fnSuccess, fnComplete, fnError);\n    },\n    _initFileActions: function _initFileActions() {\n      var self = this;\n\n      if (!self.showPreview) {\n        return;\n      }\n\n      self._initZoomButton();\n\n      self.$preview.find('.kv-file-remove').each(function () {\n        var $el = $(this),\n            $frame = $el.closest('.file-preview-frame'),\n            hasError,\n            id = $frame.attr('id'),\n            ind = $frame.attr('data-fileindex'),\n            n,\n            cap,\n            status;\n        handler($el, 'click', function () {\n          status = self._raise('filepreremove', [id, ind]);\n\n          if (status === false || !self._validateMinCount()) {\n            return false;\n          }\n\n          hasError = $frame.hasClass('file-preview-error');\n          cleanMemory($frame);\n          $frame.fadeOut('slow', function () {\n            self.updateStack(ind, undefined);\n\n            self._clearObjects($frame);\n\n            $frame.remove();\n\n            if (id && hasError) {\n              self.$errorContainer.find('li[data-file-id=\"' + id + '\"]').fadeOut('fast', function () {\n                $(this).remove();\n\n                if (!self._errorsExist()) {\n                  self._resetErrors();\n                }\n              });\n            }\n\n            self._clearFileInput();\n\n            var filestack = self.getFileStack(true),\n                chk = previewCache.count(self.id),\n                len = filestack.length,\n                hasThumb = self.showPreview && self.$preview.find('.file-preview-frame').length;\n\n            if (len === 0 && chk === 0 && !hasThumb) {\n              self.reset();\n            } else {\n              n = chk + len;\n              cap = n > 1 ? self._getMsgSelected(n) : filestack[0] ? self._getFileNames()[0] : '';\n\n              self._setCaption(cap);\n            }\n\n            self._raise('fileremoved', [id, ind]);\n          });\n        });\n      });\n      self.$preview.find('.kv-file-upload').each(function () {\n        var $el = $(this);\n        handler($el, 'click', function () {\n          var $frame = $el.closest('.file-preview-frame'),\n              ind = $frame.attr('data-fileindex');\n\n          if (!$frame.hasClass('file-preview-error')) {\n            self._uploadSingle(ind, self.filestack, false);\n          }\n        });\n      });\n    },\n    _hideFileIcon: function _hideFileIcon() {\n      if (this.overwriteInitial) {\n        this.$captionContainer.find('.kv-caption-icon').hide();\n      }\n    },\n    _showFileIcon: function _showFileIcon() {\n      this.$captionContainer.find('.kv-caption-icon').show();\n    },\n    _getSize: function _getSize(bytes) {\n      var size = parseFloat(bytes);\n\n      if (bytes === null || isNaN(size)) {\n        return '';\n      }\n\n      var self = this,\n          i,\n          func = self.fileSizeGetter,\n          sizes,\n          out;\n\n      if (typeof func === 'function') {\n        out = func(bytes);\n      } else {\n        i = Math.floor(Math.log(size) / Math.log(1024));\n        sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n        out = (size / Math.pow(1024, i)).toFixed(2) * 1 + ' ' + sizes[i];\n      }\n\n      return self._getLayoutTemplate('size').replace('{sizeText}', out);\n    },\n    _generatePreviewTemplate: function _generatePreviewTemplate(cat, data, fname, ftype, previewId, isError, size, frameClass, foot, ind) {\n      var self = this,\n          tmplt = self._getPreviewTemplate(cat),\n          content,\n          sText,\n          css = frameClass || '',\n          config = ifSet(cat, self.previewSettings, defaultPreviewSettings[cat]),\n          caption = self.slug(fname),\n          footer = foot || self._renderFileFooter(caption, size, config.width, isError);\n\n      ind = ind || previewId.slice(previewId.lastIndexOf('-') + 1);\n      tmplt = self._parseFilePreviewIcon(tmplt, fname);\n\n      if (cat === 'text' || cat === 'html') {\n        sText = cat === 'text' ? htmlEncode(data) : data;\n        content = tmplt.replace(/\\{previewId}/g, previewId).replace(/\\{caption}/g, caption).replace(/\\{width}/g, config.width).replace(/\\{height}/g, config.height).replace(/\\{frameClass}/g, css).replace(/\\{cat}/g, ftype).replace(/\\{footer}/g, footer).replace(/\\{fileindex}/g, ind).replace(/\\{data}/g, sText).replace(/\\{template}/g, cat);\n      } else {\n        content = tmplt.replace(/\\{previewId}/g, previewId).replace(/\\{caption}/g, caption).replace(/\\{frameClass}/g, css).replace(/\\{type}/g, ftype).replace(/\\{fileindex}/g, ind).replace(/\\{width}/g, config.width).replace(/\\{height}/g, config.height).replace(/\\{footer}/g, footer).replace(/\\{data}/g, data).replace(/\\{template}/g, cat);\n      }\n\n      return content;\n    },\n    _previewDefault: function _previewDefault(file, previewId, isDisabled) {\n      var self = this,\n          $preview = self.$preview,\n          $previewLive = $preview.find('.file-live-thumbs');\n\n      if (!self.showPreview) {\n        return;\n      }\n\n      var fname = file ? file.name : '',\n          ftype = file ? file.type : '',\n          content,\n          isError = isDisabled === true && !self.isUploadable,\n          data = objUrl.createObjectURL(file);\n\n      self._clearDefaultPreview();\n\n      content = self._generatePreviewTemplate('other', data, fname, ftype, previewId, isError, file.size);\n\n      if (!$previewLive.length) {\n        $previewLive = $(document.createElement('div')).addClass('file-live-thumbs').appendTo($preview);\n      }\n\n      $previewLive.append(\"\\n\" + content);\n\n      if (isDisabled === true && self.isUploadable) {\n        self._setThumbStatus($('#' + previewId), 'Error');\n      }\n    },\n    _previewFile: function _previewFile(i, file, theFile, previewId, data) {\n      if (!this.showPreview) {\n        return;\n      }\n\n      var self = this,\n          cat = self._parseFileType(file),\n          fname = file ? file.name : '',\n          caption = self.slug(fname),\n          types = self.allowedPreviewTypes,\n          mimes = self.allowedPreviewMimeTypes,\n          $preview = self.$preview,\n          chkTypes = types && types.indexOf(cat) >= 0,\n          $previewLive = $preview.find('.file-live-thumbs'),\n          iData = cat === 'text' || cat === 'html' || cat === 'image' ? theFile.target.result : data,\n          content,\n          chkMimes = mimes && mimes.indexOf(file.type) !== -1;\n\n      if (!$previewLive.length) {\n        $previewLive = $(document.createElement('div')).addClass('file-live-thumbs').appendTo($preview);\n      }\n      /** @namespace window.DOMPurify */\n\n\n      if (cat === 'html' && self.purifyHtml && window.DOMPurify) {\n        iData = window.DOMPurify.sanitize(iData);\n      }\n\n      if (chkTypes || chkMimes) {\n        content = self._generatePreviewTemplate(cat, iData, fname, file.type, previewId, false, file.size);\n\n        self._clearDefaultPreview();\n\n        $previewLive.append(\"\\n\" + content);\n\n        self._validateImage(i, previewId, caption, file.type);\n      } else {\n        self._previewDefault(file, previewId);\n      }\n\n      self._initSortable();\n    },\n    _slugDefault: function _slugDefault(text) {\n      return isEmpty(text) ? '' : String(text).replace(/[\\-\\[\\]\\/\\{}:;#%=\\(\\)\\*\\+\\?\\\\\\^\\$\\|<>&\"']/g, '_');\n    },\n    _readFiles: function _readFiles(files) {\n      this.reader = new FileReader();\n\n      var self = this,\n          $el = self.$element,\n          $preview = self.$preview,\n          reader = self.reader,\n          $container = self.$previewContainer,\n          $status = self.$previewStatus,\n          msgLoading = self.msgLoading,\n          msgProgress = self.msgProgress,\n          previewInitId = self.previewInitId,\n          numFiles = files.length,\n          settings = self.fileTypeSettings,\n          ctr = self.filestack.length,\n          _readFile,\n          maxPreviewSize = self.maxFilePreviewSize && parseFloat(self.maxFilePreviewSize),\n          canPreview = $preview.length && (!maxPreviewSize || isNaN(maxPreviewSize)),\n          throwError = function throwError(msg, file, previewId, index) {\n        var p1 = $.extend(true, {}, self._getOutData({}, {}, files), {\n          id: previewId,\n          index: index\n        }),\n            p2 = {\n          id: previewId,\n          index: index,\n          file: file,\n          files: files\n        };\n\n        self._previewDefault(file, previewId, true);\n\n        if (self.isUploadable) {\n          self.addToStack(undefined);\n        }\n\n        setTimeout(function () {\n          _readFile(index + 1);\n        }, 100);\n\n        self._initFileActions();\n\n        if (self.removeFromPreviewOnError) {\n          $('#' + previewId).remove();\n        }\n\n        return self.isUploadable ? self._showUploadError(msg, p1) : self._showError(msg, p2);\n      };\n\n      self.loadedImages = [];\n      self.totalImagesCount = 0;\n      $.each(files, function (key, file) {\n        var func = self.fileTypeSettings.image || defaultFileTypeSettings.image;\n\n        if (func && func(file.type)) {\n          self.totalImagesCount++;\n        }\n      });\n\n      _readFile = function readFile(i) {\n        if (isEmpty($el.attr('multiple'))) {\n          numFiles = 1;\n        }\n\n        if (i >= numFiles) {\n          if (self.isUploadable && self.filestack.length > 0) {\n            self._raise('filebatchselected', [self.getFileStack()]);\n          } else {\n            self._raise('filebatchselected', [files]);\n          }\n\n          $container.removeClass('file-thumb-loading');\n          $status.html('');\n          return;\n        }\n\n        var node = ctr + i,\n            previewId = previewInitId + \"-\" + node,\n            isText,\n            isImage,\n            file = files[i],\n            caption = self.slug(file.name),\n            fileSize = (file.size || 0) / 1000,\n            checkFile,\n            fileExtExpr = '',\n            previewData = objUrl.createObjectURL(file),\n            fileCount = 0,\n            j,\n            msg,\n            typ,\n            chk,\n            fileTypes = self.allowedFileTypes,\n            strTypes = isEmpty(fileTypes) ? '' : fileTypes.join(', '),\n            fileExt = self.allowedFileExtensions,\n            strExt = isEmpty(fileExt) ? '' : fileExt.join(', ');\n\n        if (!isEmpty(fileExt)) {\n          fileExtExpr = new RegExp('\\\\.(' + fileExt.join('|') + ')$', 'i');\n        }\n\n        fileSize = fileSize.toFixed(2);\n\n        if (self.maxFileSize > 0 && fileSize > self.maxFileSize) {\n          msg = self.msgSizeTooLarge.replace('{name}', caption).replace('{size}', fileSize).replace('{maxSize}', self.maxFileSize);\n          self.isError = throwError(msg, file, previewId, i);\n          return;\n        }\n\n        if (!isEmpty(fileTypes) && isArray(fileTypes)) {\n          for (j = 0; j < fileTypes.length; j += 1) {\n            typ = fileTypes[j];\n            checkFile = settings[typ];\n            chk = checkFile !== undefined && checkFile(file.type, caption);\n            fileCount += isEmpty(chk) ? 0 : chk.length;\n          }\n\n          if (fileCount === 0) {\n            msg = self.msgInvalidFileType.replace('{name}', caption).replace('{types}', strTypes);\n            self.isError = throwError(msg, file, previewId, i);\n            return;\n          }\n        }\n\n        if (fileCount === 0 && !isEmpty(fileExt) && isArray(fileExt) && !isEmpty(fileExtExpr)) {\n          chk = compare(caption, fileExtExpr);\n          fileCount += isEmpty(chk) ? 0 : chk.length;\n\n          if (fileCount === 0) {\n            msg = self.msgInvalidFileExtension.replace('{name}', caption).replace('{extensions}', strExt);\n            self.isError = throwError(msg, file, previewId, i);\n            return;\n          }\n        }\n\n        if (!self.showPreview) {\n          self.addToStack(file);\n          setTimeout(function () {\n            _readFile(i + 1);\n          }, 100);\n\n          self._raise('fileloaded', [file, previewId, i, reader]);\n\n          return;\n        }\n\n        if (!canPreview && fileSize > maxPreviewSize) {\n          self.addToStack(file);\n          $container.addClass('file-thumb-loading');\n\n          self._previewDefault(file, previewId);\n\n          self._initFileActions();\n\n          self._updateFileDetails(numFiles);\n\n          _readFile(i + 1);\n\n          return;\n        }\n\n        if ($preview.length && FileReader !== undefined) {\n          $status.html(msgLoading.replace('{index}', i + 1).replace('{files}', numFiles));\n          $container.addClass('file-thumb-loading');\n\n          reader.onerror = function (evt) {\n            self._errorHandler(evt, caption);\n          };\n\n          reader.onload = function (theFile) {\n            self._previewFile(i, file, theFile, previewId, previewData);\n\n            self._initFileActions();\n          };\n\n          reader.onloadend = function () {\n            msg = msgProgress.replace('{index}', i + 1).replace('{files}', numFiles).replace('{percent}', 50).replace('{name}', caption);\n            setTimeout(function () {\n              $status.html(msg);\n\n              self._updateFileDetails(numFiles);\n\n              _readFile(i + 1);\n            }, 100);\n\n            self._raise('fileloaded', [file, previewId, i, reader]);\n          };\n\n          reader.onprogress = function (data) {\n            if (data.lengthComputable) {\n              var fact = data.loaded / data.total * 100,\n                  progress = Math.ceil(fact);\n              msg = msgProgress.replace('{index}', i + 1).replace('{files}', numFiles).replace('{percent}', progress).replace('{name}', caption);\n              setTimeout(function () {\n                $status.html(msg);\n              }, 100);\n            }\n          };\n\n          isText = ifSet('text', settings, defaultFileTypeSettings.text);\n          isImage = ifSet('image', settings, defaultFileTypeSettings.image);\n\n          if (isText(file.type, caption)) {\n            reader.readAsText(file, self.textEncoding);\n          } else {\n            if (isImage(file.type, caption)) {\n              reader.readAsDataURL(file);\n            } else {\n              reader.readAsArrayBuffer(file);\n            }\n          }\n        } else {\n          self._previewDefault(file, previewId);\n\n          setTimeout(function () {\n            _readFile(i + 1);\n\n            self._updateFileDetails(numFiles);\n          }, 100);\n\n          self._raise('fileloaded', [file, previewId, i, reader]);\n        }\n\n        self.addToStack(file);\n      };\n\n      _readFile(0);\n\n      self._updateFileDetails(numFiles, false);\n    },\n    _updateFileDetails: function _updateFileDetails(numFiles) {\n      var self = this,\n          $el = self.$element,\n          fileStack = self.getFileStack(),\n          name = isIE(9) && findFileName($el.val()) || $el[0].files[0] && $el[0].files[0].name || fileStack.length && fileStack[0].name || '',\n          label = self.slug(name),\n          n = self.isUploadable ? fileStack.length : numFiles,\n          nFiles = previewCache.count(self.id) + n,\n          log = n > 1 ? self._getMsgSelected(nFiles) : label;\n\n      if (self.isError) {\n        self.$previewContainer.removeClass('file-thumb-loading');\n        self.$previewStatus.html('');\n        self.$captionContainer.find('.kv-caption-icon').hide();\n      } else {\n        self._showFileIcon();\n      }\n\n      self._setCaption(log, self.isError);\n\n      self.$container.removeClass('file-input-new file-input-ajax-new');\n\n      if (arguments.length === 1) {\n        self._raise('fileselect', [numFiles, label]);\n      }\n\n      if (previewCache.count(self.id)) {\n        self._initPreviewActions();\n      }\n    },\n    _setThumbStatus: function _setThumbStatus($thumb, status) {\n      var self = this;\n\n      if (!self.showPreview) {\n        return;\n      }\n\n      var icon = 'indicator' + status,\n          msg = icon + 'Title',\n          css = 'file-preview-' + status.toLowerCase(),\n          $indicator = $thumb.find('.file-upload-indicator'),\n          config = self.fileActionSettings;\n      $thumb.removeClass('file-preview-success file-preview-error file-preview-loading');\n\n      if (status === 'Error') {\n        $thumb.find('.kv-file-upload').attr('disabled', true);\n      }\n\n      if (status === 'Success') {\n        $thumb.find('.file-drag-handle').remove();\n        $indicator.css('margin-left', 0);\n      }\n\n      $indicator.html(config[icon]);\n      $indicator.attr('title', config[msg]);\n      $thumb.addClass(css);\n    },\n    _setProgressCancelled: function _setProgressCancelled() {\n      var self = this;\n\n      self._setProgress(101, self.$progress, self.msgCancelled);\n    },\n    _setProgress: function _setProgress(p, $el, error) {\n      var self = this,\n          pct = Math.min(p, 100),\n          template = pct < 100 ? self.progressTemplate : error ? self.progressErrorTemplate : p <= 100 ? self.progressTemplate : self.progressCompleteTemplate,\n          pctLimit = self.progressUploadThreshold;\n      $el = $el || self.$progress;\n\n      if (!isEmpty(template)) {\n        if (pctLimit && pct > pctLimit && p <= 100) {\n          var out = template.replace('{percent}', pctLimit).replace('{percent}', pctLimit).replace('{percent}%', self.msgUploadThreshold);\n          $el.html(out);\n        } else {\n          $el.html(template.replace(/\\{percent}/g, pct));\n        }\n\n        if (error) {\n          $el.find('[role=\"progressbar\"]').html(error);\n        }\n      }\n    },\n    _setFileDropZoneTitle: function _setFileDropZoneTitle() {\n      var self = this,\n          $zone = self.$container.find('.file-drop-zone'),\n          title = self.dropZoneTitle,\n          strFiles;\n\n      if (self.isClickable) {\n        strFiles = isEmpty(self.$element.attr('multiple')) ? self.fileSingle : self.filePlural;\n        title += self.dropZoneClickTitle.replace('{files}', strFiles);\n      }\n\n      $zone.find('.' + self.dropZoneTitleClass).remove();\n\n      if (!self.isUploadable || !self.showPreview || $zone.length === 0 || self.getFileStack().length > 0 || !self.dropZoneEnabled) {\n        return;\n      }\n\n      if ($zone.find('.file-preview-frame').length === 0 && isEmpty(self.defaultPreviewContent)) {\n        $zone.prepend('<div class=\"' + self.dropZoneTitleClass + '\">' + title + '</div>');\n      }\n\n      self.$container.removeClass('file-input-new');\n      addCss(self.$container, 'file-input-ajax-new');\n    },\n    _setAsyncUploadStatus: function _setAsyncUploadStatus(previewId, pct, total) {\n      var self = this,\n          sum = 0;\n\n      self._setProgress(pct, $('#' + previewId).find('.file-thumb-progress'));\n\n      self.uploadStatus[previewId] = pct;\n      $.each(self.uploadStatus, function (key, value) {\n        sum += value;\n      });\n\n      self._setProgress(Math.floor(sum / total));\n    },\n    _validateMinCount: function _validateMinCount() {\n      var self = this,\n          len = self.isUploadable ? self.getFileStack().length : self.$element.get(0).files.length;\n\n      if (self.validateInitialCount && self.minFileCount > 0 && self._getFileCount(len - 1) < self.minFileCount) {\n        self._noFilesError({});\n\n        return false;\n      }\n\n      return true;\n    },\n    _getFileCount: function _getFileCount(fileCount) {\n      var self = this,\n          addCount = 0;\n\n      if (self.validateInitialCount && !self.overwriteInitial) {\n        addCount = previewCache.count(self.id);\n        fileCount += addCount;\n      }\n\n      return fileCount;\n    },\n    _getFileName: function _getFileName(file) {\n      return file && file.name ? this.slug(file.name) : undefined;\n    },\n    _getFileNames: function _getFileNames(skipNull) {\n      var self = this;\n      return self.filenames.filter(function (n) {\n        return skipNull ? n !== undefined : n !== undefined && n !== null;\n      });\n    },\n    _setPreviewError: function _setPreviewError($thumb, i, val) {\n      var self = this;\n\n      if (i !== undefined) {\n        self.updateStack(i, val);\n      }\n\n      if (self.removeFromPreviewOnError) {\n        $thumb.remove();\n      } else {\n        self._setThumbStatus($thumb, 'Error');\n      }\n    },\n    _checkDimensions: function _checkDimensions(i, chk, $img, $thumb, fname, type, params) {\n      var self = this,\n          msg,\n          dim,\n          tag = chk === 'Small' ? 'min' : 'max',\n          limit = self[tag + 'Image' + type],\n          $imgEl,\n          isValid;\n\n      if (isEmpty(limit) || !$img.length) {\n        return;\n      }\n\n      $imgEl = $img[0];\n      dim = type === 'Width' ? $imgEl.naturalWidth || $imgEl.width : $imgEl.naturalHeight || $imgEl.height;\n      isValid = chk === 'Small' ? dim >= limit : dim <= limit;\n\n      if (isValid) {\n        return;\n      }\n\n      msg = self['msgImage' + type + chk].replace('{name}', fname).replace('{size}', limit);\n\n      self._showUploadError(msg, params);\n\n      self._setPreviewError($thumb, i, null);\n    },\n    _validateImage: function _validateImage(i, previewId, fname, ftype) {\n      var self = this,\n          $preview = self.$preview,\n          params,\n          w1,\n          w2,\n          $thumb = $preview.find(\"#\" + previewId),\n          $img = $thumb.find('img');\n      fname = fname || 'Untitled';\n\n      if (!$img.length) {\n        return;\n      }\n\n      handler($img, 'load', function () {\n        w1 = $thumb.width();\n        w2 = $preview.width();\n\n        if (w1 > w2) {\n          $img.css('width', '100%');\n          $thumb.css('width', '97%');\n        }\n\n        params = {\n          ind: i,\n          id: previewId\n        };\n\n        self._checkDimensions(i, 'Small', $img, $thumb, fname, 'Width', params);\n\n        self._checkDimensions(i, 'Small', $img, $thumb, fname, 'Height', params);\n\n        if (!self.resizeImage) {\n          self._checkDimensions(i, 'Large', $img, $thumb, fname, 'Width', params);\n\n          self._checkDimensions(i, 'Large', $img, $thumb, fname, 'Height', params);\n        }\n\n        self._raise('fileimageloaded', [previewId]);\n\n        self.loadedImages.push({\n          ind: i,\n          img: $img,\n          thumb: $thumb,\n          pid: previewId,\n          typ: ftype\n        });\n\n        self._validateAllImages();\n\n        objUrl.revokeObjectURL($img.attr('src'));\n      });\n    },\n    _validateAllImages: function _validateAllImages() {\n      var self = this,\n          i,\n          config,\n          $img,\n          $thumb,\n          pid,\n          ind,\n          params = {},\n          errFunc;\n\n      if (self.loadedImages.length !== self.totalImagesCount) {\n        return;\n      }\n\n      self._raise('fileimagesloaded');\n\n      if (!self.resizeImage) {\n        return;\n      }\n\n      errFunc = self.isUploadable ? self._showUploadError : self._showError;\n\n      for (i = 0; i < self.loadedImages.length; i++) {\n        config = self.loadedImages[i];\n        $img = config.img;\n        $thumb = config.thumb;\n        pid = config.pid;\n        ind = config.ind;\n        params = {\n          id: pid,\n          'index': ind\n        };\n\n        if (!self._getResizedImage($img[0], config.typ, pid, ind)) {\n          errFunc(self.msgImageResizeError, params, 'fileimageresizeerror');\n\n          self._setPreviewError($thumb, ind);\n        }\n      }\n\n      self._raise('fileimagesresized');\n    },\n    _getResizedImage: function _getResizedImage(image, type, pid, ind) {\n      var self = this,\n          width = image.naturalWidth,\n          height = image.naturalHeight,\n          ratio = 1,\n          maxWidth = self.maxImageWidth || width,\n          maxHeight = self.maxImageHeight || height,\n          isValidImage = width && height,\n          chkWidth,\n          chkHeight,\n          canvas = self.imageCanvas,\n          context = self.imageCanvasContext;\n\n      if (!isValidImage) {\n        return false;\n      }\n\n      if (width === maxWidth && height === maxHeight) {\n        return true;\n      }\n\n      type = type || self.resizeDefaultImageType;\n      chkWidth = width > maxWidth;\n      chkHeight = height > maxHeight;\n\n      if (self.resizePreference === 'width') {\n        ratio = chkWidth ? maxWidth / width : chkHeight ? maxHeight / height : 1;\n      } else {\n        ratio = chkHeight ? maxHeight / height : chkWidth ? maxWidth / width : 1;\n      }\n\n      self._resetCanvas();\n\n      width *= ratio;\n      height *= ratio;\n      canvas.width = width;\n      canvas.height = height;\n\n      try {\n        context.drawImage(image, 0, 0, width, height);\n        canvas.toBlob(function (blob) {\n          self._raise('fileimageresized', [pid, ind]);\n\n          self.filestack[ind] = blob;\n        }, type, self.resizeQuality);\n        return true;\n      } catch (err) {\n        return false;\n      }\n    },\n    _initBrowse: function _initBrowse($container) {\n      var self = this;\n\n      if (self.showBrowse) {\n        self.$btnFile = $container.find('.btn-file');\n        self.$btnFile.append(self.$element);\n      } else {\n        self.$element.hide();\n      }\n    },\n    _initCaption: function _initCaption() {\n      var self = this,\n          cap = self.initialCaption || '';\n\n      if (self.overwriteInitial || isEmpty(cap)) {\n        self.$caption.html('');\n        return false;\n      }\n\n      self._setCaption(cap);\n\n      return true;\n    },\n    _setCaption: function _setCaption(content, isError) {\n      var self = this,\n          title,\n          out,\n          n,\n          cap,\n          stack = self.getFileStack();\n\n      if (!self.$caption.length) {\n        return;\n      }\n\n      if (isError) {\n        title = $('<div>' + self.msgValidationError + '</div>').text();\n        n = stack.length;\n\n        if (n) {\n          cap = n === 1 && stack[0] ? self._getFileNames()[0] : self._getMsgSelected(n);\n        } else {\n          cap = self._getMsgSelected(self.msgNo);\n        }\n\n        out = '<span class=\"' + self.msgValidationErrorClass + '\">' + self.msgValidationErrorIcon + (isEmpty(content) ? cap : content) + '</span>';\n      } else {\n        if (isEmpty(content)) {\n          return;\n        }\n\n        title = $('<div>' + content + '</div>').text();\n        out = self._getLayoutTemplate('fileIcon') + title;\n      }\n\n      self.$caption.html(out);\n      self.$caption.attr('title', title);\n      self.$captionContainer.find('.file-caption-ellipsis').attr('title', title);\n    },\n    _createContainer: function _createContainer() {\n      var self = this,\n          $container = $(document.createElement(\"div\")).attr({\n        \"class\": 'file-input file-input-new'\n      }).html(self._renderMain());\n      self.$element.before($container);\n\n      self._initBrowse($container);\n\n      if (self.theme) {\n        $container.addClass('theme-' + self.theme);\n      }\n\n      return $container;\n    },\n    _refreshContainer: function _refreshContainer() {\n      var self = this,\n          $container = self.$container;\n      $container.before(self.$element);\n      $container.html(self._renderMain());\n\n      self._initBrowse($container);\n    },\n    _renderMain: function _renderMain() {\n      var self = this,\n          dropCss = self.isUploadable && self.dropZoneEnabled ? ' file-drop-zone' : 'file-drop-disabled',\n          close = !self.showClose ? '' : self._getLayoutTemplate('close'),\n          preview = !self.showPreview ? '' : self._getLayoutTemplate('preview').replace(/\\{class}/g, self.previewClass).replace(/\\{dropClass}/g, dropCss),\n          css = self.isDisabled ? self.captionClass + ' file-caption-disabled' : self.captionClass,\n          caption = self.captionTemplate.replace(/\\{class}/g, css + ' kv-fileinput-caption');\n      return self.mainTemplate.replace(/\\{class}/g, self.mainClass + (!self.showBrowse && self.showCaption ? ' no-browse' : '')).replace(/\\{preview}/g, preview).replace(/\\{close}/g, close).replace(/\\{caption}/g, caption).replace(/\\{upload}/g, self._renderButton('upload')).replace(/\\{remove}/g, self._renderButton('remove')).replace(/\\{cancel}/g, self._renderButton('cancel')).replace(/\\{browse}/g, self._renderButton('browse'));\n    },\n    _renderButton: function _renderButton(type) {\n      var self = this,\n          tmplt = self._getLayoutTemplate('btnDefault'),\n          css = self[type + 'Class'],\n          title = self[type + 'Title'],\n          icon = self[type + 'Icon'],\n          label = self[type + 'Label'],\n          status = self.isDisabled ? ' disabled' : '',\n          btnType = 'button';\n\n      switch (type) {\n        case 'remove':\n          if (!self.showRemove) {\n            return '';\n          }\n\n          break;\n\n        case 'cancel':\n          if (!self.showCancel) {\n            return '';\n          }\n\n          css += ' hide';\n          break;\n\n        case 'upload':\n          if (!self.showUpload) {\n            return '';\n          }\n\n          if (self.isUploadable && !self.isDisabled) {\n            tmplt = self._getLayoutTemplate('btnLink').replace('{href}', self.uploadUrl);\n          } else {\n            btnType = 'submit';\n          }\n\n          break;\n\n        case 'browse':\n          if (!self.showBrowse) {\n            return '';\n          }\n\n          tmplt = self._getLayoutTemplate('btnBrowse');\n          break;\n\n        default:\n          return '';\n      }\n\n      css += type === 'browse' ? ' btn-file' : ' fileinput-' + type + ' fileinput-' + type + '-button';\n\n      if (!isEmpty(label)) {\n        label = ' <span class=\"' + self.buttonLabelClass + '\">' + label + '</span>';\n      }\n\n      return tmplt.replace('{type}', btnType).replace('{css}', css).replace('{title}', title).replace('{status}', status).replace('{icon}', icon).replace('{label}', label);\n    },\n    _renderThumbProgress: function _renderThumbProgress() {\n      return '<div class=\"file-thumb-progress hide\">' + this.progressTemplate.replace(/\\{percent}/g, '0') + '</div>';\n    },\n    _renderFileFooter: function _renderFileFooter(caption, size, width, isError) {\n      var self = this,\n          config = self.fileActionSettings,\n          rem = config.showRemove,\n          drg = config.showDrag,\n          upl = config.showUpload,\n          zoom = config.showZoom,\n          out,\n          template = self._getLayoutTemplate('footer'),\n          indicator = isError ? config.indicatorError : config.indicatorNew,\n          title = isError ? config.indicatorErrorTitle : config.indicatorNewTitle;\n\n      size = self._getSize(size);\n\n      if (self.isUploadable) {\n        out = template.replace(/\\{actions}/g, self._renderFileActions(upl, rem, zoom, drg, false, false, false)).replace(/\\{caption}/g, caption).replace(/\\{size}/g, size).replace(/\\{width}/g, width).replace(/\\{progress}/g, self._renderThumbProgress()).replace(/\\{indicator}/g, indicator).replace(/\\{indicatorTitle}/g, title);\n      } else {\n        out = template.replace(/\\{actions}/g, self._renderFileActions(false, false, zoom, drg, false, false, false)).replace(/\\{caption}/g, caption).replace(/\\{size}/g, size).replace(/\\{width}/g, width).replace(/\\{progress}/g, '').replace(/\\{indicator}/g, indicator).replace(/\\{indicatorTitle}/g, title);\n      }\n\n      out = replaceTags(out, self.previewThumbTags);\n      return out;\n    },\n    _renderFileActions: function _renderFileActions(showUpload, showDelete, showZoom, showDrag, disabled, url, key, isInit) {\n      if (!showUpload && !showDelete && !showZoom && !showDrag) {\n        return '';\n      }\n\n      var self = this,\n          vUrl = url === false ? '' : ' data-url=\"' + url + '\"',\n          vKey = key === false ? '' : ' data-key=\"' + key + '\"',\n          btnDelete = '',\n          btnUpload = '',\n          btnZoom = '',\n          btnDrag = '',\n          css,\n          template = self._getLayoutTemplate('actions'),\n          config = self.fileActionSettings,\n          otherButtons = self.otherActionButtons.replace(/\\{dataKey}/g, vKey),\n          removeClass = disabled ? config.removeClass + ' disabled' : config.removeClass;\n\n      if (showDelete) {\n        btnDelete = self._getLayoutTemplate('actionDelete').replace(/\\{removeClass}/g, removeClass).replace(/\\{removeIcon}/g, config.removeIcon).replace(/\\{removeTitle}/g, config.removeTitle).replace(/\\{dataUrl}/g, vUrl).replace(/\\{dataKey}/g, vKey);\n      }\n\n      if (showUpload) {\n        btnUpload = self._getLayoutTemplate('actionUpload').replace(/\\{uploadClass}/g, config.uploadClass).replace(/\\{uploadIcon}/g, config.uploadIcon).replace(/\\{uploadTitle}/g, config.uploadTitle);\n      }\n\n      if (showZoom) {\n        btnZoom = self._getLayoutTemplate('actionZoom').replace(/\\{zoomClass}/g, config.zoomClass).replace(/\\{zoomIcon}/g, config.zoomIcon).replace(/\\{zoomTitle}/g, config.zoomTitle);\n      }\n\n      if (showDrag && isInit) {\n        css = 'drag-handle-init ' + config.dragClass;\n        btnDrag = self._getLayoutTemplate('actionDrag').replace(/\\{dragClass}/g, css).replace(/\\{dragTitle}/g, config.dragTitle).replace(/\\{dragIcon}/g, config.dragIcon);\n      }\n\n      return template.replace(/\\{delete}/g, btnDelete).replace(/\\{upload}/g, btnUpload).replace(/\\{zoom}/g, btnZoom).replace(/\\{drag}/g, btnDrag).replace(/\\{other}/g, otherButtons);\n    },\n    _browse: function _browse(e) {\n      var self = this;\n\n      self._raise('filebrowse');\n\n      if (e && e.isDefaultPrevented()) {\n        return;\n      }\n\n      if (self.isError && !self.isUploadable) {\n        self.clear();\n      }\n\n      self.$captionContainer.focus();\n    },\n    _change: function _change(e) {\n      var self = this,\n          $el = self.$element;\n\n      if (!self.isUploadable && isEmpty($el.val()) && self.fileInputCleared) {\n        // IE 11 fix\n        self.fileInputCleared = false;\n        return;\n      }\n\n      self.fileInputCleared = false;\n\n      var tfiles,\n          msg,\n          total,\n          isDragDrop = arguments.length > 1,\n          isAjaxUpload = self.isUploadable,\n          i = 0,\n          f,\n          n,\n          len,\n          files = isDragDrop ? e.originalEvent.dataTransfer.files : $el.get(0).files,\n          ctr = self.filestack.length,\n          isSingleUpload = isEmpty($el.attr('multiple')),\n          flagSingle = isSingleUpload && ctr > 0,\n          folders = 0,\n          throwError = function throwError(mesg, file, previewId, index) {\n        var p1 = $.extend(true, {}, self._getOutData({}, {}, files), {\n          id: previewId,\n          index: index\n        }),\n            p2 = {\n          id: previewId,\n          index: index,\n          file: file,\n          files: files\n        };\n        return self.isUploadable ? self._showUploadError(mesg, p1) : self._showError(mesg, p2);\n      };\n\n      self.reader = null;\n\n      self._resetUpload();\n\n      self._hideFileIcon();\n\n      if (self.isUploadable) {\n        self.$container.find('.file-drop-zone .' + self.dropZoneTitleClass).remove();\n      }\n\n      if (isDragDrop) {\n        tfiles = [];\n\n        while (files[i]) {\n          f = files[i];\n\n          if (!f.type && f.size % 4096 === 0) {\n            folders++;\n          } else {\n            tfiles.push(f);\n          }\n\n          i++;\n        }\n      } else {\n        if (e.target.files === undefined) {\n          tfiles = e.target && e.target.value ? [{\n            name: e.target.value.replace(/^.+\\\\/, '')\n          }] : [];\n        } else {\n          tfiles = e.target.files;\n        }\n      }\n\n      if (isEmpty(tfiles) || tfiles.length === 0) {\n        if (!isAjaxUpload) {\n          self.clear();\n        }\n\n        self._showFolderError(folders);\n\n        self._raise('fileselectnone');\n\n        return;\n      }\n\n      self._resetErrors();\n\n      len = tfiles.length;\n      total = self._getFileCount(self.isUploadable ? self.getFileStack().length + len : len);\n\n      if (self.maxFileCount > 0 && total > self.maxFileCount) {\n        if (!self.autoReplace || len > self.maxFileCount) {\n          n = self.autoReplace && len > self.maxFileCount ? len : total;\n          msg = self.msgFilesTooMany.replace('{m}', self.maxFileCount).replace('{n}', n);\n          self.isError = throwError(msg, null, null, null);\n          self.$captionContainer.find('.kv-caption-icon').hide();\n\n          self._setCaption('', true);\n\n          self.$container.removeClass('file-input-new file-input-ajax-new');\n          return;\n        }\n\n        if (total > self.maxFileCount) {\n          self._resetPreviewThumbs(isAjaxUpload);\n        }\n      } else {\n        if (!isAjaxUpload || flagSingle) {\n          self._resetPreviewThumbs(false);\n\n          if (flagSingle) {\n            self.clearStack();\n          }\n        } else {\n          if (isAjaxUpload && ctr === 0 && (!previewCache.count(self.id) || self.overwriteInitial)) {\n            self._resetPreviewThumbs(true);\n          }\n        }\n      }\n\n      if (self.isPreviewable) {\n        self._readFiles(tfiles);\n      } else {\n        self._updateFileDetails(1);\n      }\n\n      self._showFolderError(folders);\n    },\n    _abort: function _abort(params) {\n      var self = this,\n          data;\n\n      if (self.ajaxAborted && typeof self.ajaxAborted === \"object\" && self.ajaxAborted.message !== undefined) {\n        data = $.extend(true, {}, self._getOutData(), params);\n        data.abortData = self.ajaxAborted.data || {};\n        data.abortMessage = self.ajaxAborted.message;\n        self.cancel();\n\n        self._setProgress(101, self.$progress, self.msgCancelled);\n\n        self._showUploadError(self.ajaxAborted.message, data, 'filecustomerror');\n\n        return true;\n      }\n\n      return false;\n    },\n    _resetFileStack: function _resetFileStack() {\n      var self = this,\n          i = 0,\n          newstack = [],\n          newnames = [];\n\n      self._getThumbs().each(function () {\n        var $thumb = $(this),\n            ind = $thumb.attr('data-fileindex'),\n            file = self.filestack[ind];\n\n        if (ind === -1) {\n          return;\n        }\n\n        if (file !== undefined) {\n          newstack[i] = file;\n          newnames[i] = self._getFileName(file);\n          $thumb.attr({\n            'id': self.previewInitId + '-' + i,\n            'data-fileindex': i\n          });\n          i++;\n        } else {\n          $thumb.attr({\n            'id': 'uploaded-' + uniqId(),\n            'data-fileindex': '-1'\n          });\n        }\n      });\n\n      self.filestack = newstack;\n      self.filenames = newnames;\n    },\n    clearStack: function clearStack() {\n      var self = this;\n      self.filestack = [];\n      self.filenames = [];\n      return self.$element;\n    },\n    updateStack: function updateStack(i, file) {\n      var self = this;\n      self.filestack[i] = file;\n      self.filenames[i] = self._getFileName(file);\n      return self.$element;\n    },\n    addToStack: function addToStack(file) {\n      var self = this;\n      self.filestack.push(file);\n      self.filenames.push(self._getFileName(file));\n      return self.$element;\n    },\n    getFileStack: function getFileStack(skipNull) {\n      var self = this;\n      return self.filestack.filter(function (n) {\n        return skipNull ? n !== undefined : n !== undefined && n !== null;\n      });\n    },\n    getFilesCount: function getFilesCount() {\n      var self = this,\n          len = self.isUploadable ? self.getFileStack().length : self.$element.get(0).files.length;\n      return self._getFileCount(len);\n    },\n    lock: function lock() {\n      var self = this;\n\n      self._resetErrors();\n\n      self.disable();\n\n      if (self.showRemove) {\n        addCss(self.$container.find('.fileinput-remove'), 'hide');\n      }\n\n      if (self.showCancel) {\n        self.$container.find('.fileinput-cancel').removeClass('hide');\n      }\n\n      self._raise('filelock', [self.filestack, self._getExtraData()]);\n\n      return self.$element;\n    },\n    unlock: function unlock(reset) {\n      var self = this;\n\n      if (reset === undefined) {\n        reset = true;\n      }\n\n      self.enable();\n\n      if (self.showCancel) {\n        addCss(self.$container.find('.fileinput-cancel'), 'hide');\n      }\n\n      if (self.showRemove) {\n        self.$container.find('.fileinput-remove').removeClass('hide');\n      }\n\n      if (reset) {\n        self._resetFileStack();\n      }\n\n      self._raise('fileunlock', [self.filestack, self._getExtraData()]);\n\n      return self.$element;\n    },\n    cancel: function cancel() {\n      var self = this,\n          xhr = self.ajaxRequests,\n          len = xhr.length,\n          i;\n\n      if (len > 0) {\n        for (i = 0; i < len; i += 1) {\n          self.cancelling = true;\n          xhr[i].abort();\n        }\n      }\n\n      self._setProgressCancelled();\n\n      self._getThumbs().each(function () {\n        var $thumb = $(this),\n            ind = $thumb.attr('data-fileindex');\n        $thumb.removeClass('file-uploading');\n\n        if (self.filestack[ind] !== undefined) {\n          $thumb.find('.kv-file-upload').removeClass('disabled').removeAttr('disabled');\n          $thumb.find('.kv-file-remove').removeClass('disabled').removeAttr('disabled');\n        }\n\n        self.unlock();\n      });\n\n      return self.$element;\n    },\n    clear: function clear() {\n      var self = this,\n          cap;\n      self.$btnUpload.removeAttr('disabled');\n\n      self._getThumbs().find('video,audio,img').each(function () {\n        cleanMemory($(this));\n      });\n\n      self._resetUpload();\n\n      self.clearStack();\n\n      self._clearFileInput();\n\n      self._resetErrors(true);\n\n      self._raise('fileclear');\n\n      if (self._hasInitialPreview()) {\n        self._showFileIcon();\n\n        self._resetPreview();\n\n        self._initPreviewActions();\n\n        self.$container.removeClass('file-input-new');\n      } else {\n        self._getThumbs().each(function () {\n          self._clearObjects($(this));\n        });\n\n        if (self.isUploadable) {\n          previewCache.data[self.id] = {};\n        }\n\n        self.$preview.html('');\n        cap = !self.overwriteInitial && self.initialCaption.length > 0 ? self.initialCaption : '';\n        self.$caption.html(cap);\n        self.$caption.attr('title', '');\n        addCss(self.$container, 'file-input-new');\n\n        self._validateDefaultPreview();\n      }\n\n      if (self.$container.find('.file-preview-frame').length === 0) {\n        if (!self._initCaption()) {\n          self.$captionContainer.find('.kv-caption-icon').hide();\n        }\n      }\n\n      self._hideFileIcon();\n\n      self._raise('filecleared');\n\n      self.$captionContainer.focus();\n\n      self._setFileDropZoneTitle();\n\n      return self.$element;\n    },\n    reset: function reset() {\n      var self = this;\n\n      self._resetPreview();\n\n      self.$container.find('.fileinput-filename').text('');\n\n      self._raise('filereset');\n\n      addCss(self.$container, 'file-input-new');\n\n      if (self.$preview.find('.file-preview-frame').length || self.isUploadable && self.dropZoneEnabled) {\n        self.$container.removeClass('file-input-new');\n      }\n\n      self._setFileDropZoneTitle();\n\n      self.clearStack();\n      self.formdata = {};\n      return self.$element;\n    },\n    disable: function disable() {\n      var self = this;\n      self.isDisabled = true;\n\n      self._raise('filedisabled');\n\n      self.$element.attr('disabled', 'disabled');\n      self.$container.find(\".kv-fileinput-caption\").addClass(\"file-caption-disabled\");\n      self.$container.find(\".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button\").attr(\"disabled\", true);\n\n      self._initDragDrop();\n\n      return self.$element;\n    },\n    enable: function enable() {\n      var self = this;\n      self.isDisabled = false;\n\n      self._raise('fileenabled');\n\n      self.$element.removeAttr('disabled');\n      self.$container.find(\".kv-fileinput-caption\").removeClass(\"file-caption-disabled\");\n      self.$container.find(\".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button\").removeAttr(\"disabled\");\n\n      self._initDragDrop();\n\n      return self.$element;\n    },\n    upload: function upload() {\n      var self = this,\n          totLen = self.getFileStack().length,\n          params = {},\n          i,\n          outData,\n          len,\n          hasExtraData = !$.isEmptyObject(self._getExtraData());\n\n      if (self.minFileCount > 0 && self._getFileCount(totLen) < self.minFileCount) {\n        self._noFilesError(params);\n\n        return;\n      }\n\n      if (!self.isUploadable || self.isDisabled || totLen === 0 && !hasExtraData) {\n        return;\n      }\n\n      self._resetUpload();\n\n      self.$progress.removeClass('hide');\n      self.uploadCount = 0;\n      self.uploadStatus = {};\n      self.uploadLog = [];\n      self.lock();\n\n      self._setProgress(2);\n\n      if (totLen === 0 && hasExtraData) {\n        self._uploadExtraOnly();\n\n        return;\n      }\n\n      len = self.filestack.length;\n      self.hasInitData = false;\n\n      if (self.uploadAsync) {\n        outData = self._getOutData();\n\n        self._raise('filebatchpreupload', [outData]);\n\n        self.fileBatchCompleted = false;\n        self.uploadCache = {\n          content: [],\n          config: [],\n          tags: [],\n          append: true\n        };\n        self.uploadAsyncCount = self.getFileStack().length;\n\n        for (i = 0; i < len; i++) {\n          self.uploadCache.content[i] = null;\n          self.uploadCache.config[i] = null;\n          self.uploadCache.tags[i] = null;\n        }\n\n        for (i = 0; i < len; i++) {\n          if (self.filestack[i] !== undefined) {\n            self._uploadSingle(i, self.filestack, true);\n          }\n        }\n\n        return;\n      }\n\n      self._uploadBatch();\n\n      return self.$element;\n    },\n    destroy: function destroy() {\n      var self = this,\n          $cont = self.$container;\n      $cont.find('.file-drop-zone').off();\n      self.$element.insertBefore($cont).off(NAMESPACE).removeData();\n      $cont.off().remove();\n      return self.$element;\n    },\n    refresh: function refresh(options) {\n      var self = this,\n          $el = self.$element;\n      options = options ? $.extend(true, {}, self.options, options) : self.options;\n      self.destroy();\n      $el.fileinput(options);\n\n      if ($el.val()) {\n        $el.trigger('change.fileinput');\n      }\n\n      return $el;\n    }\n  };\n\n  $.fn.fileinput = function (option) {\n    if (!hasFileAPISupport() && !isIE(9)) {\n      return;\n    }\n\n    var args = Array.apply(null, arguments),\n        retvals = [];\n    args.shift();\n    this.each(function () {\n      var self = $(this),\n          data = self.data('fileinput'),\n          options = typeof option === 'object' && option,\n          theme = options.theme || self.data('theme'),\n          l = {},\n          t = {},\n          lang = options.language || self.data('language') || 'en',\n          opts;\n\n      if (!data) {\n        if (theme) {\n          t = $.fn.fileinputThemes[theme] || {};\n        }\n\n        if (lang !== 'en' && !isEmpty($.fn.fileinputLocales[lang])) {\n          l = $.fn.fileinputLocales[lang] || {};\n        }\n\n        opts = $.extend(true, {}, $.fn.fileinput.defaults, t, $.fn.fileinputLocales.en, l, options, self.data());\n        data = new FileInput(this, opts);\n        self.data('fileinput', data);\n      }\n\n      if (typeof option === 'string') {\n        retvals.push(data[option].apply(data, args));\n      }\n    });\n\n    switch (retvals.length) {\n      case 0:\n        return this;\n\n      case 1:\n        return retvals[0];\n\n      default:\n        return retvals;\n    }\n  };\n\n  $.fn.fileinput.defaults = {\n    language: 'en',\n    showCaption: true,\n    showBrowse: true,\n    showPreview: true,\n    showRemove: true,\n    showUpload: true,\n    showCancel: true,\n    showClose: true,\n    showUploadedThumbs: true,\n    browseOnZoneClick: false,\n    autoReplace: false,\n    previewClass: '',\n    captionClass: '',\n    mainClass: 'file-caption-main',\n    mainTemplate: null,\n    purifyHtml: true,\n    fileSizeGetter: null,\n    initialCaption: '',\n    initialPreview: [],\n    initialPreviewDelimiter: '*$$*',\n    initialPreviewAsData: false,\n    initialPreviewFileType: 'image',\n    initialPreviewConfig: [],\n    initialPreviewThumbTags: [],\n    previewThumbTags: {},\n    initialPreviewShowDelete: true,\n    removeFromPreviewOnError: false,\n    deleteUrl: '',\n    deleteExtraData: {},\n    overwriteInitial: true,\n    layoutTemplates: defaultLayoutTemplates,\n    previewTemplates: defaultPreviewTemplates,\n    previewZoomSettings: defaultPreviewZoomSettings,\n    previewZoomButtonIcons: {\n      prev: '<i class=\"glyphicon glyphicon-triangle-left\"></i>',\n      next: '<i class=\"glyphicon glyphicon-triangle-right\"></i>',\n      toggleheader: '<i class=\"glyphicon glyphicon-resize-vertical\"></i>',\n      fullscreen: '<i class=\"glyphicon glyphicon-fullscreen\"></i>',\n      borderless: '<i class=\"glyphicon glyphicon-resize-full\"></i>',\n      close: '<i class=\"glyphicon glyphicon-remove\"></i>'\n    },\n    previewZoomButtonClasses: {\n      prev: 'btn btn-navigate',\n      next: 'btn btn-navigate',\n      toggleheader: 'btn btn-default btn-header-toggle',\n      fullscreen: 'btn btn-default',\n      borderless: 'btn btn-default',\n      close: 'btn btn-default'\n    },\n    allowedPreviewTypes: defaultPreviewTypes,\n    allowedPreviewMimeTypes: null,\n    allowedFileTypes: null,\n    allowedFileExtensions: null,\n    defaultPreviewContent: null,\n    customLayoutTags: {},\n    customPreviewTags: {},\n    previewSettings: defaultPreviewSettings,\n    fileTypeSettings: defaultFileTypeSettings,\n    previewFileIcon: '<i class=\"glyphicon glyphicon-file\"></i>',\n    previewFileIconClass: 'file-other-icon',\n    previewFileIconSettings: {},\n    previewFileExtSettings: {},\n    buttonLabelClass: 'hidden-xs',\n    browseIcon: '<i class=\"glyphicon glyphicon-folder-open\"></i>&nbsp;',\n    browseClass: 'btn btn-primary',\n    removeIcon: '<i class=\"glyphicon glyphicon-trash\"></i>',\n    removeClass: 'btn btn-default',\n    cancelIcon: '<i class=\"glyphicon glyphicon-ban-circle\"></i>',\n    cancelClass: 'btn btn-default',\n    uploadIcon: '<i class=\"glyphicon glyphicon-upload\"></i>',\n    uploadClass: 'btn btn-default',\n    uploadUrl: null,\n    uploadAsync: true,\n    uploadExtraData: {},\n    zoomModalHeight: 480,\n    minImageWidth: null,\n    minImageHeight: null,\n    maxImageWidth: null,\n    maxImageHeight: null,\n    resizeImage: false,\n    resizePreference: 'width',\n    resizeQuality: 0.92,\n    resizeDefaultImageType: 'image/jpeg',\n    maxFileSize: 0,\n    maxFilePreviewSize: 25600,\n    // 25 MB\n    minFileCount: 0,\n    maxFileCount: 0,\n    validateInitialCount: false,\n    msgValidationErrorClass: 'text-danger',\n    msgValidationErrorIcon: '<i class=\"glyphicon glyphicon-exclamation-sign\"></i> ',\n    msgErrorClass: 'file-error-message',\n    progressThumbClass: \"progress-bar progress-bar-success progress-bar-striped active\",\n    progressClass: \"progress-bar progress-bar-success progress-bar-striped active\",\n    progressCompleteClass: \"progress-bar progress-bar-success\",\n    progressErrorClass: \"progress-bar progress-bar-danger\",\n    progressUploadThreshold: 99,\n    previewFileType: 'image',\n    elCaptionContainer: null,\n    elCaptionText: null,\n    elPreviewContainer: null,\n    elPreviewImage: null,\n    elPreviewStatus: null,\n    elErrorContainer: null,\n    errorCloseButton: '<span class=\"close kv-error-close\">&times;</span>',\n    slugCallback: null,\n    dropZoneEnabled: true,\n    dropZoneTitleClass: 'file-drop-zone-title',\n    fileActionSettings: {},\n    otherActionButtons: '',\n    textEncoding: 'UTF-8',\n    ajaxSettings: {},\n    ajaxDeleteSettings: {},\n    showAjaxErrorDetails: true\n  };\n  $.fn.fileinputLocales.en = {\n    fileSingle: 'file',\n    filePlural: 'files',\n    browseLabel: 'Browse &hellip;',\n    removeLabel: 'Remove',\n    removeTitle: 'Clear selected files',\n    cancelLabel: 'Cancel',\n    cancelTitle: 'Abort ongoing upload',\n    uploadLabel: 'Upload',\n    uploadTitle: 'Upload selected files',\n    msgNo: 'No',\n    msgNoFilesSelected: 'No files selected',\n    msgCancelled: 'Cancelled',\n    msgZoomModalHeading: 'Detailed Preview',\n    msgSizeTooLarge: 'File \"{name}\" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',\n    msgFilesTooLess: 'You must select at least <b>{n}</b> {files} to upload.',\n    msgFilesTooMany: 'Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.',\n    msgFileNotFound: 'File \"{name}\" not found!',\n    msgFileSecured: 'Security restrictions prevent reading the file \"{name}\".',\n    msgFileNotReadable: 'File \"{name}\" is not readable.',\n    msgFilePreviewAborted: 'File preview aborted for \"{name}\".',\n    msgFilePreviewError: 'An error occurred while reading the file \"{name}\".',\n    msgInvalidFileType: 'Invalid type for file \"{name}\". Only \"{types}\" files are supported.',\n    msgInvalidFileExtension: 'Invalid extension for file \"{name}\". Only \"{extensions}\" files are supported.',\n    msgUploadAborted: 'The file upload was aborted',\n    msgUploadThreshold: 'Processing...',\n    msgValidationError: 'Validation Error',\n    msgLoading: 'Loading file {index} of {files} &hellip;',\n    msgProgress: 'Loading file {index} of {files} - {name} - {percent}% completed.',\n    msgSelected: '{n} {files} selected',\n    msgFoldersNotAllowed: 'Drag & drop files only! {n} folder(s) dropped were skipped.',\n    msgImageWidthSmall: 'Width of image file \"{name}\" must be at least {size} px.',\n    msgImageHeightSmall: 'Height of image file \"{name}\" must be at least {size} px.',\n    msgImageWidthLarge: 'Width of image file \"{name}\" cannot exceed {size} px.',\n    msgImageHeightLarge: 'Height of image file \"{name}\" cannot exceed {size} px.',\n    msgImageResizeError: 'Could not get the image dimensions to resize.',\n    msgImageResizeException: 'Error while resizing the image.<pre>{errors}</pre>',\n    dropZoneTitle: 'Drag & drop files here &hellip;',\n    dropZoneClickTitle: '<br>(or click to select {files})',\n    previewZoomButtonTitles: {\n      prev: 'View previous file',\n      next: 'View next file',\n      toggleheader: 'Toggle header',\n      fullscreen: 'Toggle full screen',\n      borderless: 'Toggle borderless mode',\n      close: 'Close detailed preview'\n    }\n  };\n  $.fn.fileinput.Constructor = FileInput;\n  /**\n   * Convert automatically file inputs with class 'file' into a bootstrap fileinput control.\n   */\n\n  $(document).ready(function () {\n    var $input = $('input.file[type=file]');\n\n    if ($input.length) {\n      $input.fileinput();\n    }\n  });\n});","map":{"version":3,"sources":["/Users/david/Winner-Stock/app/javascript/packs/fileinput.js"],"names":["factory","define","amd","module","exports","require","window","jQuery","$","fn","fileinputLocales","fileinputThemes","NAMESPACE","MODAL_ID","STYLE_SETTING","OBJECT_PARAMS","DEFAULT_PREVIEW","objUrl","compare","isIE","handler","previewCache","getNum","hasFileAPISupport","hasDragDropSupport","hasFileUploadSupport","addCss","tMain1","tMain2","tPreview","tFileIcon","tClose","tCaption","tBtnDefault","tBtnLink","tBtnBrowse","tModalMain","tModal","tProgress","tSize","tFooter","tActions","tActionDelete","tActionUpload","tActionZoom","tActionDrag","tTagBef","tTagBef1","tTagBef2","tTagAft","tGeneric","tHtml","tImage","tText","tVideo","tAudio","tFlash","tObject","tPdf","tOther","defaultFileActionSettings","defaultLayoutTemplates","defaultPreviewTemplates","defaultPreviewZoomSettings","defaultPreviewTypes","getElement","defaultPreviewSettings","defaultFileTypeSettings","isEmpty","isArray","ifSet","uniqId","htmlEncode","replaceTags","cleanMemory","findFileName","checkFullScreen","toggleFullScreen","moveArray","FileInput","URL","webkitURL","input","str","exact","undefined","match","ver","navigator","appName","RegExp","test","userAgent","div","document","createElement","status","innerHTML","getElementsByTagName","length","body","appendChild","parentNode","removeChild","$el","event","callback","skipNS","ev","split","join","off","on","data","init","obj","content","initialPreview","id","initialPreviewDelimiter","config","initialPreviewConfig","tags","initialPreviewThumbTags","delimiter","previewFileType","initialPreviewFileType","previewAsData","initialPreviewAsData","template","previewGenericTemplate","showZoom","fileActionSettings","showDrag","getSize","size","_getSize","parseTemplate","cat","fname","ftype","pId","ftr","ind","fc","_generatePreviewTemplate","msg","n","_getMsgSelected","initId","previewInitId","footer","_getLayoutTemplate","replace","_renderThumbProgress","isDelete","initialPreviewShowDelete","caption","initialCaption","actions","showUpload","showDelete","disabled","url","key","_renderFileActions","fetch","filter","count","all","get","i","isDisabled","previewId","out","$tmp","frameClass","cap","asData","frameAttr","html","find","attr","remove","add","append","extend","index","push","set","chk","unset","len","width","showDel","num","def","parseFloat","isNaN","File","FileReader","draggable","ondragstart","ondrop","FormData","css","removeClass","addClass","showRemove","removeIcon","removeTitle","uploadIcon","uploadClass","uploadTitle","zoomIcon","zoomClass","zoomTitle","dragIcon","dragClass","dragTitle","dragSettings","indicatorNew","indicatorSuccess","indicatorError","indicatorLoading","indicatorNewTitle","indicatorSuccessTitle","indicatorErrorTitle","indicatorLoadingTitle","main1","main2","preview","close","fileIcon","modalMain","modal","progress","actionDelete","actionUpload","actionZoom","actionDrag","btnDefault","btnLink","btnBrowse","generic","image","text","video","audio","flash","object","pdf","other","height","vType","vName","value","trim","a","Array","Object","prototype","toString","call","needle","haystack","options","param","Math","round","Date","getTime","random","each","$thumb","is","revokeObjectURL","filePath","sepIndex","lastIndexOf","substring","pop","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement","maximize","documentElement","requestFullscreen","msRequestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","Element","ALLOW_KEYBOARD_INPUT","exitFullscreen","msExitFullscreen","mozCancelFullScreen","webkitExitFullscreen","arr","oldIndex","newIndex","k","splice","element","self","$element","_validate","isPreviewable","isIE9","isIE10","_init","_listen","constructor","t","fileInputCleared","fileBatchCompleted","showPreview","uploadFileAttr","reader","formdata","clearStack","uploadCount","uploadStatus","uploadLog","uploadAsyncCount","loadedImages","totalImagesCount","ajaxRequests","isError","ajaxAborted","cancelling","progressTemplate","progressClass","progressCompleteTemplate","progressCompleteClass","progressErrorTemplate","progressErrorClass","dropZoneEnabled","isUploadable","uploadUrl","isClickable","browseOnZoneClick","defaultPreviewContent","slug","slugCallback","_slugDefault","mainTemplate","showCaption","captionTemplate","_getPreviewTemplate","resizeImage","maxImageWidth","maxImageHeight","imageCanvas","imageCanvasContext","getContext","$container","_createContainer","_refreshContainer","$dropZone","$progress","$btnUpload","$captionContainer","$caption","$previewContainer","$preview","$previewStatus","$errorContainer","msgErrorClass","hide","_initPreview","_initPreviewActions","_setFileDropZoneTitle","disable","_initZoom","$exception","after","_errorsExist","$err","_errorHandler","evt","err","target","error","code","NOT_FOUND_ERR","_showError","msgFileNotFound","SECURITY_ERR","msgFileSecured","NOT_READABLE_ERR","msgFileNotReadable","ABORT_ERR","msgFilePreviewAborted","msgFilePreviewError","_addError","$error","errorCloseButton","fadeOut","_resetErrors","fade","_showFolderError","folders","msgFoldersNotAllowed","fadeIn","_raise","_showUploadError","params","e","_clearFileInput","_noFilesError","label","minFileCount","filePlural","fileSingle","msgFilesTooLess","_updateFileDetails","_parseError","jqXHR","errorThrown","fileName","errMsg","dot","slice","responseJSON","responseText","msgUploadAborted","showAjaxErrorDetails","_parseFileType","file","isValid","fileTypeSettings","type","name","_parseFilePreviewIcon","proceed","ext","icn","previewFileIcon","indexOf","previewFileIconSettings","previewFileExtSettings","func","previewFileIconClass","Event","trigger","isDefaultPrevented","result","_listenFullScreen","isFullScreen","$modal","$btnFull","$btnBord","hasClass","_maximizeZoomDialog","$form","closest","$cont","proxy","_change","showBrowse","$btnFile","_browse","reset","clear","cancel","_initDragDrop","_submitForm","_uploadClick","screen","innerWidth","innerHeight","_initClickable","$zone","$target","parents","blur","_zoneDragEnter","_zoneDragLeave","_zoneDrop","_zoneDragDropInit","stopPropagation","preventDefault","hasFiles","inArray","originalEvent","dataTransfer","types","effectAllowed","dropEffect","files","$btn","isEnabled","upload","_getFileCount","_abort","_clearPreview","$thumbs","showUploadedThumbs","_resetUpload","_validateDefaultPreview","_initSortable","settings","KvSortable","handle","dataIdAttr","onSort","item","stack","kvsortable","isInit","_setCaption","_initCaption","_getZoomButton","previewZoomButtonIcons","previewZoomButtonClasses","title","previewZoomButtonTitles","_getModalContent","msgZoomModalHeading","_listenModalEvent","getParams","sourceEvent","$dialog","modalId","insertAfter","insertBefore","_initZoomButtons","$first","$last","frames","toArray","$prev","$next","removeAttr","$head","$foot","$body","h","diff","outerHeight","_resizeZoomDialog","fullScreen","zoomModalHeight","focus","_setZoomContent","animate","$content","tmplt","$dataEl","$btnTogh","clone","previewZoomSettings","_zoomSlideShow","$header","$floatBar","ht","$actions","resize","slideUp","appendTo","slideDown","which","keyCode","_zoomPreview","dir","$targFrame","_initZoomButton","deleteExtraData","resetProgress","vUrl","deleteUrl","vKey","$frame","cache","extraData","parseInt","extra","dataType","beforeSend","abort","success","textStatus","response","_clearObjects","getFileStack","ajaxDeleteSettings","_validateMinCount","ajax","pause","$srcFrm","$tmpFrm","$tmpEl","val","before","uploadCache","_setProgress","_resetCanvas","canvas","clearRect","_hasInitialPreview","overwriteInitial","_resetPreview","_clearDefaultPreview","_resetPreviewThumbs","isAjax","layoutTemplates","customLayoutTags","previewTemplates","customPreviewTags","_getOutData","responseData","filesData","filestack","form","filenames","filescount","getFilesCount","_getExtraData","strFiles","msgSelected","msgNoFilesSelected","_getThumbs","uploadExtraData","_initXhr","xhrobj","fileCount","addEventListener","pct","total","position","loaded","lengthComputable","floor","_setAsyncUploadStatus","_ajaxSubmit","fnBefore","fnSuccess","fnComplete","fnError","_uploadExtra","xhr","ajaxSettings","processData","contentType","complete","_initUploadSuccess","allFiles","$newThumb","mergeArray","prop","concat","isEmptyObject","hasInitData","_initSuccessThumbs","$remove","_checkAsyncComplete","_uploadSingle","outData","chkComplete","$btnDelete","hasPostData","updateUploadLog","updateStack","u","setTimeout","unlock","_setThumbStatus","lock","_setProgressCancelled","pid","_setPreviewError","_uploadBatch","setAllUploaded","keys","errorkeys","uploadFileCount","_uploadExtraOnly","_initFileActions","hasError","hasThumb","_getFileNames","_hideFileIcon","_showFileIcon","show","bytes","fileSizeGetter","sizes","log","pow","toFixed","foot","sText","previewSettings","_renderFileFooter","_previewDefault","$previewLive","createObjectURL","_previewFile","theFile","allowedPreviewTypes","mimes","allowedPreviewMimeTypes","chkTypes","iData","chkMimes","purifyHtml","DOMPurify","sanitize","_validateImage","String","_readFiles","$status","msgLoading","msgProgress","numFiles","ctr","readFile","maxPreviewSize","maxFilePreviewSize","canPreview","throwError","p1","p2","addToStack","removeFromPreviewOnError","node","isText","isImage","fileSize","checkFile","fileExtExpr","previewData","j","typ","fileTypes","allowedFileTypes","strTypes","fileExt","allowedFileExtensions","strExt","maxFileSize","msgSizeTooLarge","msgInvalidFileType","msgInvalidFileExtension","onerror","onload","onloadend","onprogress","fact","ceil","readAsText","textEncoding","readAsDataURL","readAsArrayBuffer","fileStack","nFiles","arguments","icon","toLowerCase","$indicator","msgCancelled","p","min","pctLimit","progressUploadThreshold","msgUploadThreshold","dropZoneTitle","dropZoneClickTitle","dropZoneTitleClass","prepend","sum","validateInitialCount","addCount","_getFileName","skipNull","_checkDimensions","$img","dim","tag","limit","$imgEl","naturalWidth","naturalHeight","w1","w2","img","thumb","_validateAllImages","errFunc","_getResizedImage","msgImageResizeError","ratio","maxWidth","maxHeight","isValidImage","chkWidth","chkHeight","context","resizeDefaultImageType","resizePreference","drawImage","toBlob","blob","resizeQuality","_initBrowse","msgValidationError","msgNo","msgValidationErrorClass","msgValidationErrorIcon","_renderMain","theme","dropCss","showClose","previewClass","captionClass","mainClass","_renderButton","btnType","showCancel","buttonLabelClass","rem","drg","upl","zoom","indicator","previewThumbTags","btnDelete","btnUpload","btnZoom","btnDrag","otherButtons","otherActionButtons","tfiles","isDragDrop","isAjaxUpload","f","isSingleUpload","flagSingle","mesg","maxFileCount","autoReplace","msgFilesTooMany","message","abortData","abortMessage","_resetFileStack","newstack","newnames","enable","totLen","hasExtraData","uploadAsync","destroy","removeData","refresh","fileinput","option","args","apply","retvals","shift","l","lang","language","opts","defaults","en","prev","next","toggleheader","fullscreen","borderless","browseIcon","browseClass","cancelIcon","cancelClass","minImageWidth","minImageHeight","progressThumbClass","elCaptionContainer","elCaptionText","elPreviewContainer","elPreviewImage","elPreviewStatus","elErrorContainer","browseLabel","removeLabel","cancelLabel","cancelTitle","uploadLabel","msgImageWidthSmall","msgImageHeightSmall","msgImageWidthLarge","msgImageHeightLarge","msgImageResizeException","Constructor","ready","$input"],"mappings":"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","sourcesContent":["/*!\n * bootstrap-fileinput v4.3.5\n * http://plugins.krajee.com/file-input\n *\n * Author: Kartik Visweswaran\n * Copyright: 2014 - 2016, Kartik Visweswaran, Krajee.com\n *\n * Licensed under the BSD 3-Clause\n * https://github.com/kartik-v/bootstrap-fileinput/blob/master/LICENSE.md\n */\n(function (factory) {\n    \"use strict\";\n    //noinspection JSUnresolvedVariable\n    if (typeof define === 'function' && define.amd) { // jshint ignore:line\n        // AMD. Register as an anonymous module.\n        define(['jquery'], factory); // jshint ignore:line\n    } else { // noinspection JSUnresolvedVariable\n        if (typeof module === 'object' && module.exports) { // jshint ignore:line\n            // Node/CommonJS\n            // noinspection JSUnresolvedVariable\n            module.exports = factory(require('jquery')); // jshint ignore:line\n        } else {\n            // Browser globals\n            factory(window.jQuery);\n        }\n    }\n}(function ($) {\n    \"use strict\";\n\n    $.fn.fileinputLocales = {};\n    $.fn.fileinputThemes = {};\n\n    var NAMESPACE, MODAL_ID, STYLE_SETTING, OBJECT_PARAMS, DEFAULT_PREVIEW, objUrl, compare, isIE, handler,\n        previewCache, getNum, hasFileAPISupport, hasDragDropSupport, hasFileUploadSupport, addCss, tMain1, tMain2,\n        tPreview, tFileIcon, tClose, tCaption, tBtnDefault, tBtnLink, tBtnBrowse, tModalMain, tModal, tProgress, tSize,\n        tFooter, tActions, tActionDelete, tActionUpload, tActionZoom, tActionDrag, tTagBef, tTagBef1, tTagBef2, tTagAft,\n        tGeneric, tHtml, tImage, tText, tVideo, tAudio, tFlash, tObject, tPdf, tOther, defaultFileActionSettings,\n        defaultLayoutTemplates, defaultPreviewTemplates, defaultPreviewZoomSettings, defaultPreviewTypes, getElement,\n        defaultPreviewSettings, defaultFileTypeSettings, isEmpty, isArray, ifSet, uniqId, htmlEncode, replaceTags,\n        cleanMemory, findFileName, checkFullScreen, toggleFullScreen, moveArray, FileInput;\n\n    NAMESPACE = '.fileinput';\n    MODAL_ID = 'kvFileinputModal';\n    STYLE_SETTING = 'style=\"width:{width};height:{height};\"';\n    OBJECT_PARAMS = '<param name=\"controller\" value=\"true\" />\\n' +\n        '<param name=\"allowFullScreen\" value=\"true\" />\\n' +\n        '<param name=\"allowScriptAccess\" value=\"always\" />\\n' +\n        '<param name=\"autoPlay\" value=\"false\" />\\n' +\n        '<param name=\"autoStart\" value=\"false\" />\\n' +\n        '<param name=\"quality\" value=\"high\" />\\n';\n    DEFAULT_PREVIEW = '<div class=\"file-preview-other\">\\n' +\n        '<span class=\"{previewFileIconClass}\">{previewFileIcon}</span>\\n' +\n        '</div>';\n    //noinspection JSUnresolvedVariable\n    objUrl = window.URL || window.webkitURL;\n    compare = function (input, str, exact) {\n        return input !== undefined && (exact ? input === str : input.match(str));\n    };\n    isIE = function (ver) {\n        // check for IE versions < 11\n        if (navigator.appName !== 'Microsoft Internet Explorer') {\n            return false;\n        }\n        if (ver === 10) {\n            return new RegExp('msie\\\\s' + ver, 'i').test(navigator.userAgent);\n        }\n        var div = document.createElement(\"div\"), status;\n        div.innerHTML = \"<!--[if IE \" + ver + \"]> <i></i> <![endif]-->\";\n        status = div.getElementsByTagName(\"i\").length;\n        document.body.appendChild(div);\n        div.parentNode.removeChild(div);\n        return status;\n    };\n    handler = function ($el, event, callback, skipNS) {\n        var ev = skipNS ? event : event.split(' ').join(NAMESPACE + ' ') + NAMESPACE;\n        $el.off(ev).on(ev, callback);\n    };\n    previewCache = {\n        data: {},\n        init: function (obj) {\n            var content = obj.initialPreview, id = obj.id;\n            if (content.length > 0 && !isArray(content)) {\n                content = content.split(obj.initialPreviewDelimiter);\n            }\n            previewCache.data[id] = {\n                content: content,\n                config: obj.initialPreviewConfig,\n                tags: obj.initialPreviewThumbTags,\n                delimiter: obj.initialPreviewDelimiter,\n                previewFileType: obj.initialPreviewFileType,\n                previewAsData: obj.initialPreviewAsData,\n                template: obj.previewGenericTemplate,\n                showZoom: obj.fileActionSettings.showZoom,\n                showDrag: obj.fileActionSettings.showDrag,\n                getSize: function (size) {\n                    return obj._getSize(size);\n                },\n                parseTemplate: function (cat, data, fname, ftype, pId, ftr, ind) {\n                    var fc = ' file-preview-initial';\n                    return obj._generatePreviewTemplate(cat, data, fname, ftype, pId, false, null, fc, ftr, ind);\n                },\n                msg: function (n) {\n                    return obj._getMsgSelected(n);\n                },\n                initId: obj.previewInitId,\n                footer: obj._getLayoutTemplate('footer').replace(/\\{progress}/g, obj._renderThumbProgress()),\n                isDelete: obj.initialPreviewShowDelete,\n                caption: obj.initialCaption,\n                actions: function (showUpload, showDelete, showZoom, showDrag, disabled, url, key) {\n                    return obj._renderFileActions(showUpload, showDelete, showZoom, showDrag, disabled, url, key, true);\n                }\n            };\n        },\n        fetch: function (id) {\n            return previewCache.data[id].content.filter(function (n) {\n                return n !== null;\n            });\n        },\n        count: function (id, all) {\n            return !!previewCache.data[id] && !!previewCache.data[id].content ?\n                (all ? previewCache.data[id].content.length : previewCache.fetch(id).length) : 0;\n        },\n        get: function (id, i, isDisabled) {\n            var ind = 'init_' + i, data = previewCache.data[id], config = data.config[i], content = data.content[i],\n                previewId = data.initId + '-' + ind, out, $tmp, frameClass = ' file-preview-initial', cat, cap, ftr,\n                ftype, asData = ifSet('previewAsData', config, data.previewAsData);\n            isDisabled = isDisabled === undefined ? true : isDisabled;\n            /** @namespace config.frameAttr */\n            /** @namespace config.frameClass */\n            /** @namespace config.filetype */\n            if (!content) {\n                return '';\n            }\n            if (config && config.frameClass) {\n                frameClass += ' ' + config.frameClass;\n            }\n            if (asData) {\n                cat = data.previewAsData ? ifSet('type', config, data.previewFileType || 'generic') : 'generic';\n                cap = ifSet('caption', config);\n                ftr = previewCache.footer(id, i, isDisabled, (config && config.size || null));\n                ftype = ifSet('filetype', config, cat);\n                out = data.parseTemplate(cat, content, cap, ftype, previewId, ftr, ind, null);\n            } else {\n                out = data.template\n                    .replace(/\\{previewId}/g, previewId).replace(/\\{frameClass}/g, frameClass)\n                    .replace(/\\{fileindex}/g, ind).replace(/\\{content}/g, data.content[i])\n                    .replace(/\\{template}/g, ifSet('type', config, data.previewFileType))\n                    .replace(/\\{footer}/g, previewCache.footer(id, i, isDisabled, (config && config.size || null)));\n            }\n            if (data.tags.length && data.tags[i]) {\n                out = replaceTags(out, data.tags[i]);\n            }\n            if (!isEmpty(config) && !isEmpty(config.frameAttr)) {\n                $tmp = $(document.createElement('div')).html(out);\n                $tmp.find('.file-preview-initial').attr(config.frameAttr);\n                out = $tmp.html();\n                $tmp.remove();\n            }\n            return out;\n        },\n        add: function (id, content, config, tags, append) {\n            var data = $.extend(true, {}, previewCache.data[id]), index;\n            if (!isArray(content)) {\n                content = content.split(data.delimiter);\n            }\n            if (append) {\n                index = data.content.push(content) - 1;\n                data.config[index] = config;\n                data.tags[index] = tags;\n            } else {\n                index = content.length - 1;\n                data.content = content;\n                data.config = config;\n                data.tags = tags;\n            }\n            previewCache.data[id] = data;\n            return index;\n        },\n        set: function (id, content, config, tags, append) {\n            var data = $.extend(true, {}, previewCache.data[id]), i, chk;\n            if (!content || !content.length) {\n                return;\n            }\n            if (!isArray(content)) {\n                content = content.split(data.delimiter);\n            }\n            chk = content.filter(function (n) {\n                return n !== null;\n            });\n            if (!chk.length) {\n                return;\n            }\n            if (data.content === undefined) {\n                data.content = [];\n            }\n            if (data.config === undefined) {\n                data.config = [];\n            }\n            if (data.tags === undefined) {\n                data.tags = [];\n            }\n            if (append) {\n                for (i = 0; i < content.length; i++) {\n                    if (content[i]) {\n                        data.content.push(content[i]);\n                    }\n                }\n                for (i = 0; i < config.length; i++) {\n                    if (config[i]) {\n                        data.config.push(config[i]);\n                    }\n                }\n                for (i = 0; i < tags.length; i++) {\n                    if (tags[i]) {\n                        data.tags.push(tags[i]);\n                    }\n                }\n            } else {\n                data.content = content;\n                data.config = config;\n                data.tags = tags;\n            }\n            previewCache.data[id] = data;\n        },\n        unset: function (id, index) {\n            var chk = previewCache.count(id);\n            if (!chk) {\n                return;\n            }\n            if (chk === 1) {\n                previewCache.data[id].content = [];\n                previewCache.data[id].config = [];\n                previewCache.data[id].tags = [];\n                return;\n            }\n            previewCache.data[id].content[index] = null;\n            previewCache.data[id].config[index] = null;\n            previewCache.data[id].tags[index] = null;\n        },\n        out: function (id) {\n            var html = '', data = previewCache.data[id], caption, len = previewCache.count(id, true);\n            if (len === 0) {\n                return {content: '', caption: ''};\n            }\n            for (var i = 0; i < len; i++) {\n                html += previewCache.get(id, i);\n            }\n            caption = data.msg(previewCache.count(id));\n            return {content: '<div class=\"file-initial-thumbs\">' + html + '</div>', caption: caption};\n        },\n        footer: function (id, i, isDisabled, size) {\n            var data = previewCache.data[id];\n            isDisabled = isDisabled === undefined ? true : isDisabled;\n            if (data.config.length === 0 || isEmpty(data.config[i])) {\n                return '';\n            }\n            var config = data.config[i], caption = ifSet('caption', config), width = ifSet('width', config, 'auto'),\n                url = ifSet('url', config, false), key = ifSet('key', config, null),\n                showDel = ifSet('showDelete', config, true), showZoom = ifSet('showZoom', config, data.showZoom),\n                showDrag = ifSet('showDrag', config, data.showDrag), disabled = (url === false) && isDisabled,\n                actions = data.isDelete ? data.actions(false, showDel, showZoom, showDrag, disabled, url, key) : '',\n                footer = data.footer.replace(/\\{actions}/g, actions);\n            return footer.replace(/\\{caption}/g, caption).replace(/\\{size}/g, data.getSize(size))\n                .replace(/\\{width}/g, width).replace(/\\{indicator}/g, '').replace(/\\{indicatorTitle}/g, '');\n        }\n    };\n    getNum = function (num, def) {\n        def = def || 0;\n        if (typeof num === \"number\") {\n            return num;\n        }\n        if (typeof num === \"string\") {\n            num = parseFloat(num);\n        }\n        return isNaN(num) ? def : num;\n    };\n    hasFileAPISupport = function () {\n        return !!(window.File && window.FileReader);\n    };\n    hasDragDropSupport = function () {\n        var div = document.createElement('div');\n        /** @namespace div.draggable */\n        /** @namespace div.ondragstart */\n        /** @namespace div.ondrop */\n        return !isIE(9) && (div.draggable !== undefined || (div.ondragstart !== undefined && div.ondrop !== undefined));\n    };\n    hasFileUploadSupport = function () {\n        return hasFileAPISupport() && window.FormData;\n    };\n    addCss = function ($el, css) {\n        $el.removeClass(css).addClass(css);\n    };\n    defaultFileActionSettings = {\n        showRemove: true,\n        showUpload: true,\n        showZoom: true,\n        showDrag: true,\n        removeIcon: '<i class=\"glyphicon glyphicon-trash text-danger\"></i>',\n        removeClass: 'btn btn-xs btn-default',\n        removeTitle: 'Remove file',\n        uploadIcon: '<i class=\"glyphicon glyphicon-upload text-info\"></i>',\n        uploadClass: 'btn btn-xs btn-default',\n        uploadTitle: 'Upload file',\n        zoomIcon: '<i class=\"glyphicon glyphicon-zoom-in\"></i>',\n        zoomClass: 'btn btn-xs btn-default',\n        zoomTitle: 'View Details',\n        dragIcon: '<i class=\"glyphicon glyphicon-menu-hamburger\"></i>',\n        dragClass: 'text-info',\n        dragTitle: 'Move / Rearrange',\n        dragSettings: {},\n        indicatorNew: '<i class=\"glyphicon glyphicon-hand-down text-warning\"></i>',\n        indicatorSuccess: '<i class=\"glyphicon glyphicon-ok-sign text-success\"></i>',\n        indicatorError: '<i class=\"glyphicon glyphicon-exclamation-sign text-danger\"></i>',\n        indicatorLoading: '<i class=\"glyphicon glyphicon-hand-up text-muted\"></i>',\n        indicatorNewTitle: 'Not uploaded yet',\n        indicatorSuccessTitle: 'Uploaded',\n        indicatorErrorTitle: 'Upload Error',\n        indicatorLoadingTitle: 'Uploading ...'\n    };\n    tMain1 = '{preview}\\n' +\n        '<div class=\"kv-upload-progress hide\"></div>\\n' +\n        '<div class=\"input-group {class}\">\\n' +\n        '   {caption}\\n' +\n        '   <div class=\"input-group-btn\">\\n' +\n        '       {remove}\\n' +\n        '       {cancel}\\n' +\n        '       {upload}\\n' +\n        '       {browse}\\n' +\n        '   </div>\\n' +\n        '</div>';\n    tMain2 = '{preview}\\n<div class=\"kv-upload-progress hide\"></div>\\n{remove}\\n{cancel}\\n{upload}\\n{browse}\\n';\n    tPreview = '<div class=\"file-preview {class}\">\\n' +\n        '    {close}' +\n        '    <div class=\"{dropClass}\">\\n' +\n        '    <div class=\"file-preview-thumbnails\">\\n' +\n        '    </div>\\n' +\n        '    <div class=\"clearfix\"></div>' +\n        '    <div class=\"file-preview-status text-center text-success\"></div>\\n' +\n        '    <div class=\"kv-fileinput-error\"></div>\\n' +\n        '    </div>\\n' +\n        '</div>';\n    tClose = '<div class=\"close fileinput-remove\">&times;</div>\\n';\n    tFileIcon = '<i class=\"glyphicon glyphicon-file kv-caption-icon\"></i>';\n    tCaption = '<div tabindex=\"500\" class=\"form-control file-caption {class}\">\\n' +\n        '   <div class=\"file-caption-name\"></div>\\n' +\n        '</div>\\n';\n    //noinspection HtmlUnknownAttribute\n    tBtnDefault = '<button type=\"{type}\" tabindex=\"500\" title=\"{title}\" class=\"{css}\" {status}>{icon} {label}</button>';\n    //noinspection HtmlUnknownAttribute\n    tBtnLink = '<a href=\"{href}\" tabindex=\"500\" title=\"{title}\" class=\"{css}\" {status}>{icon} {label}</a>';\n    //noinspection HtmlUnknownAttribute\n    tBtnBrowse = '<div tabindex=\"500\" class=\"{css}\" {status}>{icon} {label}</div>';\n    tModalMain = '<div id=\"' + MODAL_ID + '\" class=\"file-zoom-dialog modal fade\" tabindex=\"-1\" aria-labelledby=\"' +\n        MODAL_ID + 'Label\"></div>';\n    tModal = '<div class=\"modal-dialog modal-lg\" role=\"document\">\\n' +\n        '  <div class=\"modal-content\">\\n' +\n        '    <div class=\"modal-header\">\\n' +\n        '      <div class=\"kv-zoom-actions pull-right\">{toggleheader}{fullscreen}{borderless}{close}</div>\\n' +\n        '      <h3 class=\"modal-title\">{heading} <small><span class=\"kv-zoom-title\"></span></small></h3>\\n' +\n        '    </div>\\n' +\n        '    <div class=\"modal-body\">\\n' +\n        '      <div class=\"floating-buttons\"></div>\\n' +\n        '      <div class=\"kv-zoom-body file-zoom-content\"></div>\\n' + '{prev} {next}\\n' +\n        '    </div>\\n' +\n        '  </div>\\n' +\n        '</div>\\n';\n    tProgress = '<div class=\"progress\">\\n' +\n        '    <div class=\"{class}\" role=\"progressbar\"' +\n        ' aria-valuenow=\"{percent}\" aria-valuemin=\"0\" aria-valuemax=\"100\" style=\"width:{percent}%;\">\\n' +\n        '        {percent}%\\n' +\n        '     </div>\\n' +\n        '</div>';\n    tSize = ' <br><samp>({sizeText})</samp>';\n    tFooter = '<div class=\"file-thumbnail-footer\">\\n' +\n        '    <div class=\"file-footer-caption\" title=\"{caption}\">{caption}{size}</div>\\n' +\n        '    {progress} {actions}\\n' +\n        '</div>';\n    tActions = '<div class=\"file-actions\">\\n' +\n        '    <div class=\"file-footer-buttons\">\\n' +\n        '        {upload} {delete} {zoom} {other}' +\n        '    </div>\\n' +\n        '    {drag}\\n' +\n        '    <div class=\"file-upload-indicator\" title=\"{indicatorTitle}\">{indicator}</div>\\n' +\n        '    <div class=\"clearfix\"></div>\\n' +\n        '</div>';\n    //noinspection HtmlUnknownAttribute\n    tActionDelete = '<button type=\"button\" class=\"kv-file-remove {removeClass}\" ' + 'title=\"{removeTitle}\" {dataUrl}{dataKey}>{removeIcon}</button>\\n';\n    tActionUpload = '<button type=\"button\" class=\"kv-file-upload {uploadClass}\" title=\"{uploadTitle}\">' +\n        '{uploadIcon}</button>';\n    tActionZoom = '<button type=\"button\" class=\"kv-file-zoom {zoomClass}\" title=\"{zoomTitle}\">{zoomIcon}</button>';\n    tActionDrag = '<span class=\"file-drag-handle {dragClass}\" title=\"{dragTitle}\">{dragIcon}</span>';\n    tTagBef = '<div class=\"file-preview-frame{frameClass}\" id=\"{previewId}\" data-fileindex=\"{fileindex}\"' +\n        ' data-template=\"{template}\"';\n    tTagBef1 = tTagBef + '><div class=\"kv-file-content\">\\n';\n    tTagBef2 = tTagBef + ' title=\"{caption}\" ' + STYLE_SETTING + '><div class=\"kv-file-content\">\\n';\n    tTagAft = '</div>{footer}\\n</div>\\n';\n    tGeneric = '{content}\\n';\n    tHtml = '<div class=\"kv-preview-data file-preview-html\" title=\"{caption}\" ' + STYLE_SETTING + '>{data}</div>\\n';\n    tImage = '<img src=\"{data}\" class=\"kv-preview-data file-preview-image\" title=\"{caption}\" alt=\"{caption}\" ' +\n        STYLE_SETTING + '>\\n';\n    tText = '<textarea class=\"kv-preview-data file-preview-text\" title=\"{caption}\" readonly ' + STYLE_SETTING +\n        '>{data}</textarea>\\n';\n    tVideo = '<video class=\"kv-preview-data\" width=\"{width}\" height=\"{height}\" controls>\\n' +\n        '<source src=\"{data}\" type=\"{type}\">\\n' + DEFAULT_PREVIEW + '\\n</video>\\n';\n    tAudio = '<audio class=\"kv-preview-data\" controls>\\n<source src=\"' + '{data}' + '\" type=\"{type}\">\\n' +\n        DEFAULT_PREVIEW + '\\n</audio>\\n';\n    tFlash = '<object class=\"kv-preview-data file-object\" type=\"application/x-shockwave-flash\" ' +\n        'width=\"{width}\" height=\"{height}\" data=\"{data}\">\\n' + OBJECT_PARAMS + ' ' + DEFAULT_PREVIEW + '\\n</object>\\n';\n    tObject = '<object class=\"kv-preview-data file-object\" data=\"{data}\" type=\"{type}\" width=\"{width}\" height=\"{height}\">\\n' +\n        '<param name=\"movie\" value=\"{caption}\" />\\n' + OBJECT_PARAMS + ' ' + DEFAULT_PREVIEW + '\\n</object>\\n';\n    tPdf = '<embed class=\"kv-preview-data\" src=\"{data}\" width=\"{width}\" height=\"{height}\" type=\"application/pdf\">\\n';\n    tOther = '<div class=\"kv-preview-data file-preview-other-frame\">\\n' + DEFAULT_PREVIEW + '\\n</div>\\n';\n    defaultLayoutTemplates = {\n        main1: tMain1,\n        main2: tMain2,\n        preview: tPreview,\n        close: tClose,\n        fileIcon: tFileIcon,\n        caption: tCaption,\n        modalMain: tModalMain,\n        modal: tModal,\n        progress: tProgress,\n        size: tSize,\n        footer: tFooter,\n        actions: tActions,\n        actionDelete: tActionDelete,\n        actionUpload: tActionUpload,\n        actionZoom: tActionZoom,\n        actionDrag: tActionDrag,\n        btnDefault: tBtnDefault,\n        btnLink: tBtnLink,\n        btnBrowse: tBtnBrowse\n    };\n    defaultPreviewTemplates = {\n        generic: tTagBef1 + tGeneric + tTagAft,\n        html: tTagBef1 + tHtml + tTagAft,\n        image: tTagBef1 + tImage + tTagAft,\n        text: tTagBef1 + tText + tTagAft,\n        video: tTagBef2 + tVideo + tTagAft,\n        audio: tTagBef2 + tAudio + tTagAft,\n        flash: tTagBef2 + tFlash + tTagAft,\n        object: tTagBef2 + tObject + tTagAft,\n        pdf: tTagBef2 + tPdf + tTagAft,\n        other: tTagBef2 + tOther + tTagAft\n    };\n    defaultPreviewTypes = ['image', 'html', 'text', 'video', 'audio', 'flash', 'pdf', 'object'];\n    defaultPreviewSettings = {\n        image: {width: \"auto\", height: \"160px\"},\n        html: {width: \"213px\", height: \"160px\"},\n        text: {width: \"213px\", height: \"160px\"},\n        video: {width: \"213px\", height: \"160px\"},\n        audio: {width: \"213px\", height: \"80px\"},\n        flash: {width: \"213px\", height: \"160px\"},\n        object: {width: \"160px\", height: \"160px\"},\n        pdf: {width: \"160px\", height: \"160px\"},\n        other: {width: \"160px\", height: \"160px\"}\n    };\n    defaultPreviewZoomSettings = {\n        image: {width: \"100%\", height: \"100%\"},\n        html: {width: \"100%\", height: \"100%\", 'min-height': \"480px\"},\n        text: {width: \"100%\", height: \"100%\", 'min-height': \"480px\"},\n        video: {width: \"auto\", height: \"100%\", 'max-width': \"100%\"},\n        audio: {width: \"100%\", height: \"30px\"},\n        flash: {width: \"auto\", height: \"480px\"},\n        object: {width: \"auto\", height: \"100%\", 'min-height': \"480px\"},\n        pdf: {width: \"100%\", height: \"100%\", 'min-height': \"480px\"},\n        other: {width: \"auto\", height: \"100%\", 'min-height': \"480px\"}\n    };\n    defaultFileTypeSettings = {\n        image: function (vType, vName) {\n            return compare(vType, 'image.*') || compare(vName, /\\.(gif|png|jpe?g)$/i);\n        },\n        html: function (vType, vName) {\n            return compare(vType, 'text/html') || compare(vName, /\\.(htm|html)$/i);\n        },\n        text: function (vType, vName) {\n            return compare(vType, 'text.*') || compare(vName, /\\.(xml|javascript)$/i) ||\n                compare(vName, /\\.(txt|md|csv|nfo|ini|json|php|js|css)$/i);\n        },\n        video: function (vType, vName) {\n            return compare(vType, 'video.*') && (compare(vType, /(ogg|mp4|mp?g|webm|3gp)$/i) ||\n                compare(vName, /\\.(og?|mp4|webm|mp?g|3gp)$/i));\n        },\n        audio: function (vType, vName) {\n            return compare(vType, 'audio.*') && (compare(vName, /(ogg|mp3|mp?g|wav)$/i) ||\n                compare(vName, /\\.(og?|mp3|mp?g|wav)$/i));\n        },\n        flash: function (vType, vName) {\n            return compare(vType, 'application/x-shockwave-flash', true) || compare(vName, /\\.(swf)$/i);\n        },\n        pdf: function (vType, vName) {\n            return compare(vType, 'application/pdf', true) || compare(vName, /\\.(pdf)$/i);\n        },\n        object: function () {\n            return true;\n        },\n        other: function () {\n            return true;\n        }\n    };\n    isEmpty = function (value, trim) {\n        return value === undefined || value === null || value.length === 0 || (trim && $.trim(value) === '');\n    };\n    isArray = function (a) {\n        return Array.isArray(a) || Object.prototype.toString.call(a) === '[object Array]';\n    };\n    ifSet = function (needle, haystack, def) {\n        def = def || '';\n        return (haystack && typeof haystack === 'object' && needle in haystack) ? haystack[needle] : def;\n    };\n    getElement = function (options, param, value) {\n        return (isEmpty(options) || isEmpty(options[param])) ? value : $(options[param]);\n    };\n    uniqId = function () {\n        return Math.round(new Date().getTime() + (Math.random() * 100));\n    };\n    htmlEncode = function (str) {\n        return str.replace(/&/g, '&amp;')\n            .replace(/</g, '&lt;')\n            .replace(/>/g, '&gt;')\n            .replace(/\"/g, '&quot;')\n            .replace(/'/g, '&apos;');\n    };\n    replaceTags = function (str, tags) {\n        var out = str;\n        if (!tags) {\n            return out;\n        }\n        $.each(tags, function (key, value) {\n            if (typeof value === \"function\") {\n                value = value();\n            }\n            out = out.split(key).join(value);\n        });\n        return out;\n    };\n    cleanMemory = function ($thumb) {\n        var data = $thumb.is('img') ? $thumb.attr('src') : $thumb.find('source').attr('src');\n        /** @namespace objUrl.revokeObjectURL */\n        objUrl.revokeObjectURL(data);\n    };\n    findFileName = function (filePath) {\n        var sepIndex = filePath.lastIndexOf('/');\n        if (sepIndex === -1) {\n            sepIndex = filePath.lastIndexOf('\\\\');\n        }\n        return filePath.split(filePath.substring(sepIndex, sepIndex + 1)).pop();\n    };\n    checkFullScreen = function () {\n        //noinspection JSUnresolvedVariable\n        return document.fullscreenElement || document.mozFullScreenElement || document.webkitFullscreenElement ||\n            document.msFullscreenElement;\n    };\n    toggleFullScreen = function (maximize) {\n        if (maximize && !checkFullScreen()) {\n            /** @namespace document.documentElement.requestFullscreen */\n            /** @namespace document.documentElement.msRequestFullscreen */\n            /** @namespace document.documentElement.mozRequestFullScreen */\n            /** @namespace document.documentElement.webkitRequestFullscreen */\n            /** @namespace Element.ALLOW_KEYBOARD_INPUT */\n            if (document.documentElement.requestFullscreen) {\n                document.documentElement.requestFullscreen();\n            } else if (document.documentElement.msRequestFullscreen) {\n                document.documentElement.msRequestFullscreen();\n            } else if (document.documentElement.mozRequestFullScreen) {\n                document.documentElement.mozRequestFullScreen();\n            } else if (document.documentElement.webkitRequestFullscreen) {\n                document.documentElement.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);\n            }\n        } else {\n            /** @namespace document.exitFullscreen */\n            /** @namespace document.msExitFullscreen */\n            /** @namespace document.mozCancelFullScreen */\n            /** @namespace document.webkitExitFullscreen */\n            if (document.exitFullscreen) {\n                document.exitFullscreen();\n            } else if (document.msExitFullscreen) {\n                document.msExitFullscreen();\n            } else if (document.mozCancelFullScreen) {\n                document.mozCancelFullScreen();\n            } else if (document.webkitExitFullscreen) {\n                document.webkitExitFullscreen();\n            }\n        }\n    };\n    moveArray = function (arr, oldIndex, newIndex) {\n        if (newIndex >= arr.length) {\n            var k = newIndex - arr.length;\n            while ((k--) + 1) {\n                arr.push(undefined);\n            }\n        }\n        arr.splice(newIndex, 0, arr.splice(oldIndex, 1)[0]);\n        return arr;\n    };\n    FileInput = function (element, options) {\n        var self = this;\n        self.$element = $(element);\n        if (!self._validate()) {\n            return;\n        }\n        self.isPreviewable = hasFileAPISupport();\n        self.isIE9 = isIE(9);\n        self.isIE10 = isIE(10);\n        if (self.isPreviewable || self.isIE9) {\n            self._init(options);\n            self._listen();\n        } else {\n            self.$element.removeClass('file-loading');\n        }\n    };\n    FileInput.prototype = {\n        constructor: FileInput,\n        _init: function (options) {\n            var self = this, $el = self.$element, t;\n            $.each(options, function (key, value) {\n                switch (key) {\n                    case 'minFileCount':\n                    case 'maxFileCount':\n                    case 'maxFileSize':\n                        self[key] = getNum(value);\n                        break;\n                    default:\n                        self[key] = value;\n                        break;\n                }\n            });\n            self.fileInputCleared = false;\n            self.fileBatchCompleted = true;\n            if (!self.isPreviewable) {\n                self.showPreview = false;\n            }\n            self.uploadFileAttr = !isEmpty($el.attr('name')) ? $el.attr('name') : 'file_data';\n            self.reader = null;\n            self.formdata = {};\n            self.clearStack();\n            self.uploadCount = 0;\n            self.uploadStatus = {};\n            self.uploadLog = [];\n            self.uploadAsyncCount = 0;\n            self.loadedImages = [];\n            self.totalImagesCount = 0;\n            self.ajaxRequests = [];\n            self.isError = false;\n            self.ajaxAborted = false;\n            self.cancelling = false;\n            t = self._getLayoutTemplate('progress');\n            self.progressTemplate = t.replace('{class}', self.progressClass);\n            self.progressCompleteTemplate = t.replace('{class}', self.progressCompleteClass);\n            self.progressErrorTemplate = t.replace('{class}', self.progressErrorClass);\n            self.dropZoneEnabled = hasDragDropSupport() && self.dropZoneEnabled;\n            self.isDisabled = self.$element.attr('disabled') || self.$element.attr('readonly');\n            self.isUploadable = hasFileUploadSupport() && !isEmpty(self.uploadUrl);\n            self.isClickable = self.browseOnZoneClick && self.showPreview &&\n                (self.isUploadable && self.dropZoneEnabled || !isEmpty(self.defaultPreviewContent));\n            self.slug = typeof options.slugCallback === \"function\" ? options.slugCallback : self._slugDefault;\n            self.mainTemplate = self.showCaption ? self._getLayoutTemplate('main1') : self._getLayoutTemplate('main2');\n            self.captionTemplate = self._getLayoutTemplate('caption');\n            self.previewGenericTemplate = self._getPreviewTemplate('generic');\n            if (self.resizeImage && (self.maxImageWidth || self.maxImageHeight)) {\n                self.imageCanvas = document.createElement('canvas');\n                self.imageCanvasContext = self.imageCanvas.getContext('2d');\n            }\n            if (isEmpty(self.$element.attr('id'))) {\n                self.$element.attr('id', uniqId());\n            }\n            if (self.$container === undefined) {\n                self.$container = self._createContainer();\n            } else {\n                self._refreshContainer();\n            }\n            self.$dropZone = self.$container.find('.file-drop-zone');\n            self.$progress = self.$container.find('.kv-upload-progress');\n            self.$btnUpload = self.$container.find('.fileinput-upload');\n            self.$captionContainer = getElement(options, 'elCaptionContainer', self.$container.find('.file-caption'));\n            self.$caption = getElement(options, 'elCaptionText', self.$container.find('.file-caption-name'));\n            self.$previewContainer = getElement(options, 'elPreviewContainer', self.$container.find('.file-preview'));\n            self.$preview = getElement(options, 'elPreviewImage', self.$container.find('.file-preview-thumbnails'));\n            self.$previewStatus = getElement(options, 'elPreviewStatus', self.$container.find('.file-preview-status'));\n            self.$errorContainer = getElement(options, 'elErrorContainer',\n                self.$previewContainer.find('.kv-fileinput-error'));\n            if (!isEmpty(self.msgErrorClass)) {\n                addCss(self.$errorContainer, self.msgErrorClass);\n            }\n            self.$errorContainer.hide();\n            self.fileActionSettings = $.extend(true, defaultFileActionSettings, options.fileActionSettings);\n            self.previewInitId = \"preview-\" + uniqId();\n            self.id = self.$element.attr('id');\n            previewCache.init(self);\n            self._initPreview(true);\n            self._initPreviewActions();\n            self.options = options;\n            self._setFileDropZoneTitle();\n            self.$element.removeClass('file-loading');\n            if (self.$element.attr('disabled')) {\n                self.disable();\n            }\n            self._initZoom();\n        },\n        _validate: function () {\n            var self = this, $exception;\n            if (self.$element.attr('type') === 'file') {\n                return true;\n            }\n            $exception = '<div class=\"help-block alert alert-warning\">' +\n                '<h4>Invalid Input Type</h4>' +\n                'You must set an input <code>type = file</code> for <b>bootstrap-fileinput</b> plugin to initialize.' +\n                '</div>';\n            self.$element.after($exception);\n            return false;\n        },\n        _errorsExist: function () {\n            var self = this, $err;\n            if (self.$errorContainer.find('li').length) {\n                return true;\n            }\n            $err = $(document.createElement('div')).html(self.$errorContainer.html());\n            $err.find('span.kv-error-close').remove();\n            $err.find('ul').remove();\n            return $.trim($err.text()).length ? true : false;\n        },\n        _errorHandler: function (evt, caption) {\n            var self = this, err = evt.target.error;\n            /** @namespace err.NOT_FOUND_ERR */\n            /** @namespace err.SECURITY_ERR */\n            /** @namespace err.NOT_READABLE_ERR */\n            if (err.code === err.NOT_FOUND_ERR) {\n                self._showError(self.msgFileNotFound.replace('{name}', caption));\n            } else if (err.code === err.SECURITY_ERR) {\n                self._showError(self.msgFileSecured.replace('{name}', caption));\n            } else if (err.code === err.NOT_READABLE_ERR) {\n                self._showError(self.msgFileNotReadable.replace('{name}', caption));\n            } else if (err.code === err.ABORT_ERR) {\n                self._showError(self.msgFilePreviewAborted.replace('{name}', caption));\n            } else {\n                self._showError(self.msgFilePreviewError.replace('{name}', caption));\n            }\n        },\n        _addError: function (msg) {\n            var self = this, $error = self.$errorContainer;\n            if (msg && $error.length) {\n                $error.html(self.errorCloseButton + msg);\n                handler($error.find('.kv-error-close'), 'click', function () {\n                    $error.fadeOut('slow');\n                });\n            }\n        },\n        _resetErrors: function (fade) {\n            var self = this, $error = self.$errorContainer;\n            self.isError = false;\n            self.$container.removeClass('has-error');\n            $error.html('');\n            if (fade) {\n                $error.fadeOut('slow');\n            } else {\n                $error.hide();\n            }\n        },\n        _showFolderError: function (folders) {\n            var self = this, $error = self.$errorContainer, msg;\n            if (!folders) {\n                return;\n            }\n            msg = self.msgFoldersNotAllowed.replace(/\\{n}/g, folders);\n            self._addError(msg);\n            addCss(self.$container, 'has-error');\n            $error.fadeIn(800);\n            self._raise('filefoldererror', [folders, msg]);\n        },\n        _showUploadError: function (msg, params, event) {\n            var self = this, $error = self.$errorContainer, ev = event || 'fileuploaderror', e = params && params.id ?\n            '<li data-file-id=\"' + params.id + '\">' + msg + '</li>' : '<li>' + msg + '</li>';\n            if ($error.find('ul').length === 0) {\n                self._addError('<ul>' + e + '</ul>');\n            } else {\n                $error.find('ul').append(e);\n            }\n            $error.fadeIn(800);\n            self._raise(ev, [params, msg]);\n            self.$container.removeClass('file-input-new');\n            addCss(self.$container, 'has-error');\n            return true;\n        },\n        _showError: function (msg, params, event) {\n            var self = this, $error = self.$errorContainer, ev = event || 'fileerror';\n            params = params || {};\n            params.reader = self.reader;\n            self._addError(msg);\n            $error.fadeIn(800);\n            self._raise(ev, [params, msg]);\n            if (!self.isUploadable) {\n                self._clearFileInput();\n            }\n            self.$container.removeClass('file-input-new');\n            addCss(self.$container, 'has-error');\n            self.$btnUpload.attr('disabled', true);\n            return true;\n        },\n        _noFilesError: function (params) {\n            var self = this, label = self.minFileCount > 1 ? self.filePlural : self.fileSingle,\n                msg = self.msgFilesTooLess.replace('{n}', self.minFileCount).replace('{files}', label),\n                $error = self.$errorContainer;\n            self._addError(msg);\n            self.isError = true;\n            self._updateFileDetails(0);\n            $error.fadeIn(800);\n            self._raise('fileerror', [params, msg]);\n            self._clearFileInput();\n            addCss(self.$container, 'has-error');\n        },\n        _parseError: function (jqXHR, errorThrown, fileName) {\n            /** @namespace jqXHR.responseJSON */\n            var self = this, errMsg = $.trim(errorThrown + ''),\n                dot = errMsg.slice(-1) === '.' ? '' : '.',\n                text = jqXHR.responseJSON !== undefined && jqXHR.responseJSON.error !== undefined ?\n                    jqXHR.responseJSON.error : jqXHR.responseText;\n            if (self.cancelling && self.msgUploadAborted) {\n                errMsg = self.msgUploadAborted;\n            }\n            if (self.showAjaxErrorDetails && text) {\n                text = $.trim(text.replace(/\\n\\s*\\n/g, '\\n'));\n                text = text.length > 0 ? '<pre>' + text + '</pre>' : '';\n                errMsg += dot + text;\n            } else {\n                errMsg += dot;\n            }\n            self.cancelling = false;\n            return fileName ? '<b>' + fileName + ': </b>' + errMsg : errMsg;\n        },\n        _parseFileType: function (file) {\n            var self = this, isValid, vType, cat, i;\n            for (i = 0; i < defaultPreviewTypes.length; i += 1) {\n                cat = defaultPreviewTypes[i];\n                isValid = ifSet(cat, self.fileTypeSettings, defaultFileTypeSettings[cat]);\n                vType = isValid(file.type, file.name) ? cat : '';\n                if (!isEmpty(vType)) {\n                    return vType;\n                }\n            }\n            return 'other';\n        },\n        _parseFilePreviewIcon: function (content, fname) {\n            var self = this, proceed, ext, icn = self.previewFileIcon;\n            if (fname && fname.indexOf('.') > -1) {\n                ext = fname.split('.').pop();\n                if (self.previewFileIconSettings && self.previewFileIconSettings[ext]) {\n                    icn = self.previewFileIconSettings[ext];\n                }\n                if (self.previewFileExtSettings) {\n                    $.each(self.previewFileExtSettings, function (key, func) {\n                        if (self.previewFileIconSettings[key] && func(ext)) {\n                            icn = self.previewFileIconSettings[key];\n                            return;\n                        }\n                        proceed = true;\n                    });\n                }\n            }\n            if (content.indexOf('{previewFileIcon}') > -1) {\n                return content.replace(/\\{previewFileIconClass}/g, self.previewFileIconClass).replace(\n                    /\\{previewFileIcon}/g, icn);\n            }\n            return content;\n        },\n        _raise: function (event, params) {\n            var self = this, e = $.Event(event);\n            if (params !== undefined) {\n                self.$element.trigger(e, params);\n            } else {\n                self.$element.trigger(e);\n            }\n            if (e.isDefaultPrevented()) {\n                return false;\n            }\n            if (!e.result) {\n                return e.result;\n            }\n            switch (event) {\n                // ignore these events\n                case 'filebatchuploadcomplete':\n                case 'filebatchuploadsuccess':\n                case 'fileuploaded':\n                case 'fileclear':\n                case 'filecleared':\n                case 'filereset':\n                case 'fileerror':\n                case 'filefoldererror':\n                case 'fileuploaderror':\n                case 'filebatchuploaderror':\n                case 'filedeleteerror':\n                case 'filecustomerror':\n                case 'filesuccessremove':\n                    break;\n                // receive data response via `filecustomerror` event`\n                default:\n                    self.ajaxAborted = e.result;\n                    break;\n            }\n            return true;\n        },\n        _listenFullScreen: function (isFullScreen) {\n            var self = this, $modal = self.$modal, $btnFull, $btnBord;\n            if (!$modal || !$modal.length) {\n                return;\n            }\n            $btnFull = $modal && $modal.find('.btn-fullscreen');\n            $btnBord = $modal && $modal.find('.btn-borderless');\n            if (!$btnFull.length || !$btnBord.length) {\n                return;\n            }\n            $btnFull.removeClass('active').attr('aria-pressed', 'false');\n            $btnBord.removeClass('active').attr('aria-pressed', 'false');\n            if (isFullScreen) {\n                $btnFull.addClass('active').attr('aria-pressed', 'true');\n            } else {\n                $btnBord.addClass('active').attr('aria-pressed', 'true');\n            }\n            if ($modal.hasClass('file-zoom-fullscreen')) {\n                self._maximizeZoomDialog();\n            } else {\n                if (isFullScreen) {\n                    self._maximizeZoomDialog();\n                } else {\n                    $btnBord.removeClass('active').attr('aria-pressed', 'false');\n                }\n            }\n        },\n        _listen: function () {\n            var self = this, $el = self.$element, $form = $el.closest('form'), $cont = self.$container;\n            handler($el, 'change', $.proxy(self._change, self));\n            if (self.showBrowse) {\n                handler(self.$btnFile, 'click', $.proxy(self._browse, self));\n            }\n            handler($form, 'reset', $.proxy(self.reset, self));\n            handler($cont.find('.fileinput-remove:not([disabled])'), 'click', $.proxy(self.clear, self));\n            handler($cont.find('.fileinput-cancel'), 'click', $.proxy(self.cancel, self));\n            self._initDragDrop();\n            if (!self.isUploadable) {\n                handler($form, 'submit', $.proxy(self._submitForm, self));\n            }\n            handler(self.$container.find('.fileinput-upload'), 'click', $.proxy(self._uploadClick, self));\n            handler($(window), 'resize', function () {\n                self._listenFullScreen(screen.width === window.innerWidth && screen.height === window.innerHeight);\n            });\n            handler($(document), 'webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange',\n                function () {\n                    self._listenFullScreen(checkFullScreen());\n                });\n            self._initClickable();\n        },\n        _initClickable: function () {\n            var self = this, $zone;\n            if (!self.isClickable) {\n                return;\n            }\n            $zone = self.isUploadable ? self.$dropZone : self.$preview.find('.file-default-preview');\n            addCss($zone, 'clickable');\n            $zone.attr('tabindex', -1);\n            handler($zone, 'click', function (e) {\n                var $target = $(e.target);\n                if (!$target.parents('.file-preview-thumbnails').length || $target.parents(\n                        '.file-default-preview').length) {\n                    self.$element.trigger('click');\n                    $zone.blur();\n                }\n            });\n        },\n        _initDragDrop: function () {\n            var self = this, $zone = self.$dropZone;\n            if (self.isUploadable && self.dropZoneEnabled && self.showPreview) {\n                handler($zone, 'dragenter dragover', $.proxy(self._zoneDragEnter, self));\n                handler($zone, 'dragleave', $.proxy(self._zoneDragLeave, self));\n                handler($zone, 'drop', $.proxy(self._zoneDrop, self));\n                handler($(document), 'dragenter dragover drop', self._zoneDragDropInit);\n            }\n        },\n        _zoneDragDropInit: function (e) {\n            e.stopPropagation();\n            e.preventDefault();\n        },\n        _zoneDragEnter: function (e) {\n            var self = this, hasFiles = $.inArray('Files', e.originalEvent.dataTransfer.types) > -1;\n            self._zoneDragDropInit(e);\n            if (self.isDisabled || !hasFiles) {\n                e.originalEvent.dataTransfer.effectAllowed = 'none';\n                e.originalEvent.dataTransfer.dropEffect = 'none';\n                return;\n            }\n            addCss(self.$dropZone, 'file-highlighted');\n        },\n        _zoneDragLeave: function (e) {\n            var self = this;\n            self._zoneDragDropInit(e);\n            if (self.isDisabled) {\n                return;\n            }\n            self.$dropZone.removeClass('file-highlighted');\n        },\n        _zoneDrop: function (e) {\n            var self = this;\n            e.preventDefault();\n            /** @namespace e.originalEvent.dataTransfer */\n            if (self.isDisabled || isEmpty(e.originalEvent.dataTransfer.files)) {\n                return;\n            }\n            self._change(e, 'dragdrop');\n            self.$dropZone.removeClass('file-highlighted');\n        },\n        _uploadClick: function (e) {\n            var self = this, $btn = self.$container.find('.fileinput-upload'), $form,\n                isEnabled = !$btn.hasClass('disabled') && isEmpty($btn.attr('disabled'));\n            if (e && e.isDefaultPrevented()) {\n                return;\n            }\n            if (!self.isUploadable) {\n                if (isEnabled && $btn.attr('type') !== 'submit') {\n                    $form = $btn.closest('form');\n                    // downgrade to normal form submit if possible\n                    if ($form.length) {\n                        $form.trigger('submit');\n                    }\n                    e.preventDefault();\n                }\n                return;\n            }\n            e.preventDefault();\n            if (isEnabled) {\n                self.upload();\n            }\n        },\n        _submitForm: function () {\n            var self = this, $el = self.$element, files = $el.get(0).files;\n            if (files && self.minFileCount > 0 && self._getFileCount(files.length) < self.minFileCount) {\n                self._noFilesError({});\n                return false;\n            }\n            return !self._abort({});\n        },\n        _clearPreview: function () {\n            var self = this, $thumbs = !self.showUploadedThumbs ? self.$preview.find('.file-preview-frame') :\n                self.$preview.find('.file-preview-frame:not(.file-preview-success)');\n            $thumbs.remove();\n            if (!self.$preview.find('.file-preview-frame').length || !self.showPreview) {\n                self._resetUpload();\n            }\n            self._validateDefaultPreview();\n        },\n        _initSortable: function () {\n            var self = this, $preview = self.$preview, $el, settings;\n            if (!window.KvSortable) {\n                return;\n            }\n            $el = $preview.find('.file-initial-thumbs');\n            //noinspection JSUnusedGlobalSymbols\n            settings = {\n                handle: '.drag-handle-init',\n                dataIdAttr: 'data-preview-id',\n                draggable: '.file-preview-initial',\n                onSort: function (e) {\n                    var oldIndex = e.oldIndex, newIndex = e.newIndex;\n                    self.initialPreview = moveArray(self.initialPreview, oldIndex, newIndex);\n                    self.initialPreviewConfig = moveArray(self.initialPreviewConfig, oldIndex, newIndex);\n                    previewCache.init(self);\n                    self._raise('filesorted', {\n                        previewId: $(e.item).attr('id'),\n                        'oldIndex': oldIndex,\n                        'newIndex': newIndex,\n                        stack: self.initialPreviewConfig\n                    });\n                }\n            };\n            if ($el.data('kvsortable')) {\n                $el.kvsortable('destroy');\n            }\n            $.extend(true, settings, self.fileActionSettings.dragSettings);\n            $el.kvsortable(settings);\n        },\n        _initPreview: function (isInit) {\n            var self = this, cap = self.initialCaption || '', out;\n            if (!previewCache.count(self.id)) {\n                self._clearPreview();\n                if (isInit) {\n                    self._setCaption(cap);\n                } else {\n                    self._initCaption();\n                }\n                return;\n            }\n            out = previewCache.out(self.id);\n            cap = isInit && self.initialCaption ? self.initialCaption : out.caption;\n            self.$preview.html(out.content);\n            self._setCaption(cap);\n            self._initSortable();\n            if (!isEmpty(out.content)) {\n                self.$container.removeClass('file-input-new');\n            }\n        },\n        _getZoomButton: function (type) {\n            var self = this, label = self.previewZoomButtonIcons[type], css = self.previewZoomButtonClasses[type],\n                title = ' title=\"' + (self.previewZoomButtonTitles[type] || '') + '\" ',\n                params = title + (type === 'close' ? ' data-dismiss=\"modal\" aria-hidden=\"true\"' : '');\n            if (type === 'fullscreen' || type === 'borderless' || type === 'toggleheader') {\n                params += ' data-toggle=\"button\" aria-pressed=\"false\" autocomplete=\"off\"';\n            }\n            return '<button type=\"button\" class=\"' + css + ' btn-' + type + '\"' + params + '>' + label + '</button>';\n        },\n        _getModalContent: function () {\n            var self = this;\n            return self._getLayoutTemplate('modal')\n                .replace(/\\{heading}/g, self.msgZoomModalHeading)\n                .replace(/\\{prev}/g, self._getZoomButton('prev'))\n                .replace(/\\{next}/g, self._getZoomButton('next'))\n                .replace(/\\{toggleheader}/g, self._getZoomButton('toggleheader'))\n                .replace(/\\{fullscreen}/g, self._getZoomButton('fullscreen'))\n                .replace(/\\{borderless}/g, self._getZoomButton('borderless'))\n                .replace(/\\{close}/g, self._getZoomButton('close'));\n        },\n        _listenModalEvent: function (event) {\n            var self = this, $modal = self.$modal, getParams = function (e) {\n                return {\n                    sourceEvent: e,\n                    previewId: $modal.data('previewId'),\n                    modal: $modal\n                };\n            };\n            $modal.on(event + '.bs.modal', function (e) {\n                var $btnFull = $modal.find('.btn-fullscreen'), $btnBord = $modal.find('.btn-borderless');\n                self._raise('filezoom' + event, getParams(e));\n                if (event === 'shown') {\n                    $btnBord.removeClass('active').attr('aria-pressed', 'false');\n                    $btnFull.removeClass('active').attr('aria-pressed', 'false');\n                    if ($modal.hasClass('file-zoom-fullscreen')) {\n                        self._maximizeZoomDialog();\n                        if (checkFullScreen()) {\n                            $btnFull.addClass('active').attr('aria-pressed', 'true');\n                        } else {\n                            $btnBord.addClass('active').attr('aria-pressed', 'true');\n                        }\n                    }\n                }\n            });\n        },\n        _initZoom: function () {\n            var self = this, $dialog, modalMain = self._getLayoutTemplate('modalMain'), modalId = '#' + MODAL_ID;\n            self.$modal = $(modalId);\n            if (!self.$modal || !self.$modal.length) {\n                $dialog = $(document.createElement('div')).html(modalMain).insertAfter(self.$container);\n                self.$modal = $('#' + MODAL_ID).insertBefore($dialog);\n                $dialog.remove();\n            }\n            self.$modal.html(self._getModalContent());\n            self._listenModalEvent('show');\n            self._listenModalEvent('shown');\n            self._listenModalEvent('hide');\n            self._listenModalEvent('hidden');\n            self._listenModalEvent('loaded');\n        },\n        _initZoomButtons: function () {\n            var self = this, previewId = self.$modal.data('previewId') || '', $first, $last,\n                frames = self.$preview.find('.file-preview-frame').toArray(), len = frames.length,\n                $prev = self.$modal.find('.btn-prev'), $next = self.$modal.find('.btn-next');\n\n            if (!len) {\n                return;\n            }\n            $first = $(frames[0]);\n            $last = $(frames[len - 1]);\n            $prev.removeAttr('disabled');\n            $next.removeAttr('disabled');\n            if ($first.length && $first.attr('id') === previewId) {\n                $prev.attr('disabled', true);\n            }\n            if ($last.length && $last.attr('id') === previewId) {\n                $next.attr('disabled', true);\n            }\n        },\n        _maximizeZoomDialog: function () {\n            var self = this, $modal = self.$modal, $head = $modal.find('.modal-header:visible'),\n                $foot = $modal.find('.modal-footer:visible'), $body = $modal.find('.modal-body'),\n                h = $(window).height(), diff = 0;\n            $modal.addClass('file-zoom-fullscreen');\n            if ($head && $head.length) {\n                h -= $head.outerHeight(true);\n            }\n            if ($foot && $foot.length) {\n                h -= $foot.outerHeight(true);\n            }\n            if ($body && $body.length) {\n                diff = $body.outerHeight(true) - $body.height();\n                h -= diff;\n            }\n            $modal.find('.kv-zoom-body').height(h);\n        },\n        _resizeZoomDialog: function (fullScreen) {\n            var self = this, $modal = self.$modal, $btnFull = $modal.find('.btn-fullscreen'),\n                $btnBord = $modal.find('.btn-borderless');\n            if ($modal.hasClass('file-zoom-fullscreen')) {\n                toggleFullScreen(false);\n                if (!fullScreen) {\n                    if (!$btnFull.hasClass('active')) {\n                        $modal.removeClass('file-zoom-fullscreen');\n                        self.$modal.find('.kv-zoom-body').css('height', self.zoomModalHeight);\n                    } else {\n                        $btnFull.removeClass('active').attr('aria-pressed', 'false');\n                    }\n                } else {\n                    if (!$btnFull.hasClass('active')) {\n                        $modal.removeClass('file-zoom-fullscreen');\n                        self._resizeZoomDialog(true);\n                        if ($btnBord.hasClass('active')) {\n                            $btnBord.removeClass('active').attr('aria-pressed', 'false');\n                        }\n                    }\n                }\n            } else {\n                if (!fullScreen) {\n                    self._maximizeZoomDialog();\n                    return;\n                }\n                toggleFullScreen(true);\n            }\n            $modal.focus();\n        },\n        _setZoomContent: function ($preview, animate) {\n            var self = this, $content, tmplt, body, title, $body, $dataEl, config, previewId = $preview.attr('id'),\n                $modal = self.$modal, $prev = $modal.find('.btn-prev'), $next = $modal.find('.btn-next'), $tmp,\n                $btnFull = $modal.find('.btn-fullscreen'), $btnBord = $modal.find('.btn-borderless'),\n                $btnTogh = $modal.find('.btn-toggleheader');\n            tmplt = $preview.data('template') || 'generic';\n            $content = $preview.find('.kv-file-content');\n            body = $content.length ? $content.html() : '';\n            title = $preview.find('.file-footer-caption').text() || '';\n            $modal.find('.kv-zoom-title').html(title);\n            $body = $modal.find('.kv-zoom-body');\n            if (animate) {\n                $tmp = $body.clone().insertAfter($body);\n                $body.html(body).hide();\n                $tmp.fadeOut('fast', function () {\n                    $body.fadeIn('fast');\n                    $tmp.remove();\n                });\n            } else {\n                $body.html(body);\n            }\n            config = self.previewZoomSettings[tmplt];\n            if (config) {\n                $dataEl = $body.find('.kv-preview-data');\n                addCss($dataEl, 'file-zoom-detail');\n                $.each(config, function (key, value) {\n                    $dataEl.css(key, value);\n                    if (($dataEl.attr('width') && key === 'width') || ($dataEl.attr('height') && key === 'height')) {\n                        $dataEl.removeAttr(key);\n                    }\n                });\n            }\n            $modal.data('previewId', previewId);\n            handler($prev, 'click', function () {\n                self._zoomSlideShow('prev', previewId);\n            });\n            handler($next, 'click', function () {\n                self._zoomSlideShow('next', previewId);\n            });\n            handler($btnFull, 'click', function () {\n                self._resizeZoomDialog(true);\n            });\n            handler($btnBord, 'click', function () {\n                self._resizeZoomDialog(false);\n            });\n            handler($btnTogh, 'click', function () {\n                var $header = $modal.find('.modal-header'), $floatBar = $modal.find('.modal-body .floating-buttons'),\n                    ht, $actions = $header.find('.kv-zoom-actions'), resize = function (height) {\n                        var $body = self.$modal.find('.kv-zoom-body'), h = self.zoomModalHeight;\n                        if ($modal.hasClass('file-zoom-fullscreen')) {\n                            h = $body.outerHeight(true);\n                            if (!height) {\n                                h = h - $header.outerHeight(true);\n                            }\n                        }\n                        $body.css('height', height ? h + height : h);\n                    };\n                if ($header.is(':visible')) {\n                    ht = $header.outerHeight(true);\n                    $header.slideUp('slow', function () {\n                        $actions.find('.btn').appendTo($floatBar);\n                        resize(ht);\n                    });\n                } else {\n                    $floatBar.find('.btn').appendTo($actions);\n                    $header.slideDown('slow', function () {\n                        resize();\n                    });\n                }\n                $modal.focus();\n            });\n            handler($modal, 'keydown', function (e) {\n                var key = e.which || e.keyCode;\n                if (key === 37 && !$prev.attr('disabled')) {\n                    self._zoomSlideShow('prev', previewId);\n                }\n                if (key === 39 && !$next.attr('disabled')) {\n                    self._zoomSlideShow('next', previewId);\n                }\n            });\n        },\n        _zoomPreview: function ($btn) {\n            var self = this, $preview;\n            if (!$btn.length) {\n                throw 'Cannot zoom to detailed preview!';\n            }\n            self.$modal.html(self._getModalContent());\n            $preview = $btn.closest('.file-preview-frame');\n            self._setZoomContent($preview);\n            self.$modal.modal('show');\n            self._initZoomButtons();\n        },\n        _zoomSlideShow: function (dir, previewId) {\n            var self = this, $btn = self.$modal.find('.kv-zoom-actions .btn-' + dir), $targFrame, i,\n                frames = self.$preview.find('.file-preview-frame').toArray(), len = frames.length, out;\n            if ($btn.attr('disabled')) {\n                return;\n            }\n            for (i = 0; i < len; i++) {\n                if ($(frames[i]).attr('id') === previewId) {\n                    out = dir === 'prev' ? i - 1 : i + 1;\n                    break;\n                }\n            }\n            if (out < 0 || out >= len || !frames[out]) {\n                return;\n            }\n            $targFrame = $(frames[out]);\n            if ($targFrame.length) {\n                self._setZoomContent($targFrame, true);\n            }\n            self._initZoomButtons();\n            self._raise('filezoom' + dir, {'previewId': previewId, modal: self.$modal});\n        },\n        _initZoomButton: function () {\n            var self = this;\n            self.$preview.find('.kv-file-zoom').each(function () {\n                var $el = $(this);\n                handler($el, 'click', function () {\n                    self._zoomPreview($el);\n                });\n            });\n        },\n        _initPreviewActions: function () {\n            var self = this, deleteExtraData = self.deleteExtraData || {},\n                resetProgress = function () {\n                    var hasFiles = self.isUploadable ? previewCache.count(self.id) : self.$element.get(0).files.length;\n                    if (self.$preview.find('.kv-file-remove').length === 0 && !hasFiles) {\n                        self.reset();\n                        self.initialCaption = '';\n                    }\n                };\n            self._initZoomButton();\n            self.$preview.find('.kv-file-remove').each(function () {\n                var $el = $(this), vUrl = $el.data('url') || self.deleteUrl, vKey = $el.data('key');\n                if (isEmpty(vUrl) || vKey === undefined) {\n                    return;\n                }\n                var $frame = $el.closest('.file-preview-frame'), cache = previewCache.data[self.id],\n                    settings, params, index = $frame.data('fileindex'), config, extraData;\n                index = parseInt(index.replace('init_', ''));\n                config = isEmpty(cache.config) && isEmpty(cache.config[index]) ? null : cache.config[index];\n                extraData = isEmpty(config) || isEmpty(config.extra) ? deleteExtraData : config.extra;\n                if (typeof extraData === \"function\") {\n                    extraData = extraData();\n                }\n                params = {id: $el.attr('id'), key: vKey, extra: extraData};\n                settings = $.extend(true, {}, {\n                    url: vUrl,\n                    type: 'POST',\n                    dataType: 'json',\n                    data: $.extend(true, {}, {key: vKey}, extraData),\n                    beforeSend: function (jqXHR) {\n                        self.ajaxAborted = false;\n                        self._raise('filepredelete', [vKey, jqXHR, extraData]);\n                        if (self.ajaxAborted) {\n                            jqXHR.abort();\n                        } else {\n                            addCss($frame, 'file-uploading');\n                            addCss($el, 'disabled');\n                        }\n                    },\n                    success: function (data, textStatus, jqXHR) {\n                        var n, cap;\n                        if (isEmpty(data) || isEmpty(data.error)) {\n                            previewCache.unset(self.id, index);\n                            n = previewCache.count(self.id);\n                            cap = n > 0 ? self._getMsgSelected(n) : '';\n                            self._raise('filedeleted', [vKey, jqXHR, extraData]);\n                            self._setCaption(cap);\n                        } else {\n                            params.jqXHR = jqXHR;\n                            params.response = data;\n                            self._showError(data.error, params, 'filedeleteerror');\n                            $frame.removeClass('file-uploading');\n                            $el.removeClass('disabled');\n                            resetProgress();\n                            return;\n                        }\n                        $frame.removeClass('file-uploading').addClass('file-deleted');\n                        $frame.fadeOut('slow', function () {\n                            self._clearObjects($frame);\n                            $frame.remove();\n                            resetProgress();\n                            if (!n && self.getFileStack().length === 0) {\n                                self._setCaption('');\n                                self.reset();\n                            }\n                        });\n                    },\n                    error: function (jqXHR, textStatus, errorThrown) {\n                        var errMsg = self._parseError(jqXHR, errorThrown);\n                        params.jqXHR = jqXHR;\n                        params.response = {};\n                        self._showError(errMsg, params, 'filedeleteerror');\n                        $frame.removeClass('file-uploading');\n                        resetProgress();\n                    }\n                }, self.ajaxDeleteSettings);\n                handler($el, 'click', function () {\n                    if (!self._validateMinCount()) {\n                        return false;\n                    }\n                    $.ajax(settings);\n                });\n            });\n        },\n        _clearObjects: function ($el) {\n            $el.find('video audio').each(function () {\n                this.pause();\n                $(this).remove();\n            });\n            $el.find('img object div').each(function () {\n                $(this).remove();\n            });\n        },\n        _clearFileInput: function () {\n            var self = this, $el = self.$element, $srcFrm, $tmpFrm, $tmpEl;\n            if (isEmpty($el.val())) {\n                return;\n            }\n            // Fix for IE ver < 11, that does not clear file inputs. Requires a sequence of steps to prevent IE\n            // crashing but still allow clearing of the file input.\n            if (self.isIE9 || self.isIE10) {\n                $srcFrm = $el.closest('form');\n                $tmpFrm = $(document.createElement('form'));\n                $tmpEl = $(document.createElement('div'));\n                $el.before($tmpEl);\n                if ($srcFrm.length) {\n                    $srcFrm.after($tmpFrm);\n                } else {\n                    $tmpEl.after($tmpFrm);\n                }\n                $tmpFrm.append($el).trigger('reset');\n                $tmpEl.before($el).remove();\n                $tmpFrm.remove();\n            } else { // normal input clear behavior for other sane browsers\n                $el.val('');\n            }\n            self.fileInputCleared = true;\n        },\n        _resetUpload: function () {\n            var self = this;\n            self.uploadCache = {content: [], config: [], tags: [], append: true};\n            self.uploadCount = 0;\n            self.uploadStatus = {};\n            self.uploadLog = [];\n            self.uploadAsyncCount = 0;\n            self.loadedImages = [];\n            self.totalImagesCount = 0;\n            self.$btnUpload.removeAttr('disabled');\n            self._setProgress(0);\n            addCss(self.$progress, 'hide');\n            self._resetErrors(false);\n            self.ajaxAborted = false;\n            self.ajaxRequests = [];\n            self._resetCanvas();\n        },\n        _resetCanvas: function () {\n            var self = this;\n            if (self.canvas && self.imageCanvasContext) {\n                self.imageCanvasContext.clearRect(0, 0, self.canvas.width, self.canvas.height);\n            }\n        },\n        _hasInitialPreview: function () {\n            var self = this;\n            return !self.overwriteInitial && previewCache.count(self.id);\n        },\n        _resetPreview: function () {\n            var self = this, out, cap;\n            if (previewCache.count(self.id)) {\n                out = previewCache.out(self.id);\n                self.$preview.html(out.content);\n                cap = self.initialCaption ? self.initialCaption : out.caption;\n                self._setCaption(cap);\n            } else {\n                self._clearPreview();\n                self._initCaption();\n            }\n            if (self.showPreview) {\n                self._initZoom();\n                self._initSortable();\n            }\n        },\n        _clearDefaultPreview: function () {\n            var self = this;\n            self.$preview.find('.file-default-preview').remove();\n        },\n        _validateDefaultPreview: function () {\n            var self = this;\n            if (!self.showPreview || isEmpty(self.defaultPreviewContent)) {\n                return;\n            }\n            self.$preview.html('<div class=\"file-default-preview\">' + self.defaultPreviewContent + '</div>');\n            self.$container.removeClass('file-input-new');\n            self._initClickable();\n        },\n        _resetPreviewThumbs: function (isAjax) {\n            var self = this, out;\n            if (isAjax) {\n                self._clearPreview();\n                self.clearStack();\n                return;\n            }\n            if (self._hasInitialPreview()) {\n                out = previewCache.out(self.id);\n                self.$preview.html(out.content);\n                self._setCaption(out.caption);\n                self._initPreviewActions();\n            } else {\n                self._clearPreview();\n            }\n        },\n        _getLayoutTemplate: function (t) {\n            var self = this,\n                template = ifSet(t, self.layoutTemplates, defaultLayoutTemplates[t]);\n            if (isEmpty(self.customLayoutTags)) {\n                return template;\n            }\n            return replaceTags(template, self.customLayoutTags);\n        },\n        _getPreviewTemplate: function (t) {\n            var self = this,\n                template = ifSet(t, self.previewTemplates, defaultPreviewTemplates[t]);\n            if (isEmpty(self.customPreviewTags)) {\n                return template;\n            }\n            return replaceTags(template, self.customPreviewTags);\n        },\n        _getOutData: function (jqXHR, responseData, filesData) {\n            var self = this;\n            jqXHR = jqXHR || {};\n            responseData = responseData || {};\n            filesData = filesData || self.filestack.slice(0) || {};\n            return {\n                form: self.formdata,\n                files: filesData,\n                filenames: self.filenames,\n                filescount: self.getFilesCount(),\n                extra: self._getExtraData(),\n                response: responseData,\n                reader: self.reader,\n                jqXHR: jqXHR\n            };\n        },\n        _getMsgSelected: function (n) {\n            var self = this, strFiles = n === 1 ? self.fileSingle : self.filePlural;\n            return n > 0 ? self.msgSelected.replace('{n}', n).replace('{files}', strFiles) : self.msgNoFilesSelected;\n        },\n        _getThumbs: function (css) {\n            css = css || '';\n            return this.$preview.find('.file-preview-frame:not(.file-preview-initial)' + css);\n        },\n        _getExtraData: function (previewId, index) {\n            var self = this, data = self.uploadExtraData;\n            if (typeof self.uploadExtraData === \"function\") {\n                data = self.uploadExtraData(previewId, index);\n            }\n            return data;\n        },\n        _initXhr: function (xhrobj, previewId, fileCount) {\n            var self = this;\n            if (xhrobj.upload) {\n                xhrobj.upload.addEventListener('progress', function (event) {\n                    var pct = 0, total = event.total, position = event.loaded || event.position;\n                    /** @namespace event.lengthComputable */\n                    if (event.lengthComputable) {\n                        pct = Math.floor(position / total * 100);\n                    }\n                    if (previewId) {\n                        self._setAsyncUploadStatus(previewId, pct, fileCount);\n                    } else {\n                        self._setProgress(pct);\n                    }\n                }, false);\n            }\n            return xhrobj;\n        },\n        _ajaxSubmit: function (fnBefore, fnSuccess, fnComplete, fnError, previewId, index) {\n            var self = this, settings;\n            self._raise('filepreajax', [previewId, index]);\n            self._uploadExtra(previewId, index);\n            settings = $.extend(true, {}, {\n                xhr: function () {\n                    var xhrobj = $.ajaxSettings.xhr();\n                    return self._initXhr(xhrobj, previewId, self.getFileStack().length);\n                },\n                url: self.uploadUrl,\n                type: 'POST',\n                dataType: 'json',\n                data: self.formdata,\n                cache: false,\n                processData: false,\n                contentType: false,\n                beforeSend: fnBefore,\n                success: fnSuccess,\n                complete: fnComplete,\n                error: fnError\n            }, self.ajaxSettings);\n            self.ajaxRequests.push($.ajax(settings));\n        },\n        _initUploadSuccess: function (out, $thumb, allFiles) {\n            var self = this, append, data, index, $newThumb, content, config, tags, i,\n                mergeArray = function (prop, content) {\n                    if (!(self[prop] instanceof Array)) {\n                        self[prop] = [];\n                    }\n                    if (content && content.length) {\n                        self[prop] = self[prop].concat(content);\n                    }\n                };\n            if (!self.showPreview || typeof out !== 'object' || $.isEmptyObject(out)) {\n                return;\n            }\n            if (out.initialPreview !== undefined && out.initialPreview.length > 0) {\n                self.hasInitData = true;\n                content = out.initialPreview || [];\n                config = out.initialPreviewConfig || [];\n                tags = out.initialPreviewThumbTags || [];\n                append = out.append === undefined || out.append ? true : false;\n                if (content.length > 0 && !isArray(content)) {\n                    content = content.split(self.initialPreviewDelimiter);\n                }\n                self.overwriteInitial = false;\n                mergeArray('initialPreview', content);\n                mergeArray('initialPreviewConfig', config);\n                mergeArray('initialPreviewThumbTags', tags);\n                if ($thumb !== undefined) {\n                    if (!allFiles) {\n                        index = previewCache.add(self.id, content, config[0], tags[0], append);\n                        data = previewCache.get(self.id, index, false);\n                        $newThumb = $(data).hide();\n                        $thumb.after($newThumb).fadeOut('slow', function () {\n                            $newThumb.fadeIn('slow').css('display:inline-block');\n                            self._initPreviewActions();\n                            self._clearFileInput();\n                            $thumb.remove();\n                        });\n                    } else {\n                        i = $thumb.attr('data-fileindex');\n                        self.uploadCache.content[i] = content[0];\n                        self.uploadCache.config[i] = config[0] || [];\n                        self.uploadCache.tags[i] = tags[0] || [];\n                        self.uploadCache.append = append;\n                    }\n                } else {\n                    previewCache.set(self.id, content, config, tags, append);\n                    self._initPreview();\n                    self._initPreviewActions();\n                }\n            }\n        },\n        _initSuccessThumbs: function () {\n            var self = this;\n            if (!self.showPreview) {\n                return;\n            }\n            self._getThumbs('.file-preview-success').each(function () {\n                var $thumb = $(this), $remove = $thumb.find('.kv-file-remove');\n                $remove.removeAttr('disabled');\n                handler($remove, 'click', function () {\n                    var out = self._raise('filesuccessremove', [$thumb.attr('id'), $thumb.data('fileindex')]);\n                    cleanMemory($thumb);\n                    if (out === false) {\n                        return;\n                    }\n                    $thumb.fadeOut('slow', function () {\n                        $thumb.remove();\n                        if (!self.$preview.find('.file-preview-frame').length) {\n                            self.reset();\n                        }\n                    });\n                });\n            });\n        },\n        _checkAsyncComplete: function () {\n            var self = this, previewId, i;\n            for (i = 0; i < self.filestack.length; i++) {\n                if (self.filestack[i]) {\n                    previewId = self.previewInitId + \"-\" + i;\n                    if ($.inArray(previewId, self.uploadLog) === -1) {\n                        return false;\n                    }\n                }\n            }\n            return (self.uploadAsyncCount === self.uploadLog.length);\n        },\n        _uploadExtra: function (previewId, index) {\n            var self = this, data = self._getExtraData(previewId, index);\n            if (data.length === 0) {\n                return;\n            }\n            $.each(data, function (key, value) {\n                self.formdata.append(key, value);\n            });\n        },\n        _uploadSingle: function (i, files, allFiles) {\n            var self = this, total = self.getFileStack().length, formdata = new FormData(), outData,\n                previewId = self.previewInitId + \"-\" + i, $thumb, chkComplete, $btnUpload, $btnDelete,\n                hasPostData = self.filestack.length > 0 || !$.isEmptyObject(self.uploadExtraData),\n                fnBefore, fnSuccess, fnComplete, fnError, updateUploadLog, params = {id: previewId, index: i};\n            self.formdata = formdata;\n            if (self.showPreview) {\n                $thumb = $('#' + previewId + ':not(.file-preview-initial)');\n                $btnUpload = $thumb.find('.kv-file-upload');\n                $btnDelete = $thumb.find('.kv-file-remove');\n                $('#' + previewId).find('.file-thumb-progress').removeClass('hide');\n            }\n            if (total === 0 || !hasPostData || ($btnUpload && $btnUpload.hasClass('disabled')) || self._abort(params)) {\n                return;\n            }\n            updateUploadLog = function (i, previewId) {\n                self.updateStack(i, undefined);\n                self.uploadLog.push(previewId);\n                if (self._checkAsyncComplete()) {\n                    self.fileBatchCompleted = true;\n                }\n            };\n            chkComplete = function () {\n                var u = self.uploadCache;\n                if (!self.fileBatchCompleted) {\n                    return;\n                }\n                setTimeout(function () {\n                    if (self.showPreview) {\n                        previewCache.set(self.id, u.content, u.config, u.tags, u.append);\n                        if (self.hasInitData) {\n                            self._initPreview();\n                            self._initPreviewActions();\n                        }\n                    }\n                    self.unlock();\n                    self._clearFileInput();\n                    self._raise('filebatchuploadcomplete', [self.filestack, self._getExtraData()]);\n                    self.uploadCount = 0;\n                    self.uploadStatus = {};\n                    self.uploadLog = [];\n                    self._setProgress(101);\n                }, 100);\n            };\n            fnBefore = function (jqXHR) {\n                outData = self._getOutData(jqXHR);\n                self.fileBatchCompleted = false;\n                if (self.showPreview) {\n                    if (!$thumb.hasClass('file-preview-success')) {\n                        self._setThumbStatus($thumb, 'Loading');\n                        addCss($thumb, 'file-uploading');\n                    }\n                    $btnUpload.attr('disabled', true);\n                    $btnDelete.attr('disabled', true);\n                }\n                if (!allFiles) {\n                    self.lock();\n                }\n                self._raise('filepreupload', [outData, previewId, i]);\n                $.extend(true, params, outData);\n                if (self._abort(params)) {\n                    jqXHR.abort();\n                    self._setProgressCancelled();\n                }\n            };\n            fnSuccess = function (data, textStatus, jqXHR) {\n                var pid = self.showPreview && $thumb.attr('id') ? $thumb.attr('id') : previewId;\n                outData = self._getOutData(jqXHR, data);\n                $.extend(true, params, outData);\n                setTimeout(function () {\n                    if (isEmpty(data) || isEmpty(data.error)) {\n                        if (self.showPreview) {\n                            self._setThumbStatus($thumb, 'Success');\n                            $btnUpload.hide();\n                            self._initUploadSuccess(data, $thumb, allFiles);\n                        }\n                        self._raise('fileuploaded', [outData, pid, i]);\n                        if (!allFiles) {\n                            self.updateStack(i, undefined);\n                        } else {\n                            updateUploadLog(i, pid);\n                        }\n                    } else {\n                        self._showUploadError(data.error, params);\n                        self._setPreviewError($thumb, i);\n                        if (allFiles) {\n                            updateUploadLog(i, pid);\n                        }\n                    }\n                }, 100);\n            };\n            fnComplete = function () {\n                setTimeout(function () {\n                    if (self.showPreview) {\n                        $btnUpload.removeAttr('disabled');\n                        $btnDelete.removeAttr('disabled');\n                        $thumb.removeClass('file-uploading');\n                        self._setProgress(101, $('#' + previewId).find('.file-thumb-progress'));\n                    }\n                    if (!allFiles) {\n                        self.unlock(false);\n                        self._clearFileInput();\n                    } else {\n                        chkComplete();\n                    }\n                    self._initSuccessThumbs();\n                }, 100);\n            };\n            fnError = function (jqXHR, textStatus, errorThrown) {\n                var errMsg = self._parseError(jqXHR, errorThrown, (allFiles ? files[i].name : null));\n                setTimeout(function () {\n                    if (allFiles) {\n                        updateUploadLog(i, previewId);\n                    }\n                    self.uploadStatus[previewId] = 100;\n                    self._setPreviewError($thumb, i);\n                    $.extend(true, params, self._getOutData(jqXHR));\n                    self._showUploadError(errMsg, params);\n                }, 100);\n            };\n            formdata.append(self.uploadFileAttr, files[i], self.filenames[i]);\n            formdata.append('file_id', i);\n            self._ajaxSubmit(fnBefore, fnSuccess, fnComplete, fnError, previewId, i);\n        },\n        _uploadBatch: function () {\n            var self = this, files = self.filestack, total = files.length, params = {}, fnBefore, fnSuccess, fnError,\n                fnComplete, hasPostData = self.filestack.length > 0 || !$.isEmptyObject(self.uploadExtraData),\n                setAllUploaded;\n            self.formdata = new FormData();\n            if (total === 0 || !hasPostData || self._abort(params)) {\n                return;\n            }\n            setAllUploaded = function () {\n                $.each(files, function (key) {\n                    self.updateStack(key, undefined);\n                });\n                self._clearFileInput();\n            };\n            fnBefore = function (jqXHR) {\n                self.lock();\n                var outData = self._getOutData(jqXHR);\n                if (self.showPreview) {\n                    self._getThumbs().each(function () {\n                        var $thumb = $(this), $btnUpload = $thumb.find('.kv-file-upload'),\n                            $btnDelete = $thumb.find('.kv-file-remove');\n                        if (!$thumb.hasClass('file-preview-success')) {\n                            self._setThumbStatus($thumb, 'Loading');\n                            addCss($thumb, 'file-uploading');\n                        }\n                        $btnUpload.attr('disabled', true);\n                        $btnDelete.attr('disabled', true);\n                    });\n                }\n                self._raise('filebatchpreupload', [outData]);\n                if (self._abort(outData)) {\n                    jqXHR.abort();\n                    self._setProgressCancelled();\n                }\n            };\n            fnSuccess = function (data, textStatus, jqXHR) {\n                /** @namespace data.errorkeys */\n                var outData = self._getOutData(jqXHR, data), $thumbs = self._getThumbs(':not(.file-preview-error)'), key = 0,\n                    keys = isEmpty(data) || isEmpty(data.errorkeys) ? [] : data.errorkeys;\n                if (isEmpty(data) || isEmpty(data.error)) {\n                    self._raise('filebatchuploadsuccess', [outData]);\n                    setAllUploaded();\n                    if (self.showPreview) {\n                        $thumbs.each(function () {\n                            var $thumb = $(this), $btnUpload = $thumb.find('.kv-file-upload');\n                            $thumb.find('.kv-file-upload').hide();\n                            self._setThumbStatus($thumb, 'Success');\n                            $thumb.removeClass('file-uploading');\n                            $btnUpload.removeAttr('disabled');\n                        });\n                        self._initUploadSuccess(data);\n                    } else {\n                        self.reset();\n                    }\n                } else {\n                    if (self.showPreview) {\n                        $thumbs.each(function () {\n                            var $thumb = $(this), $btnDelete = $thumb.find('.kv-file-remove'),\n                                $btnUpload = $thumb.find('.kv-file-upload');\n                            $thumb.removeClass('file-uploading');\n                            $btnUpload.removeAttr('disabled');\n                            $btnDelete.removeAttr('disabled');\n                            if (keys.length === 0) {\n                                self._setPreviewError($thumb);\n                                return;\n                            }\n                            if ($.inArray(key, keys) !== -1) {\n                                self._setPreviewError($thumb);\n                            } else {\n                                $thumb.find('.kv-file-upload').hide();\n                                self._setThumbStatus($thumb, 'Success');\n                                self.updateStack(key, undefined);\n                            }\n                            key++;\n                        });\n                        self._initUploadSuccess(data);\n                    }\n                    self._showUploadError(data.error, outData, 'filebatchuploaderror');\n                }\n            };\n            fnComplete = function () {\n                self._setProgress(101);\n                self.unlock();\n                self._initSuccessThumbs();\n                self._clearFileInput();\n                self._raise('filebatchuploadcomplete', [self.filestack, self._getExtraData()]);\n            };\n            fnError = function (jqXHR, textStatus, errorThrown) {\n                var outData = self._getOutData(jqXHR), errMsg = self._parseError(jqXHR, errorThrown);\n                self._showUploadError(errMsg, outData, 'filebatchuploaderror');\n                self.uploadFileCount = total - 1;\n                if (!self.showPreview) {\n                    return;\n                }\n                self._getThumbs().each(function () {\n                    var $thumb = $(this), key = $thumb.attr('data-fileindex');\n                    $thumb.removeClass('file-uploading');\n                    if (self.filestack[key] !== undefined) {\n                        self._setPreviewError($thumb);\n                    }\n                });\n                self._getThumbs().removeClass('file-uploading');\n                self._getThumbs(' .kv-file-upload').removeAttr('disabled');\n                self._getThumbs(' .kv-file-delete').removeAttr('disabled');\n            };\n            $.each(files, function (key, data) {\n                if (!isEmpty(files[key])) {\n                    self.formdata.append(self.uploadFileAttr, data, self.filenames[key]);\n                }\n            });\n            self._ajaxSubmit(fnBefore, fnSuccess, fnComplete, fnError);\n        },\n        _uploadExtraOnly: function () {\n            var self = this, params = {}, fnBefore, fnSuccess, fnComplete, fnError;\n            self.formdata = new FormData();\n            if (self._abort(params)) {\n                return;\n            }\n            fnBefore = function (jqXHR) {\n                self.lock();\n                var outData = self._getOutData(jqXHR);\n                self._raise('filebatchpreupload', [outData]);\n                self._setProgress(50);\n                params.data = outData;\n                params.xhr = jqXHR;\n                if (self._abort(params)) {\n                    jqXHR.abort();\n                    self._setProgressCancelled();\n                }\n            };\n            fnSuccess = function (data, textStatus, jqXHR) {\n                var outData = self._getOutData(jqXHR, data);\n                if (isEmpty(data) || isEmpty(data.error)) {\n                    self._raise('filebatchuploadsuccess', [outData]);\n                    self._clearFileInput();\n                    self._initUploadSuccess(data);\n                } else {\n                    self._showUploadError(data.error, outData, 'filebatchuploaderror');\n                }\n            };\n            fnComplete = function () {\n                self._setProgress(101);\n                self.unlock();\n                self._clearFileInput();\n                self._raise('filebatchuploadcomplete', [self.filestack, self._getExtraData()]);\n            };\n            fnError = function (jqXHR, textStatus, errorThrown) {\n                var outData = self._getOutData(jqXHR), errMsg = self._parseError(jqXHR, errorThrown);\n                params.data = outData;\n                self._showUploadError(errMsg, outData, 'filebatchuploaderror');\n            };\n            self._ajaxSubmit(fnBefore, fnSuccess, fnComplete, fnError);\n        },\n        _initFileActions: function () {\n            var self = this;\n            if (!self.showPreview) {\n                return;\n            }\n            self._initZoomButton();\n            self.$preview.find('.kv-file-remove').each(function () {\n                var $el = $(this), $frame = $el.closest('.file-preview-frame'), hasError,\n                    id = $frame.attr('id'), ind = $frame.attr('data-fileindex'), n, cap, status;\n                handler($el, 'click', function () {\n                    status = self._raise('filepreremove', [id, ind]);\n                    if (status === false || !self._validateMinCount()) {\n                        return false;\n                    }\n                    hasError = $frame.hasClass('file-preview-error');\n                    cleanMemory($frame);\n                    $frame.fadeOut('slow', function () {\n                        self.updateStack(ind, undefined);\n                        self._clearObjects($frame);\n                        $frame.remove();\n                        if (id && hasError) {\n                            self.$errorContainer.find('li[data-file-id=\"' + id + '\"]').fadeOut('fast', function () {\n                                $(this).remove();\n                                if (!self._errorsExist()) {\n                                    self._resetErrors();\n                                }\n                            });\n                        }\n                        self._clearFileInput();\n                        var filestack = self.getFileStack(true), chk = previewCache.count(self.id),\n                            len = filestack.length,\n                            hasThumb = self.showPreview && self.$preview.find('.file-preview-frame').length;\n                        if (len === 0 && chk === 0 && !hasThumb) {\n                            self.reset();\n                        } else {\n                            n = chk + len;\n                            cap = n > 1 ? self._getMsgSelected(n) : (filestack[0] ? self._getFileNames()[0] : '');\n                            self._setCaption(cap);\n                        }\n                        self._raise('fileremoved', [id, ind]);\n                    });\n                });\n            });\n            self.$preview.find('.kv-file-upload').each(function () {\n                var $el = $(this);\n                handler($el, 'click', function () {\n                    var $frame = $el.closest('.file-preview-frame'),\n                        ind = $frame.attr('data-fileindex');\n                    if (!$frame.hasClass('file-preview-error')) {\n                        self._uploadSingle(ind, self.filestack, false);\n                    }\n                });\n            });\n        },\n        _hideFileIcon: function () {\n            if (this.overwriteInitial) {\n                this.$captionContainer.find('.kv-caption-icon').hide();\n            }\n        },\n        _showFileIcon: function () {\n            this.$captionContainer.find('.kv-caption-icon').show();\n        },\n        _getSize: function (bytes) {\n            var size = parseFloat(bytes);\n            if (bytes === null || isNaN(size)) {\n                return '';\n            }\n            var self = this, i, func = self.fileSizeGetter, sizes, out;\n            if (typeof func === 'function') {\n                out = func(bytes);\n            } else {\n                i = Math.floor(Math.log(size) / Math.log(1024));\n                sizes = ['B', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n                out = (size / Math.pow(1024, i)).toFixed(2) * 1 + ' ' + sizes[i];\n            }\n            return self._getLayoutTemplate('size').replace('{sizeText}', out);\n        },\n        _generatePreviewTemplate: function (cat, data, fname, ftype, previewId, isError, size, frameClass, foot, ind) {\n            var self = this, tmplt = self._getPreviewTemplate(cat), content, sText, css = frameClass || '',\n                config = ifSet(cat, self.previewSettings, defaultPreviewSettings[cat]), caption = self.slug(fname),\n                footer = foot || self._renderFileFooter(caption, size, config.width, isError);\n            ind = ind || previewId.slice(previewId.lastIndexOf('-') + 1);\n            tmplt = self._parseFilePreviewIcon(tmplt, fname);\n            if (cat === 'text' || cat === 'html') {\n                sText = cat === 'text' ? htmlEncode(data) : data;\n                content = tmplt.replace(/\\{previewId}/g, previewId).replace(/\\{caption}/g, caption)\n                    .replace(/\\{width}/g, config.width).replace(/\\{height}/g, config.height)\n                    .replace(/\\{frameClass}/g, css).replace(/\\{cat}/g, ftype)\n                    .replace(/\\{footer}/g, footer).replace(/\\{fileindex}/g, ind)\n                    .replace(/\\{data}/g, sText).replace(/\\{template}/g, cat);\n            } else {\n                content = tmplt.replace(/\\{previewId}/g, previewId).replace(/\\{caption}/g, caption)\n                    .replace(/\\{frameClass}/g, css).replace(/\\{type}/g, ftype).replace(/\\{fileindex}/g, ind)\n                    .replace(/\\{width}/g, config.width).replace(/\\{height}/g, config.height)\n                    .replace(/\\{footer}/g, footer).replace(/\\{data}/g, data).replace(/\\{template}/g, cat);\n            }\n            return content;\n        },\n        _previewDefault: function (file, previewId, isDisabled) {\n            var self = this, $preview = self.$preview, $previewLive = $preview.find('.file-live-thumbs');\n            if (!self.showPreview) {\n                return;\n            }\n            var fname = file ? file.name : '', ftype = file ? file.type : '', content,\n                isError = isDisabled === true && !self.isUploadable, data = objUrl.createObjectURL(file);\n            self._clearDefaultPreview();\n            content = self._generatePreviewTemplate('other', data, fname, ftype, previewId, isError, file.size);\n            if (!$previewLive.length) {\n                $previewLive = $(document.createElement('div')).addClass('file-live-thumbs').appendTo($preview);\n            }\n            $previewLive.append(\"\\n\" + content);\n            if (isDisabled === true && self.isUploadable) {\n                self._setThumbStatus($('#' + previewId), 'Error');\n            }\n        },\n        _previewFile: function (i, file, theFile, previewId, data) {\n            if (!this.showPreview) {\n                return;\n            }\n            var self = this, cat = self._parseFileType(file), fname = file ? file.name : '', caption = self.slug(fname),\n                types = self.allowedPreviewTypes, mimes = self.allowedPreviewMimeTypes, $preview = self.$preview,\n                chkTypes = types && types.indexOf(cat) >= 0, $previewLive = $preview.find('.file-live-thumbs'),\n                iData = (cat === 'text' || cat === 'html' || cat === 'image') ? theFile.target.result : data, content,\n                chkMimes = mimes && mimes.indexOf(file.type) !== -1;\n            if (!$previewLive.length) {\n                $previewLive = $(document.createElement('div')).addClass('file-live-thumbs').appendTo($preview);\n            }\n            /** @namespace window.DOMPurify */\n            if (cat === 'html' && self.purifyHtml && window.DOMPurify) {\n                iData = window.DOMPurify.sanitize(iData);\n            }\n            if (chkTypes || chkMimes) {\n                content = self._generatePreviewTemplate(cat, iData, fname, file.type, previewId, false, file.size);\n                self._clearDefaultPreview();\n                $previewLive.append(\"\\n\" + content);\n                self._validateImage(i, previewId, caption, file.type);\n            } else {\n                self._previewDefault(file, previewId);\n            }\n            self._initSortable();\n        },\n        _slugDefault: function (text) {\n            return isEmpty(text) ? '' : String(text).replace(/[\\-\\[\\]\\/\\{}:;#%=\\(\\)\\*\\+\\?\\\\\\^\\$\\|<>&\"']/g, '_');\n        },\n        _readFiles: function (files) {\n            this.reader = new FileReader();\n            var self = this, $el = self.$element, $preview = self.$preview, reader = self.reader,\n                $container = self.$previewContainer, $status = self.$previewStatus, msgLoading = self.msgLoading,\n                msgProgress = self.msgProgress, previewInitId = self.previewInitId, numFiles = files.length,\n                settings = self.fileTypeSettings, ctr = self.filestack.length, readFile,\n                maxPreviewSize = self.maxFilePreviewSize && parseFloat(self.maxFilePreviewSize),\n                canPreview = $preview.length && (!maxPreviewSize || isNaN(maxPreviewSize)),\n                throwError = function (msg, file, previewId, index) {\n                    var p1 = $.extend(true, {}, self._getOutData({}, {}, files), {id: previewId, index: index}),\n                        p2 = {id: previewId, index: index, file: file, files: files};\n                    self._previewDefault(file, previewId, true);\n                    if (self.isUploadable) {\n                        self.addToStack(undefined);\n                    }\n                    setTimeout(function () {\n                        readFile(index + 1);\n                    }, 100);\n                    self._initFileActions();\n                    if (self.removeFromPreviewOnError) {\n                        $('#' + previewId).remove();\n                    }\n                    return self.isUploadable ? self._showUploadError(msg, p1) : self._showError(msg, p2);\n                };\n\n            self.loadedImages = [];\n            self.totalImagesCount = 0;\n\n            $.each(files, function (key, file) {\n                var func = self.fileTypeSettings.image || defaultFileTypeSettings.image;\n                if (func && func(file.type)) {\n                    self.totalImagesCount++;\n                }\n            });\n            readFile = function (i) {\n                if (isEmpty($el.attr('multiple'))) {\n                    numFiles = 1;\n                }\n                if (i >= numFiles) {\n                    if (self.isUploadable && self.filestack.length > 0) {\n                        self._raise('filebatchselected', [self.getFileStack()]);\n                    } else {\n                        self._raise('filebatchselected', [files]);\n                    }\n                    $container.removeClass('file-thumb-loading');\n                    $status.html('');\n                    return;\n                }\n                var node = ctr + i, previewId = previewInitId + \"-\" + node, isText, isImage, file = files[i],\n                    caption = self.slug(file.name), fileSize = (file.size || 0) / 1000, checkFile, fileExtExpr = '',\n                    previewData = objUrl.createObjectURL(file), fileCount = 0, j, msg, typ, chk,\n                    fileTypes = self.allowedFileTypes, strTypes = isEmpty(fileTypes) ? '' : fileTypes.join(', '),\n                    fileExt = self.allowedFileExtensions, strExt = isEmpty(fileExt) ? '' : fileExt.join(', ');\n                if (!isEmpty(fileExt)) {\n                    fileExtExpr = new RegExp('\\\\.(' + fileExt.join('|') + ')$', 'i');\n                }\n                fileSize = fileSize.toFixed(2);\n                if (self.maxFileSize > 0 && fileSize > self.maxFileSize) {\n                    msg = self.msgSizeTooLarge.replace('{name}', caption)\n                        .replace('{size}', fileSize)\n                        .replace('{maxSize}', self.maxFileSize);\n                    self.isError = throwError(msg, file, previewId, i);\n                    return;\n                }\n                if (!isEmpty(fileTypes) && isArray(fileTypes)) {\n                    for (j = 0; j < fileTypes.length; j += 1) {\n                        typ = fileTypes[j];\n                        checkFile = settings[typ];\n                        chk = (checkFile !== undefined && checkFile(file.type, caption));\n                        fileCount += isEmpty(chk) ? 0 : chk.length;\n                    }\n                    if (fileCount === 0) {\n                        msg = self.msgInvalidFileType.replace('{name}', caption).replace('{types}', strTypes);\n                        self.isError = throwError(msg, file, previewId, i);\n                        return;\n                    }\n                }\n                if (fileCount === 0 && !isEmpty(fileExt) && isArray(fileExt) && !isEmpty(fileExtExpr)) {\n                    chk = compare(caption, fileExtExpr);\n                    fileCount += isEmpty(chk) ? 0 : chk.length;\n                    if (fileCount === 0) {\n                        msg = self.msgInvalidFileExtension.replace('{name}', caption).replace('{extensions}',\n                            strExt);\n                        self.isError = throwError(msg, file, previewId, i);\n                        return;\n                    }\n                }\n                if (!self.showPreview) {\n                    self.addToStack(file);\n                    setTimeout(function () {\n                        readFile(i + 1);\n                    }, 100);\n                    self._raise('fileloaded', [file, previewId, i, reader]);\n                    return;\n                }\n                if (!canPreview && fileSize > maxPreviewSize) {\n                    self.addToStack(file);\n                    $container.addClass('file-thumb-loading');\n                    self._previewDefault(file, previewId);\n                    self._initFileActions();\n                    self._updateFileDetails(numFiles);\n                    readFile(i + 1);\n                    return;\n                }\n                if ($preview.length && FileReader !== undefined) {\n                    $status.html(msgLoading.replace('{index}', i + 1).replace('{files}', numFiles));\n                    $container.addClass('file-thumb-loading');\n                    reader.onerror = function (evt) {\n                        self._errorHandler(evt, caption);\n                    };\n                    reader.onload = function (theFile) {\n                        self._previewFile(i, file, theFile, previewId, previewData);\n                        self._initFileActions();\n                    };\n                    reader.onloadend = function () {\n                        msg = msgProgress.replace('{index}', i + 1).replace('{files}', numFiles)\n                            .replace('{percent}', 50).replace('{name}', caption);\n                        setTimeout(function () {\n                            $status.html(msg);\n                            self._updateFileDetails(numFiles);\n                            readFile(i + 1);\n                        }, 100);\n                        self._raise('fileloaded', [file, previewId, i, reader]);\n                    };\n                    reader.onprogress = function (data) {\n                        if (data.lengthComputable) {\n                            var fact = (data.loaded / data.total) * 100, progress = Math.ceil(fact);\n                            msg = msgProgress.replace('{index}', i + 1).replace('{files}', numFiles)\n                                .replace('{percent}', progress).replace('{name}', caption);\n                            setTimeout(function () {\n                                $status.html(msg);\n                            }, 100);\n                        }\n                    };\n                    isText = ifSet('text', settings, defaultFileTypeSettings.text);\n                    isImage = ifSet('image', settings, defaultFileTypeSettings.image);\n\n                    if (isText(file.type, caption)) {\n                        reader.readAsText(file, self.textEncoding);\n                    } else {\n                        if (isImage(file.type, caption)) {\n                            reader.readAsDataURL(file);\n                        } else {\n                            reader.readAsArrayBuffer(file);\n                        }\n                    }\n                } else {\n                    self._previewDefault(file, previewId);\n                    setTimeout(function () {\n                        readFile(i + 1);\n                        self._updateFileDetails(numFiles);\n                    }, 100);\n                    self._raise('fileloaded', [file, previewId, i, reader]);\n                }\n                self.addToStack(file);\n            };\n\n            readFile(0);\n            self._updateFileDetails(numFiles, false);\n        },\n        _updateFileDetails: function (numFiles) {\n            var self = this, $el = self.$element, fileStack = self.getFileStack(),\n                name = (isIE(9) && findFileName($el.val())) ||\n                    ($el[0].files[0] && $el[0].files[0].name) || (fileStack.length && fileStack[0].name) || '',\n                label = self.slug(name), n = self.isUploadable ? fileStack.length : numFiles,\n                nFiles = previewCache.count(self.id) + n, log = n > 1 ? self._getMsgSelected(nFiles) : label;\n            if (self.isError) {\n                self.$previewContainer.removeClass('file-thumb-loading');\n                self.$previewStatus.html('');\n                self.$captionContainer.find('.kv-caption-icon').hide();\n            } else {\n                self._showFileIcon();\n            }\n            self._setCaption(log, self.isError);\n            self.$container.removeClass('file-input-new file-input-ajax-new');\n            if (arguments.length === 1) {\n                self._raise('fileselect', [numFiles, label]);\n            }\n            if (previewCache.count(self.id)) {\n                self._initPreviewActions();\n            }\n        },\n        _setThumbStatus: function ($thumb, status) {\n            var self = this;\n            if (!self.showPreview) {\n                return;\n            }\n            var icon = 'indicator' + status, msg = icon + 'Title',\n                css = 'file-preview-' + status.toLowerCase(),\n                $indicator = $thumb.find('.file-upload-indicator'),\n                config = self.fileActionSettings;\n            $thumb.removeClass('file-preview-success file-preview-error file-preview-loading');\n            if (status === 'Error') {\n                $thumb.find('.kv-file-upload').attr('disabled', true);\n            }\n            if (status === 'Success') {\n                $thumb.find('.file-drag-handle').remove();\n                $indicator.css('margin-left', 0);\n            }\n            $indicator.html(config[icon]);\n            $indicator.attr('title', config[msg]);\n            $thumb.addClass(css);\n        },\n        _setProgressCancelled: function () {\n            var self = this;\n            self._setProgress(101, self.$progress, self.msgCancelled);\n        },\n        _setProgress: function (p, $el, error) {\n            var self = this, pct = Math.min(p, 100), template = pct < 100 ? self.progressTemplate :\n                    (error ? self.progressErrorTemplate : (p <= 100 ? self.progressTemplate : self.progressCompleteTemplate)),\n                pctLimit = self.progressUploadThreshold;\n            $el = $el || self.$progress;\n            if (!isEmpty(template)) {\n                if (pctLimit && pct > pctLimit && p <= 100) {\n                    var out = template.replace('{percent}', pctLimit).replace('{percent}', pctLimit).replace('{percent}%', self.msgUploadThreshold);\n                    $el.html(out);\n                } else {\n                    $el.html(template.replace(/\\{percent}/g, pct));\n                }\n                if (error) {\n                    $el.find('[role=\"progressbar\"]').html(error);\n                }\n            }\n        },\n        _setFileDropZoneTitle: function () {\n            var self = this, $zone = self.$container.find('.file-drop-zone'), title = self.dropZoneTitle, strFiles;\n            if (self.isClickable) {\n                strFiles = isEmpty(self.$element.attr('multiple')) ? self.fileSingle : self.filePlural;\n                title += self.dropZoneClickTitle.replace('{files}', strFiles);\n            }\n            $zone.find('.' + self.dropZoneTitleClass).remove();\n            if (!self.isUploadable || !self.showPreview || $zone.length === 0 || self.getFileStack().length > 0 || !self.dropZoneEnabled) {\n                return;\n            }\n            if ($zone.find('.file-preview-frame').length === 0 && isEmpty(self.defaultPreviewContent)) {\n                $zone.prepend('<div class=\"' + self.dropZoneTitleClass + '\">' + title + '</div>');\n            }\n            self.$container.removeClass('file-input-new');\n            addCss(self.$container, 'file-input-ajax-new');\n        },\n        _setAsyncUploadStatus: function (previewId, pct, total) {\n            var self = this, sum = 0;\n            self._setProgress(pct, $('#' + previewId).find('.file-thumb-progress'));\n            self.uploadStatus[previewId] = pct;\n            $.each(self.uploadStatus, function (key, value) {\n                sum += value;\n            });\n            self._setProgress(Math.floor(sum / total));\n\n        },\n        _validateMinCount: function () {\n            var self = this, len = self.isUploadable ? self.getFileStack().length : self.$element.get(0).files.length;\n            if (self.validateInitialCount && self.minFileCount > 0 && self._getFileCount(len - 1) < self.minFileCount) {\n                self._noFilesError({});\n                return false;\n            }\n            return true;\n        },\n        _getFileCount: function (fileCount) {\n            var self = this, addCount = 0;\n            if (self.validateInitialCount && !self.overwriteInitial) {\n                addCount = previewCache.count(self.id);\n                fileCount += addCount;\n            }\n            return fileCount;\n        },\n        _getFileName: function (file) {\n            return file && file.name ? this.slug(file.name) : undefined;\n        },\n        _getFileNames: function (skipNull) {\n            var self = this;\n            return self.filenames.filter(function (n) {\n                return (skipNull ? n !== undefined : n !== undefined && n !== null);\n            });\n        },\n        _setPreviewError: function ($thumb, i, val) {\n            var self = this;\n            if (i !== undefined) {\n                self.updateStack(i, val);\n            }\n            if (self.removeFromPreviewOnError) {\n                $thumb.remove();\n            } else {\n                self._setThumbStatus($thumb, 'Error');\n            }\n        },\n        _checkDimensions: function (i, chk, $img, $thumb, fname, type, params) {\n            var self = this, msg, dim, tag = chk === 'Small' ? 'min' : 'max', limit = self[tag + 'Image' + type],\n                $imgEl, isValid;\n            if (isEmpty(limit) || !$img.length) {\n                return;\n            }\n            $imgEl = $img[0];\n            dim = (type === 'Width') ? $imgEl.naturalWidth || $imgEl.width : $imgEl.naturalHeight || $imgEl.height;\n            isValid = chk === 'Small' ? dim >= limit : dim <= limit;\n            if (isValid) {\n                return;\n            }\n            msg = self['msgImage' + type + chk].replace('{name}', fname).replace('{size}', limit);\n            self._showUploadError(msg, params);\n            self._setPreviewError($thumb, i, null);\n        },\n        _validateImage: function (i, previewId, fname, ftype) {\n            var self = this, $preview = self.$preview, params, w1, w2,\n                $thumb = $preview.find(\"#\" + previewId), $img = $thumb.find('img');\n            fname = fname || 'Untitled';\n            if (!$img.length) {\n                return;\n            }\n            handler($img, 'load', function () {\n                w1 = $thumb.width();\n                w2 = $preview.width();\n                if (w1 > w2) {\n                    $img.css('width', '100%');\n                    $thumb.css('width', '97%');\n                }\n                params = {ind: i, id: previewId};\n                self._checkDimensions(i, 'Small', $img, $thumb, fname, 'Width', params);\n                self._checkDimensions(i, 'Small', $img, $thumb, fname, 'Height', params);\n                if (!self.resizeImage) {\n                    self._checkDimensions(i, 'Large', $img, $thumb, fname, 'Width', params);\n                    self._checkDimensions(i, 'Large', $img, $thumb, fname, 'Height', params);\n                }\n                self._raise('fileimageloaded', [previewId]);\n                self.loadedImages.push({ind: i, img: $img, thumb: $thumb, pid: previewId, typ: ftype});\n                self._validateAllImages();\n                objUrl.revokeObjectURL($img.attr('src'));\n            });\n        },\n        _validateAllImages: function () {\n            var self = this, i, config, $img, $thumb, pid, ind, params = {}, errFunc;\n            if (self.loadedImages.length !== self.totalImagesCount) {\n                return;\n            }\n            self._raise('fileimagesloaded');\n            if (!self.resizeImage) {\n                return;\n            }\n            errFunc = self.isUploadable ? self._showUploadError : self._showError;\n            for (i = 0; i < self.loadedImages.length; i++) {\n                config = self.loadedImages[i];\n                $img = config.img;\n                $thumb = config.thumb;\n                pid = config.pid;\n                ind = config.ind;\n                params = {id: pid, 'index': ind};\n                if (!self._getResizedImage($img[0], config.typ, pid, ind)) {\n                    errFunc(self.msgImageResizeError, params, 'fileimageresizeerror');\n                    self._setPreviewError($thumb, ind);\n                }\n            }\n            self._raise('fileimagesresized');\n        },\n        _getResizedImage: function (image, type, pid, ind) {\n            var self = this, width = image.naturalWidth, height = image.naturalHeight, ratio = 1,\n                maxWidth = self.maxImageWidth || width, maxHeight = self.maxImageHeight || height,\n                isValidImage = (width && height), chkWidth, chkHeight,\n                canvas = self.imageCanvas, context = self.imageCanvasContext;\n            if (!isValidImage) {\n                return false;\n            }\n            if (width === maxWidth && height === maxHeight) {\n                return true;\n            }\n            type = type || self.resizeDefaultImageType;\n            chkWidth = width > maxWidth;\n            chkHeight = height > maxHeight;\n            if (self.resizePreference === 'width') {\n                ratio = chkWidth ? maxWidth / width : (chkHeight ? maxHeight / height : 1);\n            } else {\n                ratio = chkHeight ? maxHeight / height : (chkWidth ? maxWidth / width : 1);\n            }\n            self._resetCanvas();\n            width *= ratio;\n            height *= ratio;\n            canvas.width = width;\n            canvas.height = height;\n            try {\n                context.drawImage(image, 0, 0, width, height);\n                canvas.toBlob(function (blob) {\n                    self._raise('fileimageresized', [pid, ind]);\n                    self.filestack[ind] = blob;\n                }, type, self.resizeQuality);\n                return true;\n            }\n            catch (err) {\n                return false;\n            }\n        },\n        _initBrowse: function ($container) {\n            var self = this;\n            if (self.showBrowse) {\n                self.$btnFile = $container.find('.btn-file');\n                self.$btnFile.append(self.$element);\n            } else {\n                self.$element.hide();\n            }\n        },\n        _initCaption: function () {\n            var self = this, cap = self.initialCaption || '';\n            if (self.overwriteInitial || isEmpty(cap)) {\n                self.$caption.html('');\n                return false;\n            }\n            self._setCaption(cap);\n            return true;\n        },\n        _setCaption: function (content, isError) {\n            var self = this, title, out, n, cap, stack = self.getFileStack();\n            if (!self.$caption.length) {\n                return;\n            }\n            if (isError) {\n                title = $('<div>' + self.msgValidationError + '</div>').text();\n                n = stack.length;\n                if (n) {\n                    cap = n === 1 && stack[0] ? self._getFileNames()[0] : self._getMsgSelected(n);\n                } else {\n                    cap = self._getMsgSelected(self.msgNo);\n                }\n                out = '<span class=\"' + self.msgValidationErrorClass + '\">' + self.msgValidationErrorIcon +\n                    (isEmpty(content) ? cap : content) + '</span>';\n            } else {\n                if (isEmpty(content)) {\n                    return;\n                }\n                title = $('<div>' + content + '</div>').text();\n                out = self._getLayoutTemplate('fileIcon') + title;\n            }\n            self.$caption.html(out);\n            self.$caption.attr('title', title);\n            self.$captionContainer.find('.file-caption-ellipsis').attr('title', title);\n        },\n        _createContainer: function () {\n            var self = this, $container = $(document.createElement(\"div\"))\n                .attr({\"class\": 'file-input file-input-new'})\n                .html(self._renderMain());\n            self.$element.before($container);\n            self._initBrowse($container);\n            if (self.theme) {\n                $container.addClass('theme-' + self.theme);\n            }\n            return $container;\n        },\n        _refreshContainer: function () {\n            var self = this, $container = self.$container;\n            $container.before(self.$element);\n            $container.html(self._renderMain());\n            self._initBrowse($container);\n        },\n        _renderMain: function () {\n            var self = this, dropCss = (self.isUploadable && self.dropZoneEnabled) ? ' file-drop-zone' : 'file-drop-disabled',\n                close = !self.showClose ? '' : self._getLayoutTemplate('close'),\n                preview = !self.showPreview ? '' : self._getLayoutTemplate('preview')\n                    .replace(/\\{class}/g, self.previewClass)\n                    .replace(/\\{dropClass}/g, dropCss),\n                css = self.isDisabled ? self.captionClass + ' file-caption-disabled' : self.captionClass,\n                caption = self.captionTemplate.replace(/\\{class}/g, css + ' kv-fileinput-caption');\n            return self.mainTemplate.replace(/\\{class}/g, self.mainClass +\n                (!self.showBrowse && self.showCaption ? ' no-browse' : ''))\n                .replace(/\\{preview}/g, preview)\n                .replace(/\\{close}/g, close)\n                .replace(/\\{caption}/g, caption)\n                .replace(/\\{upload}/g, self._renderButton('upload'))\n                .replace(/\\{remove}/g, self._renderButton('remove'))\n                .replace(/\\{cancel}/g, self._renderButton('cancel'))\n                .replace(/\\{browse}/g, self._renderButton('browse'));\n        },\n        _renderButton: function (type) {\n            var self = this, tmplt = self._getLayoutTemplate('btnDefault'), css = self[type + 'Class'],\n                title = self[type + 'Title'], icon = self[type + 'Icon'], label = self[type + 'Label'],\n                status = self.isDisabled ? ' disabled' : '', btnType = 'button';\n            switch (type) {\n                case 'remove':\n                    if (!self.showRemove) {\n                        return '';\n                    }\n                    break;\n                case 'cancel':\n                    if (!self.showCancel) {\n                        return '';\n                    }\n                    css += ' hide';\n                    break;\n                case 'upload':\n                    if (!self.showUpload) {\n                        return '';\n                    }\n                    if (self.isUploadable && !self.isDisabled) {\n                        tmplt = self._getLayoutTemplate('btnLink').replace('{href}', self.uploadUrl);\n                    } else {\n                        btnType = 'submit';\n                    }\n                    break;\n                case 'browse':\n                    if (!self.showBrowse) {\n                        return '';\n                    }\n                    tmplt = self._getLayoutTemplate('btnBrowse');\n                    break;\n                default:\n                    return '';\n            }\n\n            css += type === 'browse' ? ' btn-file' : ' fileinput-' + type + ' fileinput-' + type + '-button';\n            if (!isEmpty(label)) {\n                label = ' <span class=\"' + self.buttonLabelClass + '\">' + label + '</span>';\n            }\n            return tmplt.replace('{type}', btnType).replace('{css}', css).replace('{title}', title)\n                .replace('{status}', status).replace('{icon}', icon).replace('{label}', label);\n        },\n        _renderThumbProgress: function () {\n            return '<div class=\"file-thumb-progress hide\">' + this.progressTemplate.replace(/\\{percent}/g,\n                    '0') + '</div>';\n        },\n        _renderFileFooter: function (caption, size, width, isError) {\n            var self = this, config = self.fileActionSettings, rem = config.showRemove, drg = config.showDrag,\n                upl = config.showUpload, zoom = config.showZoom, out, template = self._getLayoutTemplate('footer'),\n                indicator = isError ? config.indicatorError : config.indicatorNew,\n                title = isError ? config.indicatorErrorTitle : config.indicatorNewTitle;\n            size = self._getSize(size);\n            if (self.isUploadable) {\n                out = template.replace(/\\{actions}/g, self._renderFileActions(upl, rem, zoom, drg, false, false, false))\n                    .replace(/\\{caption}/g, caption).replace(/\\{size}/g, size).replace(/\\{width}/g, width)\n                    .replace(/\\{progress}/g, self._renderThumbProgress()).replace(/\\{indicator}/g, indicator)\n                    .replace(/\\{indicatorTitle}/g, title);\n            } else {\n                out = template.replace(/\\{actions}/g,\n                    self._renderFileActions(false, false, zoom, drg, false, false, false))\n                    .replace(/\\{caption}/g, caption).replace(/\\{size}/g, size).replace(/\\{width}/g, width)\n                    .replace(/\\{progress}/g, '').replace(/\\{indicator}/g, indicator)\n                    .replace(/\\{indicatorTitle}/g, title);\n            }\n            out = replaceTags(out, self.previewThumbTags);\n            return out;\n        },\n        _renderFileActions: function (showUpload, showDelete, showZoom, showDrag, disabled, url, key, isInit) {\n            if (!showUpload && !showDelete && !showZoom && !showDrag) {\n                return '';\n            }\n            var self = this,\n                vUrl = url === false ? '' : ' data-url=\"' + url + '\"',\n                vKey = key === false ? '' : ' data-key=\"' + key + '\"',\n                btnDelete = '', btnUpload = '', btnZoom = '', btnDrag = '', css,\n                template = self._getLayoutTemplate('actions'), config = self.fileActionSettings,\n                otherButtons = self.otherActionButtons.replace(/\\{dataKey}/g, vKey),\n                removeClass = disabled ? config.removeClass + ' disabled' : config.removeClass;\n            if (showDelete) {\n                btnDelete = self._getLayoutTemplate('actionDelete')\n                    .replace(/\\{removeClass}/g, removeClass)\n                    .replace(/\\{removeIcon}/g, config.removeIcon)\n                    .replace(/\\{removeTitle}/g, config.removeTitle)\n                    .replace(/\\{dataUrl}/g, vUrl)\n                    .replace(/\\{dataKey}/g, vKey);\n            }\n            if (showUpload) {\n                btnUpload = self._getLayoutTemplate('actionUpload')\n                    .replace(/\\{uploadClass}/g, config.uploadClass)\n                    .replace(/\\{uploadIcon}/g, config.uploadIcon)\n                    .replace(/\\{uploadTitle}/g, config.uploadTitle);\n            }\n            if (showZoom) {\n                btnZoom = self._getLayoutTemplate('actionZoom')\n                    .replace(/\\{zoomClass}/g, config.zoomClass)\n                    .replace(/\\{zoomIcon}/g, config.zoomIcon)\n                    .replace(/\\{zoomTitle}/g, config.zoomTitle);\n            }\n            if (showDrag && isInit) {\n                css = 'drag-handle-init ' + config.dragClass;\n                btnDrag = self._getLayoutTemplate('actionDrag').replace(/\\{dragClass}/g, css)\n                    .replace(/\\{dragTitle}/g, config.dragTitle)\n                    .replace(/\\{dragIcon}/g, config.dragIcon);\n            }\n            return template.replace(/\\{delete}/g, btnDelete)\n                .replace(/\\{upload}/g, btnUpload)\n                .replace(/\\{zoom}/g, btnZoom)\n                .replace(/\\{drag}/g, btnDrag)\n                .replace(/\\{other}/g, otherButtons);\n        },\n        _browse: function (e) {\n            var self = this;\n            self._raise('filebrowse');\n            if (e && e.isDefaultPrevented()) {\n                return;\n            }\n            if (self.isError && !self.isUploadable) {\n                self.clear();\n            }\n            self.$captionContainer.focus();\n        },\n        _change: function (e) {\n            var self = this, $el = self.$element;\n            if (!self.isUploadable && isEmpty($el.val()) && self.fileInputCleared) { // IE 11 fix\n                self.fileInputCleared = false;\n                return;\n            }\n            self.fileInputCleared = false;\n            var tfiles, msg, total, isDragDrop = arguments.length > 1, isAjaxUpload = self.isUploadable, i = 0, f, n, len,\n                files = isDragDrop ? e.originalEvent.dataTransfer.files : $el.get(0).files, ctr = self.filestack.length,\n                isSingleUpload = isEmpty($el.attr('multiple')), flagSingle = (isSingleUpload && ctr > 0), folders = 0,\n                throwError = function (mesg, file, previewId, index) {\n                    var p1 = $.extend(true, {}, self._getOutData({}, {}, files), {id: previewId, index: index}),\n                        p2 = {id: previewId, index: index, file: file, files: files};\n                    return self.isUploadable ? self._showUploadError(mesg, p1) : self._showError(mesg, p2);\n                };\n            self.reader = null;\n            self._resetUpload();\n            self._hideFileIcon();\n            if (self.isUploadable) {\n                self.$container.find('.file-drop-zone .' + self.dropZoneTitleClass).remove();\n            }\n            if (isDragDrop) {\n                tfiles = [];\n                while (files[i]) {\n                    f = files[i];\n                    if (!f.type && f.size % 4096 === 0) {\n                        folders++;\n                    } else {\n                        tfiles.push(f);\n                    }\n                    i++;\n                }\n            } else {\n                if (e.target.files === undefined) {\n                    tfiles = e.target && e.target.value ? [\n                        {name: e.target.value.replace(/^.+\\\\/, '')}\n                    ] : [];\n                } else {\n                    tfiles = e.target.files;\n                }\n            }\n            if (isEmpty(tfiles) || tfiles.length === 0) {\n                if (!isAjaxUpload) {\n                    self.clear();\n                }\n                self._showFolderError(folders);\n                self._raise('fileselectnone');\n                return;\n            }\n            self._resetErrors();\n            len = tfiles.length;\n            total = self._getFileCount(self.isUploadable ? (self.getFileStack().length + len) : len);\n            if (self.maxFileCount > 0 && total > self.maxFileCount) {\n                if (!self.autoReplace || len > self.maxFileCount) {\n                    n = (self.autoReplace && len > self.maxFileCount) ? len : total;\n                    msg = self.msgFilesTooMany.replace('{m}', self.maxFileCount).replace('{n}', n);\n                    self.isError = throwError(msg, null, null, null);\n                    self.$captionContainer.find('.kv-caption-icon').hide();\n                    self._setCaption('', true);\n                    self.$container.removeClass('file-input-new file-input-ajax-new');\n                    return;\n                }\n                if (total > self.maxFileCount) {\n                    self._resetPreviewThumbs(isAjaxUpload);\n                }\n            } else {\n                if (!isAjaxUpload || flagSingle) {\n                    self._resetPreviewThumbs(false);\n                    if (flagSingle) {\n                        self.clearStack();\n                    }\n                } else {\n                    if (isAjaxUpload && ctr === 0 && (!previewCache.count(self.id) || self.overwriteInitial)) {\n                        self._resetPreviewThumbs(true);\n                    }\n                }\n            }\n            if (self.isPreviewable) {\n                self._readFiles(tfiles);\n            } else {\n                self._updateFileDetails(1);\n            }\n            self._showFolderError(folders);\n        },\n        _abort: function (params) {\n            var self = this, data;\n            if (self.ajaxAborted && typeof self.ajaxAborted === \"object\" && self.ajaxAborted.message !== undefined) {\n                data = $.extend(true, {}, self._getOutData(), params);\n                data.abortData = self.ajaxAborted.data || {};\n                data.abortMessage = self.ajaxAborted.message;\n                self.cancel();\n                self._setProgress(101, self.$progress, self.msgCancelled);\n                self._showUploadError(self.ajaxAborted.message, data, 'filecustomerror');\n                return true;\n            }\n            return false;\n        },\n        _resetFileStack: function () {\n            var self = this, i = 0, newstack = [], newnames = [];\n            self._getThumbs().each(function () {\n                var $thumb = $(this), ind = $thumb.attr('data-fileindex'),\n                    file = self.filestack[ind];\n                if (ind === -1) {\n                    return;\n                }\n                if (file !== undefined) {\n                    newstack[i] = file;\n                    newnames[i] = self._getFileName(file);\n                    $thumb.attr({\n                        'id': self.previewInitId + '-' + i,\n                        'data-fileindex': i\n                    });\n                    i++;\n                } else {\n                    $thumb.attr({\n                        'id': 'uploaded-' + uniqId(),\n                        'data-fileindex': '-1'\n                    });\n                }\n            });\n            self.filestack = newstack;\n            self.filenames = newnames;\n        },\n        clearStack: function () {\n            var self = this;\n            self.filestack = [];\n            self.filenames = [];\n            return self.$element;\n        },\n        updateStack: function (i, file) {\n            var self = this;\n            self.filestack[i] = file;\n            self.filenames[i] = self._getFileName(file);\n            return self.$element;\n        },\n        addToStack: function (file) {\n            var self = this;\n            self.filestack.push(file);\n            self.filenames.push(self._getFileName(file));\n            return self.$element;\n        },\n        getFileStack: function (skipNull) {\n            var self = this;\n            return self.filestack.filter(function (n) {\n                return (skipNull ? n !== undefined : n !== undefined && n !== null);\n            });\n        },\n        getFilesCount: function () {\n            var self = this, len = self.isUploadable ? self.getFileStack().length : self.$element.get(0).files.length;\n            return self._getFileCount(len);\n        },\n        lock: function () {\n            var self = this;\n            self._resetErrors();\n            self.disable();\n            if (self.showRemove) {\n                addCss(self.$container.find('.fileinput-remove'), 'hide');\n            }\n            if (self.showCancel) {\n                self.$container.find('.fileinput-cancel').removeClass('hide');\n            }\n            self._raise('filelock', [self.filestack, self._getExtraData()]);\n            return self.$element;\n        },\n        unlock: function (reset) {\n            var self = this;\n            if (reset === undefined) {\n                reset = true;\n            }\n            self.enable();\n            if (self.showCancel) {\n                addCss(self.$container.find('.fileinput-cancel'), 'hide');\n            }\n            if (self.showRemove) {\n                self.$container.find('.fileinput-remove').removeClass('hide');\n            }\n            if (reset) {\n                self._resetFileStack();\n            }\n            self._raise('fileunlock', [self.filestack, self._getExtraData()]);\n            return self.$element;\n        },\n        cancel: function () {\n            var self = this, xhr = self.ajaxRequests, len = xhr.length, i;\n            if (len > 0) {\n                for (i = 0; i < len; i += 1) {\n                    self.cancelling = true;\n                    xhr[i].abort();\n                }\n            }\n            self._setProgressCancelled();\n            self._getThumbs().each(function () {\n                var $thumb = $(this), ind = $thumb.attr('data-fileindex');\n                $thumb.removeClass('file-uploading');\n                if (self.filestack[ind] !== undefined) {\n                    $thumb.find('.kv-file-upload').removeClass('disabled').removeAttr('disabled');\n                    $thumb.find('.kv-file-remove').removeClass('disabled').removeAttr('disabled');\n                }\n                self.unlock();\n            });\n            return self.$element;\n        },\n        clear: function () {\n            var self = this, cap;\n            self.$btnUpload.removeAttr('disabled');\n            self._getThumbs().find('video,audio,img').each(function () {\n                cleanMemory($(this));\n            });\n            self._resetUpload();\n            self.clearStack();\n            self._clearFileInput();\n            self._resetErrors(true);\n            self._raise('fileclear');\n            if (self._hasInitialPreview()) {\n                self._showFileIcon();\n                self._resetPreview();\n                self._initPreviewActions();\n                self.$container.removeClass('file-input-new');\n            } else {\n                self._getThumbs().each(function () {\n                    self._clearObjects($(this));\n                });\n                if (self.isUploadable) {\n                    previewCache.data[self.id] = {};\n                }\n                self.$preview.html('');\n                cap = (!self.overwriteInitial && self.initialCaption.length > 0) ? self.initialCaption : '';\n                self.$caption.html(cap);\n                self.$caption.attr('title', '');\n                addCss(self.$container, 'file-input-new');\n                self._validateDefaultPreview();\n            }\n            if (self.$container.find('.file-preview-frame').length === 0) {\n                if (!self._initCaption()) {\n                    self.$captionContainer.find('.kv-caption-icon').hide();\n                }\n            }\n            self._hideFileIcon();\n            self._raise('filecleared');\n            self.$captionContainer.focus();\n            self._setFileDropZoneTitle();\n            return self.$element;\n        },\n        reset: function () {\n            var self = this;\n            self._resetPreview();\n            self.$container.find('.fileinput-filename').text('');\n            self._raise('filereset');\n            addCss(self.$container, 'file-input-new');\n            if (self.$preview.find('.file-preview-frame').length || self.isUploadable && self.dropZoneEnabled) {\n                self.$container.removeClass('file-input-new');\n            }\n            self._setFileDropZoneTitle();\n            self.clearStack();\n            self.formdata = {};\n            return self.$element;\n        },\n        disable: function () {\n            var self = this;\n            self.isDisabled = true;\n            self._raise('filedisabled');\n            self.$element.attr('disabled', 'disabled');\n            self.$container.find(\".kv-fileinput-caption\").addClass(\"file-caption-disabled\");\n            self.$container.find(\".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button\").attr(\n                \"disabled\",\n                true);\n            self._initDragDrop();\n            return self.$element;\n        },\n        enable: function () {\n            var self = this;\n            self.isDisabled = false;\n            self._raise('fileenabled');\n            self.$element.removeAttr('disabled');\n            self.$container.find(\".kv-fileinput-caption\").removeClass(\"file-caption-disabled\");\n            self.$container.find(\n                \".btn-file, .fileinput-remove, .fileinput-upload, .file-preview-frame button\").removeAttr(\"disabled\");\n            self._initDragDrop();\n            return self.$element;\n        },\n        upload: function () {\n            var self = this, totLen = self.getFileStack().length, params = {},\n                i, outData, len, hasExtraData = !$.isEmptyObject(self._getExtraData());\n            if (self.minFileCount > 0 && self._getFileCount(totLen) < self.minFileCount) {\n                self._noFilesError(params);\n                return;\n            }\n            if (!self.isUploadable || self.isDisabled || (totLen === 0 && !hasExtraData)) {\n                return;\n            }\n            self._resetUpload();\n            self.$progress.removeClass('hide');\n            self.uploadCount = 0;\n            self.uploadStatus = {};\n            self.uploadLog = [];\n            self.lock();\n            self._setProgress(2);\n            if (totLen === 0 && hasExtraData) {\n                self._uploadExtraOnly();\n                return;\n            }\n            len = self.filestack.length;\n            self.hasInitData = false;\n            if (self.uploadAsync) {\n                outData = self._getOutData();\n                self._raise('filebatchpreupload', [outData]);\n                self.fileBatchCompleted = false;\n                self.uploadCache = {content: [], config: [], tags: [], append: true};\n                self.uploadAsyncCount = self.getFileStack().length;\n                for (i = 0; i < len; i++) {\n                    self.uploadCache.content[i] = null;\n                    self.uploadCache.config[i] = null;\n                    self.uploadCache.tags[i] = null;\n                }\n                for (i = 0; i < len; i++) {\n                    if (self.filestack[i] !== undefined) {\n                        self._uploadSingle(i, self.filestack, true);\n                    }\n                }\n                return;\n            }\n            self._uploadBatch();\n            return self.$element;\n        },\n        destroy: function () {\n            var self = this, $cont = self.$container;\n            $cont.find('.file-drop-zone').off();\n            self.$element.insertBefore($cont).off(NAMESPACE).removeData();\n            $cont.off().remove();\n            return self.$element;\n        },\n        refresh: function (options) {\n            var self = this, $el = self.$element;\n            options = options ? $.extend(true, {}, self.options, options) : self.options;\n            self.destroy();\n            $el.fileinput(options);\n            if ($el.val()) {\n                $el.trigger('change.fileinput');\n            }\n            return $el;\n        }\n    };\n\n    $.fn.fileinput = function (option) {\n        if (!hasFileAPISupport() && !isIE(9)) {\n            return;\n        }\n        var args = Array.apply(null, arguments), retvals = [];\n        args.shift();\n        this.each(function () {\n            var self = $(this), data = self.data('fileinput'), options = typeof option === 'object' && option,\n                theme = options.theme || self.data('theme'), l = {}, t = {},\n                lang = options.language || self.data('language') || 'en', opts;\n            if (!data) {\n                if (theme) {\n                    t = $.fn.fileinputThemes[theme] || {};\n                }\n                if (lang !== 'en' && !isEmpty($.fn.fileinputLocales[lang])) {\n                    l = $.fn.fileinputLocales[lang] || {};\n                }\n                opts = $.extend(true, {}, $.fn.fileinput.defaults, t, $.fn.fileinputLocales.en, l, options,\n                    self.data());\n                data = new FileInput(this, opts);\n                self.data('fileinput', data);\n            }\n\n            if (typeof option === 'string') {\n                retvals.push(data[option].apply(data, args));\n            }\n        });\n        switch (retvals.length) {\n            case 0:\n                return this;\n            case 1:\n                return retvals[0];\n            default:\n                return retvals;\n        }\n    };\n\n    $.fn.fileinput.defaults = {\n        language: 'en',\n        showCaption: true,\n        showBrowse: true,\n        showPreview: true,\n        showRemove: true,\n        showUpload: true,\n        showCancel: true,\n        showClose: true,\n        showUploadedThumbs: true,\n        browseOnZoneClick: false,\n        autoReplace: false,\n        previewClass: '',\n        captionClass: '',\n        mainClass: 'file-caption-main',\n        mainTemplate: null,\n        purifyHtml: true,\n        fileSizeGetter: null,\n        initialCaption: '',\n        initialPreview: [],\n        initialPreviewDelimiter: '*$$*',\n        initialPreviewAsData: false,\n        initialPreviewFileType: 'image',\n        initialPreviewConfig: [],\n        initialPreviewThumbTags: [],\n        previewThumbTags: {},\n        initialPreviewShowDelete: true,\n        removeFromPreviewOnError: false,\n        deleteUrl: '',\n        deleteExtraData: {},\n        overwriteInitial: true,\n        layoutTemplates: defaultLayoutTemplates,\n        previewTemplates: defaultPreviewTemplates,\n        previewZoomSettings: defaultPreviewZoomSettings,\n        previewZoomButtonIcons: {\n            prev: '<i class=\"glyphicon glyphicon-triangle-left\"></i>',\n            next: '<i class=\"glyphicon glyphicon-triangle-right\"></i>',\n            toggleheader: '<i class=\"glyphicon glyphicon-resize-vertical\"></i>',\n            fullscreen: '<i class=\"glyphicon glyphicon-fullscreen\"></i>',\n            borderless: '<i class=\"glyphicon glyphicon-resize-full\"></i>',\n            close: '<i class=\"glyphicon glyphicon-remove\"></i>'\n        },\n        previewZoomButtonClasses: {\n            prev: 'btn btn-navigate',\n            next: 'btn btn-navigate',\n            toggleheader: 'btn btn-default btn-header-toggle',\n            fullscreen: 'btn btn-default',\n            borderless: 'btn btn-default',\n            close: 'btn btn-default'\n        },\n        allowedPreviewTypes: defaultPreviewTypes,\n        allowedPreviewMimeTypes: null,\n        allowedFileTypes: null,\n        allowedFileExtensions: null,\n        defaultPreviewContent: null,\n        customLayoutTags: {},\n        customPreviewTags: {},\n        previewSettings: defaultPreviewSettings,\n        fileTypeSettings: defaultFileTypeSettings,\n        previewFileIcon: '<i class=\"glyphicon glyphicon-file\"></i>',\n        previewFileIconClass: 'file-other-icon',\n        previewFileIconSettings: {},\n        previewFileExtSettings: {},\n        buttonLabelClass: 'hidden-xs',\n        browseIcon: '<i class=\"glyphicon glyphicon-folder-open\"></i>&nbsp;',\n        browseClass: 'btn btn-primary',\n        removeIcon: '<i class=\"glyphicon glyphicon-trash\"></i>',\n        removeClass: 'btn btn-default',\n        cancelIcon: '<i class=\"glyphicon glyphicon-ban-circle\"></i>',\n        cancelClass: 'btn btn-default',\n        uploadIcon: '<i class=\"glyphicon glyphicon-upload\"></i>',\n        uploadClass: 'btn btn-default',\n        uploadUrl: null,\n        uploadAsync: true,\n        uploadExtraData: {},\n        zoomModalHeight: 480,\n        minImageWidth: null,\n        minImageHeight: null,\n        maxImageWidth: null,\n        maxImageHeight: null,\n        resizeImage: false,\n        resizePreference: 'width',\n        resizeQuality: 0.92,\n        resizeDefaultImageType: 'image/jpeg',\n        maxFileSize: 0,\n        maxFilePreviewSize: 25600, // 25 MB\n        minFileCount: 0,\n        maxFileCount: 0,\n        validateInitialCount: false,\n        msgValidationErrorClass: 'text-danger',\n        msgValidationErrorIcon: '<i class=\"glyphicon glyphicon-exclamation-sign\"></i> ',\n        msgErrorClass: 'file-error-message',\n        progressThumbClass: \"progress-bar progress-bar-success progress-bar-striped active\",\n        progressClass: \"progress-bar progress-bar-success progress-bar-striped active\",\n        progressCompleteClass: \"progress-bar progress-bar-success\",\n        progressErrorClass: \"progress-bar progress-bar-danger\",\n        progressUploadThreshold: 99,\n        previewFileType: 'image',\n        elCaptionContainer: null,\n        elCaptionText: null,\n        elPreviewContainer: null,\n        elPreviewImage: null,\n        elPreviewStatus: null,\n        elErrorContainer: null,\n        errorCloseButton: '<span class=\"close kv-error-close\">&times;</span>',\n        slugCallback: null,\n        dropZoneEnabled: true,\n        dropZoneTitleClass: 'file-drop-zone-title',\n        fileActionSettings: {},\n        otherActionButtons: '',\n        textEncoding: 'UTF-8',\n        ajaxSettings: {},\n        ajaxDeleteSettings: {},\n        showAjaxErrorDetails: true\n    };\n\n    $.fn.fileinputLocales.en = {\n        fileSingle: 'file',\n        filePlural: 'files',\n        browseLabel: 'Browse &hellip;',\n        removeLabel: 'Remove',\n        removeTitle: 'Clear selected files',\n        cancelLabel: 'Cancel',\n        cancelTitle: 'Abort ongoing upload',\n        uploadLabel: 'Upload',\n        uploadTitle: 'Upload selected files',\n        msgNo: 'No',\n        msgNoFilesSelected: 'No files selected',\n        msgCancelled: 'Cancelled',\n        msgZoomModalHeading: 'Detailed Preview',\n        msgSizeTooLarge: 'File \"{name}\" (<b>{size} KB</b>) exceeds maximum allowed upload size of <b>{maxSize} KB</b>.',\n        msgFilesTooLess: 'You must select at least <b>{n}</b> {files} to upload.',\n        msgFilesTooMany: 'Number of files selected for upload <b>({n})</b> exceeds maximum allowed limit of <b>{m}</b>.',\n        msgFileNotFound: 'File \"{name}\" not found!',\n        msgFileSecured: 'Security restrictions prevent reading the file \"{name}\".',\n        msgFileNotReadable: 'File \"{name}\" is not readable.',\n        msgFilePreviewAborted: 'File preview aborted for \"{name}\".',\n        msgFilePreviewError: 'An error occurred while reading the file \"{name}\".',\n        msgInvalidFileType: 'Invalid type for file \"{name}\". Only \"{types}\" files are supported.',\n        msgInvalidFileExtension: 'Invalid extension for file \"{name}\". Only \"{extensions}\" files are supported.',\n        msgUploadAborted: 'The file upload was aborted',\n        msgUploadThreshold: 'Processing...',\n        msgValidationError: 'Validation Error',\n        msgLoading: 'Loading file {index} of {files} &hellip;',\n        msgProgress: 'Loading file {index} of {files} - {name} - {percent}% completed.',\n        msgSelected: '{n} {files} selected',\n        msgFoldersNotAllowed: 'Drag & drop files only! {n} folder(s) dropped were skipped.',\n        msgImageWidthSmall: 'Width of image file \"{name}\" must be at least {size} px.',\n        msgImageHeightSmall: 'Height of image file \"{name}\" must be at least {size} px.',\n        msgImageWidthLarge: 'Width of image file \"{name}\" cannot exceed {size} px.',\n        msgImageHeightLarge: 'Height of image file \"{name}\" cannot exceed {size} px.',\n        msgImageResizeError: 'Could not get the image dimensions to resize.',\n        msgImageResizeException: 'Error while resizing the image.<pre>{errors}</pre>',\n        dropZoneTitle: 'Drag & drop files here &hellip;',\n        dropZoneClickTitle: '<br>(or click to select {files})',\n        previewZoomButtonTitles: {\n            prev: 'View previous file',\n            next: 'View next file',\n            toggleheader: 'Toggle header',\n            fullscreen: 'Toggle full screen',\n            borderless: 'Toggle borderless mode',\n            close: 'Close detailed preview'\n        }\n    };\n\n    $.fn.fileinput.Constructor = FileInput;\n\n    /**\n     * Convert automatically file inputs with class 'file' into a bootstrap fileinput control.\n     */\n    $(document).ready(function () {\n        var $input = $('input.file[type=file]');\n        if ($input.length) {\n            $input.fileinput();\n        }\n    });\n}));"]},"metadata":{},"sourceType":"module"}