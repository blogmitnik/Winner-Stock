{"ast":null,"code":"/*!\n * Infinite Scroll PACKAGED v3.0.2\n * Automatically add next page\n *\n * Licensed GPLv3 for open source use\n * or Infinite Scroll Commercial License for commercial use\n *\n * https://infinite-scroll.com\n * Copyright 2017 Metafizzy\n */\n\n/**\n * Bridget makes jQuery widgets\n * v2.0.1\n * MIT license\n */\n\n/* jshint browser: true, strict: true, undef: true, unused: true */\n(function (window, factory) {\n  // universal module definition\n\n  /*jshint strict: false */\n\n  /* globals define, module, require */\n  if (typeof define == 'function' && define.amd) {\n    // AMD\n    define('jquery-bridget/jquery-bridget', ['jquery'], function (jQuery) {\n      return factory(window, jQuery);\n    });\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS\n    module.exports = factory(window, require('jquery'));\n  } else {\n    // browser global\n    window.jQueryBridget = factory(window, window.jQuery);\n  }\n})(window, function factory(window, jQuery) {\n  'use strict'; // ----- utils ----- //\n\n  var arraySlice = Array.prototype.slice; // helper function for logging errors\n  // $.error breaks jQuery chaining\n\n  var console = window.console;\n  var logError = typeof console == 'undefined' ? function () {} : function (message) {\n    console.error(message);\n  }; // ----- jQueryBridget ----- //\n\n  function jQueryBridget(namespace, PluginClass, $) {\n    $ = $ || jQuery || window.jQuery;\n\n    if (!$) {\n      return;\n    } // add option method -> $().plugin('option', {...})\n\n\n    if (!PluginClass.prototype.option) {\n      // option setter\n      PluginClass.prototype.option = function (opts) {\n        // bail out if not an object\n        if (!$.isPlainObject(opts)) {\n          return;\n        }\n\n        this.options = $.extend(true, this.options, opts);\n      };\n    } // make jQuery plugin\n\n\n    $.fn[namespace] = function (arg0\n    /*, arg1 */\n    ) {\n      if (typeof arg0 == 'string') {\n        // method call $().plugin( 'methodName', { options } )\n        // shift arguments by 1\n        var args = arraySlice.call(arguments, 1);\n        return methodCall(this, arg0, args);\n      } // just $().plugin({ options })\n\n\n      plainCall(this, arg0);\n      return this;\n    }; // $().plugin('methodName')\n\n\n    function methodCall($elems, methodName, args) {\n      var returnValue;\n      var pluginMethodStr = '$().' + namespace + '(\"' + methodName + '\")';\n      $elems.each(function (i, elem) {\n        // get instance\n        var instance = $.data(elem, namespace);\n\n        if (!instance) {\n          logError(namespace + ' not initialized. Cannot call methods, i.e. ' + pluginMethodStr);\n          return;\n        }\n\n        var method = instance[methodName];\n\n        if (!method || methodName.charAt(0) == '_') {\n          logError(pluginMethodStr + ' is not a valid method');\n          return;\n        } // apply method, get return value\n\n\n        var value = method.apply(instance, args); // set return value if value is returned, use only first value\n\n        returnValue = returnValue === undefined ? value : returnValue;\n      });\n      return returnValue !== undefined ? returnValue : $elems;\n    }\n\n    function plainCall($elems, options) {\n      $elems.each(function (i, elem) {\n        var instance = $.data(elem, namespace);\n\n        if (instance) {\n          // set options & init\n          instance.option(options);\n\n          instance._init();\n        } else {\n          // initialize new instance\n          instance = new PluginClass(elem, options);\n          $.data(elem, namespace, instance);\n        }\n      });\n    }\n\n    updateJQuery($);\n  } // ----- updateJQuery ----- //\n  // set $.bridget for v1 backwards compatibility\n\n\n  function updateJQuery($) {\n    if (!$ || $ && $.bridget) {\n      return;\n    }\n\n    $.bridget = jQueryBridget;\n  }\n\n  updateJQuery(jQuery || window.jQuery); // -----  ----- //\n\n  return jQueryBridget;\n});\n/**\n * EvEmitter v1.1.0\n * Lil' event emitter\n * MIT License\n */\n\n/* jshint unused: true, undef: true, strict: true */\n\n\n(function (global, factory) {\n  // universal module definition\n\n  /* jshint strict: false */\n\n  /* globals define, module, window */\n  if (typeof define == 'function' && define.amd) {\n    // AMD - RequireJS\n    define('ev-emitter/ev-emitter', factory);\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS - Browserify, Webpack\n    module.exports = factory();\n  } else {\n    // Browser globals\n    global.EvEmitter = factory();\n  }\n})(typeof window != 'undefined' ? window : this, function () {\n  function EvEmitter() {}\n\n  var proto = EvEmitter.prototype;\n\n  proto.on = function (eventName, listener) {\n    if (!eventName || !listener) {\n      return;\n    } // set events hash\n\n\n    var events = this._events = this._events || {}; // set listeners array\n\n    var listeners = events[eventName] = events[eventName] || []; // only add once\n\n    if (listeners.indexOf(listener) == -1) {\n      listeners.push(listener);\n    }\n\n    return this;\n  };\n\n  proto.once = function (eventName, listener) {\n    if (!eventName || !listener) {\n      return;\n    } // add event\n\n\n    this.on(eventName, listener); // set once flag\n    // set onceEvents hash\n\n    var onceEvents = this._onceEvents = this._onceEvents || {}; // set onceListeners object\n\n    var onceListeners = onceEvents[eventName] = onceEvents[eventName] || {}; // set flag\n\n    onceListeners[listener] = true;\n    return this;\n  };\n\n  proto.off = function (eventName, listener) {\n    var listeners = this._events && this._events[eventName];\n\n    if (!listeners || !listeners.length) {\n      return;\n    }\n\n    var index = listeners.indexOf(listener);\n\n    if (index != -1) {\n      listeners.splice(index, 1);\n    }\n\n    return this;\n  };\n\n  proto.emitEvent = function (eventName, args) {\n    var listeners = this._events && this._events[eventName];\n\n    if (!listeners || !listeners.length) {\n      return;\n    }\n\n    var i = 0;\n    var listener = listeners[i];\n    args = args || []; // once stuff\n\n    var onceListeners = this._onceEvents && this._onceEvents[eventName];\n\n    while (listener) {\n      var isOnce = onceListeners && onceListeners[listener];\n\n      if (isOnce) {\n        // remove listener\n        // remove before trigger to prevent recursion\n        this.off(eventName, listener); // unset once flag\n\n        delete onceListeners[listener];\n      } // trigger listener\n\n\n      listener.apply(this, args); // get next listener\n\n      i += isOnce ? 0 : 1;\n      listener = listeners[i];\n    }\n\n    return this;\n  };\n\n  proto.allOff = proto.removeAllListeners = function () {\n    delete this._events;\n    delete this._onceEvents;\n  };\n\n  return EvEmitter;\n});\n/**\n * matchesSelector v2.0.2\n * matchesSelector( element, '.selector' )\n * MIT license\n */\n\n/*jshint browser: true, strict: true, undef: true, unused: true */\n\n\n(function (window, factory) {\n  /*global define: false, module: false */\n  'use strict'; // universal module definition\n\n  if (typeof define == 'function' && define.amd) {\n    // AMD\n    define('desandro-matches-selector/matches-selector', factory);\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS\n    module.exports = factory();\n  } else {\n    // browser global\n    window.matchesSelector = factory();\n  }\n})(window, function factory() {\n  'use strict';\n\n  var matchesMethod = function () {\n    var ElemProto = window.Element.prototype; // check for the standard method name first\n\n    if (ElemProto.matches) {\n      return 'matches';\n    } // check un-prefixed\n\n\n    if (ElemProto.matchesSelector) {\n      return 'matchesSelector';\n    } // check vendor prefixes\n\n\n    var prefixes = ['webkit', 'moz', 'ms', 'o'];\n\n    for (var i = 0; i < prefixes.length; i++) {\n      var prefix = prefixes[i];\n      var method = prefix + 'MatchesSelector';\n\n      if (ElemProto[method]) {\n        return method;\n      }\n    }\n  }();\n\n  return function matchesSelector(elem, selector) {\n    return elem[matchesMethod](selector);\n  };\n});\n/**\n * Fizzy UI utils v2.0.5\n * MIT license\n */\n\n/*jshint browser: true, undef: true, unused: true, strict: true */\n\n\n(function (window, factory) {\n  // universal module definition\n\n  /*jshint strict: false */\n\n  /*globals define, module, require */\n  if (typeof define == 'function' && define.amd) {\n    // AMD\n    define('fizzy-ui-utils/utils', ['desandro-matches-selector/matches-selector'], function (matchesSelector) {\n      return factory(window, matchesSelector);\n    });\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS\n    module.exports = factory(window, require('desandro-matches-selector'));\n  } else {\n    // browser global\n    window.fizzyUIUtils = factory(window, window.matchesSelector);\n  }\n})(window, function factory(window, matchesSelector) {\n  var utils = {}; // ----- extend ----- //\n  // extends objects\n\n  utils.extend = function (a, b) {\n    for (var prop in b) {\n      a[prop] = b[prop];\n    }\n\n    return a;\n  }; // ----- modulo ----- //\n\n\n  utils.modulo = function (num, div) {\n    return (num % div + div) % div;\n  }; // ----- makeArray ----- //\n  // turn element or nodeList into an array\n\n\n  utils.makeArray = function (obj) {\n    var ary = [];\n\n    if (Array.isArray(obj)) {\n      // use object if already an array\n      ary = obj;\n    } else if (obj && typeof obj == 'object' && typeof obj.length == 'number') {\n      // convert nodeList to array\n      for (var i = 0; i < obj.length; i++) {\n        ary.push(obj[i]);\n      }\n    } else {\n      // array of single index\n      ary.push(obj);\n    }\n\n    return ary;\n  }; // ----- removeFrom ----- //\n\n\n  utils.removeFrom = function (ary, obj) {\n    var index = ary.indexOf(obj);\n\n    if (index != -1) {\n      ary.splice(index, 1);\n    }\n  }; // ----- getParent ----- //\n\n\n  utils.getParent = function (elem, selector) {\n    while (elem.parentNode && elem != document.body) {\n      elem = elem.parentNode;\n\n      if (matchesSelector(elem, selector)) {\n        return elem;\n      }\n    }\n  }; // ----- getQueryElement ----- //\n  // use element as selector string\n\n\n  utils.getQueryElement = function (elem) {\n    if (typeof elem == 'string') {\n      return document.querySelector(elem);\n    }\n\n    return elem;\n  }; // ----- handleEvent ----- //\n  // enable .ontype to trigger from .addEventListener( elem, 'type' )\n\n\n  utils.handleEvent = function (event) {\n    var method = 'on' + event.type;\n\n    if (this[method]) {\n      this[method](event);\n    }\n  }; // ----- filterFindElements ----- //\n\n\n  utils.filterFindElements = function (elems, selector) {\n    // make array of elems\n    elems = utils.makeArray(elems);\n    var ffElems = [];\n    elems.forEach(function (elem) {\n      // check that elem is an actual element\n      if (!(elem instanceof HTMLElement)) {\n        return;\n      } // add elem if no selector\n\n\n      if (!selector) {\n        ffElems.push(elem);\n        return;\n      } // filter & find items if we have a selector\n      // filter\n\n\n      if (matchesSelector(elem, selector)) {\n        ffElems.push(elem);\n      } // find children\n\n\n      var childElems = elem.querySelectorAll(selector); // concat childElems to filterFound array\n\n      for (var i = 0; i < childElems.length; i++) {\n        ffElems.push(childElems[i]);\n      }\n    });\n    return ffElems;\n  }; // ----- debounceMethod ----- //\n\n\n  utils.debounceMethod = function (_class, methodName, threshold) {\n    // original method\n    var method = _class.prototype[methodName];\n    var timeoutName = methodName + 'Timeout';\n\n    _class.prototype[methodName] = function () {\n      var timeout = this[timeoutName];\n\n      if (timeout) {\n        clearTimeout(timeout);\n      }\n\n      var args = arguments;\n\n      var _this = this;\n\n      this[timeoutName] = setTimeout(function () {\n        method.apply(_this, args);\n        delete _this[timeoutName];\n      }, threshold || 100);\n    };\n  }; // ----- docReady ----- //\n\n\n  utils.docReady = function (callback) {\n    var readyState = document.readyState;\n\n    if (readyState == 'complete' || readyState == 'interactive') {\n      // do async to allow for other scripts to run. metafizzy/flickity#441\n      setTimeout(callback);\n    } else {\n      document.addEventListener('DOMContentLoaded', callback);\n    }\n  }; // ----- htmlInit ----- //\n  // http://jamesroberts.name/blog/2010/02/22/string-functions-for-javascript-trim-to-camel-case-to-dashed-and-to-underscore/\n\n\n  utils.toDashed = function (str) {\n    return str.replace(/(.)([A-Z])/g, function (match, $1, $2) {\n      return $1 + '-' + $2;\n    }).toLowerCase();\n  };\n\n  var console = window.console;\n  /**\n   * allow user to initialize classes via [data-namespace] or .js-namespace class\n   * htmlInit( Widget, 'widgetName' )\n   * options are parsed from data-namespace-options\n   */\n\n  utils.htmlInit = function (WidgetClass, namespace) {\n    utils.docReady(function () {\n      var dashedNamespace = utils.toDashed(namespace);\n      var dataAttr = 'data-' + dashedNamespace;\n      var dataAttrElems = document.querySelectorAll('[' + dataAttr + ']');\n      var jsDashElems = document.querySelectorAll('.js-' + dashedNamespace);\n      var elems = utils.makeArray(dataAttrElems).concat(utils.makeArray(jsDashElems));\n      var dataOptionsAttr = dataAttr + '-options';\n      var jQuery = window.jQuery;\n      elems.forEach(function (elem) {\n        var attr = elem.getAttribute(dataAttr) || elem.getAttribute(dataOptionsAttr);\n        var options;\n\n        try {\n          options = attr && JSON.parse(attr);\n        } catch (error) {\n          // log error, do not initialize\n          if (console) {\n            console.error('Error parsing ' + dataAttr + ' on ' + elem.className + ': ' + error);\n          }\n\n          return;\n        } // initialize\n\n\n        var instance = new WidgetClass(elem, options); // make available via $().data('namespace')\n\n        if (jQuery) {\n          jQuery.data(elem, namespace, instance);\n        }\n      });\n    });\n  }; // -----  ----- //\n\n\n  return utils;\n}); // core\n\n\n(function (window, factory) {\n  // universal module definition\n\n  /* globals define, module, require */\n  if (typeof define == 'function' && define.amd) {\n    // AMD\n    define('infinite-scroll/js/core', ['ev-emitter/ev-emitter', 'fizzy-ui-utils/utils'], function (EvEmitter, utils) {\n      return factory(window, EvEmitter, utils);\n    });\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS\n    module.exports = factory(window, require('ev-emitter'), require('fizzy-ui-utils'));\n  } else {\n    // browser global\n    window.InfiniteScroll = factory(window, window.EvEmitter, window.fizzyUIUtils);\n  }\n})(window, function factory(window, EvEmitter, utils) {\n  var jQuery = window.jQuery; // internal store of all InfiniteScroll intances\n\n  var instances = {};\n\n  function InfiniteScroll(element, options) {\n    var queryElem = utils.getQueryElement(element);\n\n    if (!queryElem) {\n      console.error('Bad element for InfiniteScroll: ' + (queryElem || element));\n      return;\n    }\n\n    element = queryElem; // do not initialize twice on same element\n\n    if (element.infiniteScrollGUID) {\n      var instance = instances[element.infiniteScrollGUID];\n      instance.option(options);\n      return instance;\n    }\n\n    this.element = element; // options\n\n    this.options = utils.extend({}, InfiniteScroll.defaults);\n    this.option(options); // add jQuery\n\n    if (jQuery) {\n      this.$element = jQuery(this.element);\n    }\n\n    this.create();\n  } // defaults\n\n\n  InfiniteScroll.defaults = {// path: null,\n    // hideNav: null,\n    // debug: false,\n  }; // create & destroy methods\n\n  InfiniteScroll.create = {};\n  InfiniteScroll.destroy = {};\n  var proto = InfiniteScroll.prototype; // inherit EvEmitter\n\n  utils.extend(proto, EvEmitter.prototype); // --------------------------  -------------------------- //\n  // globally unique identifiers\n\n  var GUID = 0;\n\n  proto.create = function () {\n    // create core\n    // add id for InfiniteScroll.data\n    var id = this.guid = ++GUID;\n    this.element.infiniteScrollGUID = id; // expando\n\n    instances[id] = this; // associate via id\n    // properties\n\n    this.pageIndex = 1; // default to first page\n\n    this.loadCount = 0;\n    this.updateGetPath(); // bail if getPath not set\n\n    if (!this.getPath) {\n      console.error('Disabling InfiniteScroll');\n      return;\n    }\n\n    this.updateGetAbsolutePath();\n    this.log('initialized', [this.element.className]);\n    this.callOnInit(); // create features\n\n    for (var method in InfiniteScroll.create) {\n      InfiniteScroll.create[method].call(this);\n    }\n  };\n\n  proto.option = function (opts) {\n    utils.extend(this.options, opts);\n  }; // call onInit option, used for binding events on init\n\n\n  proto.callOnInit = function () {\n    var onInit = this.options.onInit;\n\n    if (onInit) {\n      onInit.call(this, this);\n    }\n  }; // ----- events ----- //\n\n\n  proto.dispatchEvent = function (type, event, args) {\n    this.log(type, args);\n    var emitArgs = event ? [event].concat(args) : args;\n    this.emitEvent(type, emitArgs); // trigger jQuery event\n\n    if (!jQuery || !this.$element) {\n      return;\n    } // namespace jQuery event\n\n\n    type += '.infiniteScroll';\n    var $event = type;\n\n    if (event) {\n      // create jQuery event\n      var jQEvent = jQuery.Event(event);\n      jQEvent.type = type;\n      $event = jQEvent;\n    }\n\n    this.$element.trigger($event, args);\n  };\n\n  var loggers = {\n    initialized: function initialized(className) {\n      return 'on ' + className;\n    },\n    request: function request(path) {\n      return 'URL: ' + path;\n    },\n    load: function load(response, path) {\n      return (response.title || '') + '. URL: ' + path;\n    },\n    error: function error(_error, path) {\n      return _error + '. URL: ' + path;\n    },\n    append: function append(response, path, items) {\n      return items.length + ' items. URL: ' + path;\n    },\n    last: function last(response, path) {\n      return 'URL: ' + path;\n    },\n    history: function history(title, path) {\n      return 'URL: ' + path;\n    },\n    pageIndex: function pageIndex(index, origin) {\n      return 'current page determined to be: ' + index + ' from ' + origin;\n    }\n  }; // log events\n\n  proto.log = function (type, args) {\n    if (!this.options.debug) {\n      return;\n    }\n\n    var message = '[InfiniteScroll] ' + type;\n    var logger = loggers[type];\n\n    if (logger) {\n      message += '. ' + logger.apply(this, args);\n    }\n\n    console.log(message);\n  }; // -------------------------- methods used amoung features -------------------------- //\n\n\n  proto.updateMeasurements = function () {\n    this.windowHeight = window.innerHeight;\n    var rect = this.element.getBoundingClientRect();\n    this.top = rect.top + window.pageYOffset;\n  };\n\n  proto.updateScroller = function () {\n    var elementScroll = this.options.elementScroll;\n\n    if (!elementScroll) {\n      // default, use window\n      this.scroller = window;\n      return;\n    } // if true, set to element, otherwise use option\n\n\n    this.scroller = elementScroll === true ? this.element : utils.getQueryElement(elementScroll);\n\n    if (!this.scroller) {\n      throw 'Unable to find elementScroll: ' + elementScroll;\n    }\n  }; // -------------------------- page path -------------------------- //\n\n\n  proto.updateGetPath = function () {\n    var optPath = this.options.path;\n\n    if (!optPath) {\n      console.error('InfiniteScroll path option required. Set as: ' + optPath);\n      return;\n    } // function\n\n\n    var type = typeof optPath;\n\n    if (type == 'function') {\n      this.getPath = optPath;\n      return;\n    } // template string: '/pages/{{#}}.html'\n\n\n    var templateMatch = type == 'string' && optPath.match('{{#}}');\n\n    if (templateMatch) {\n      this.updateGetPathTemplate(optPath);\n      return;\n    } // selector: '.next-page-selector'\n\n\n    this.updateGetPathSelector(optPath);\n  };\n\n  proto.updateGetPathTemplate = function (optPath) {\n    // set getPath with template string\n    this.getPath = function () {\n      var nextIndex = this.pageIndex + 1;\n      return optPath.replace('{{#}}', nextIndex);\n    }.bind(this); // get pageIndex from location\n    // convert path option into regex to look for pattern in location\n\n\n    var regexString = optPath.replace('{{#}}', '(\\\\d\\\\d?\\\\d?)');\n    var templateRe = new RegExp(regexString);\n    var match = location.href.match(templateRe);\n\n    if (match) {\n      this.pageIndex = parseInt(match[1], 10);\n      this.log('pageIndex', this.pageIndex, 'template string');\n    }\n  };\n\n  var pathRegexes = [// WordPress & Tumblr - example.com/page/2\n  // Jekyll - example.com/page2\n  /^(.*?\\/?page\\/?)(\\d\\d?\\d?)(.*?$)/, // Drupal - example.com/?page=1\n  /^(.*?\\/?\\?page=)(\\d\\d?\\d?)(.*?$)/, // catch all, last occurence of a number\n  /(.*?)(\\d\\d?\\d?)(?!.*\\d)(.*?$)/];\n\n  proto.updateGetPathSelector = function (optPath) {\n    // parse href of link: '.next-page-link'\n    var hrefElem = document.querySelector(optPath);\n\n    if (!hrefElem) {\n      console.error('Bad InfiniteScroll path option. Next link not found: ' + optPath);\n      return;\n    }\n\n    var href = hrefElem.getAttribute('href'); // try matching href to pathRegexes patterns\n\n    var pathParts, regex;\n\n    for (var i = 0; href && i < pathRegexes.length; i++) {\n      regex = pathRegexes[i];\n      var match = href.match(regex);\n\n      if (match) {\n        pathParts = match.slice(1); // remove first part\n\n        break;\n      }\n    }\n\n    if (!pathParts) {\n      console.error('InfiniteScroll unable to parse next link href: ' + href);\n      return;\n    }\n\n    this.isPathSelector = true; // flag for checkLastPage()\n\n    this.getPath = function () {\n      var nextIndex = this.pageIndex + 1;\n      return pathParts[0] + nextIndex + pathParts[2];\n    }.bind(this); // get pageIndex from href\n\n\n    this.pageIndex = parseInt(pathParts[1], 10) - 1;\n    this.log('pageIndex', [this.pageIndex, 'next link']);\n  };\n\n  proto.updateGetAbsolutePath = function () {\n    var path = this.getPath(); // path doesn't start with http or /\n\n    var isAbsolute = path.match(/^http/) || path.match(/^\\//);\n\n    if (isAbsolute) {\n      this.getAbsolutePath = this.getPath;\n      return;\n    }\n\n    var pathname = location.pathname; // /foo/bar/index.html => /foo/bar\n\n    var directory = pathname.substring(0, pathname.lastIndexOf('/'));\n\n    this.getAbsolutePath = function () {\n      return directory + '/' + this.getPath();\n    };\n  }; // -------------------------- nav -------------------------- //\n  // hide navigation\n\n\n  InfiniteScroll.create.hideNav = function () {\n    var nav = utils.getQueryElement(this.options.hideNav);\n\n    if (!nav) {\n      return;\n    }\n\n    nav.style.display = 'none';\n    this.nav = nav;\n  };\n\n  InfiniteScroll.destroy.hideNav = function () {\n    if (this.nav) {\n      this.nav.style.display = '';\n    }\n  }; // -------------------------- destroy -------------------------- //\n\n\n  proto.destroy = function () {\n    this.allOff(); // remove all event listeners\n    // call destroy methods\n\n    for (var method in InfiniteScroll.destroy) {\n      InfiniteScroll.destroy[method].call(this);\n    }\n\n    delete this.element.infiniteScrollGUID;\n    delete instances[this.guid];\n  }; // -------------------------- utilities -------------------------- //\n  // https://remysharp.com/2010/07/21/throttling-function-calls\n\n\n  InfiniteScroll.throttle = function (fn, threshold) {\n    threshold = threshold || 200;\n    var last, timeout;\n    return function () {\n      var now = +new Date();\n      var args = arguments;\n\n      var trigger = function () {\n        last = now;\n        fn.apply(this, args);\n      }.bind(this);\n\n      if (last && now < last + threshold) {\n        // hold on to it\n        clearTimeout(timeout);\n        timeout = setTimeout(trigger, threshold);\n      } else {\n        trigger();\n      }\n    };\n  };\n\n  InfiniteScroll.data = function (elem) {\n    elem = utils.getQueryElement(elem);\n    var id = elem && elem.infiniteScrollGUID;\n    return id && instances[id];\n  }; // set internal jQuery, for Webpack + jQuery v3\n\n\n  InfiniteScroll.setJQuery = function ($) {\n    jQuery = $;\n  }; // -------------------------- setup -------------------------- //\n\n\n  utils.htmlInit(InfiniteScroll, 'infinite-scroll');\n\n  if (jQuery && jQuery.bridget) {\n    jQuery.bridget('infiniteScroll', InfiniteScroll);\n  } // --------------------------  -------------------------- //\n\n\n  return InfiniteScroll;\n}); // page-load\n\n\n(function (window, factory) {\n  // universal module definition\n\n  /* globals define, module, require */\n  if (typeof define == 'function' && define.amd) {\n    // AMD\n    define('infinite-scroll/js/page-load', ['./core'], function (InfiniteScroll) {\n      return factory(window, InfiniteScroll);\n    });\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS\n    module.exports = factory(window, require('./core'));\n  } else {\n    // browser global\n    factory(window, window.InfiniteScroll);\n  }\n})(window, function factory(window, InfiniteScroll) {\n  var proto = InfiniteScroll.prototype; // InfiniteScroll.defaults.append = false;\n\n  InfiniteScroll.defaults.loadOnScroll = true;\n  InfiniteScroll.defaults.checkLastPage = true;\n  InfiniteScroll.defaults.responseType = 'document'; // InfiniteScroll.defaults.prefill = false;\n  // InfiniteScroll.defaults.outlayer = null;\n\n  InfiniteScroll.create.pageLoad = function () {\n    this.canLoad = true;\n    this.on('scrollThreshold', this.onScrollThresholdLoad);\n    this.on('append', this.checkLastPage);\n\n    if (this.options.outlayer) {\n      this.on('append', this.onAppendOutlayer);\n    }\n  };\n\n  proto.onScrollThresholdLoad = function () {\n    if (this.options.loadOnScroll) {\n      this.loadNextPage();\n    }\n  };\n\n  proto.loadNextPage = function () {\n    if (this.isLoading || !this.canLoad) {\n      return;\n    }\n\n    var path = this.getAbsolutePath();\n    this.isLoading = true;\n\n    var onLoad = function (response) {\n      this.onPageLoad(response, path);\n    }.bind(this);\n\n    var onError = function (error) {\n      this.onPageError(error, path);\n    }.bind(this);\n\n    request(path, this.options.responseType, onLoad, onError);\n    this.dispatchEvent('request', null, [path]);\n  };\n\n  proto.onPageLoad = function (response, path) {\n    // done loading if not appending\n    if (!this.options.append) {\n      this.isLoading = false;\n    }\n\n    this.pageIndex++;\n    this.loadCount++;\n    this.dispatchEvent('load', null, [response, path]);\n    this.appendNextPage(response, path);\n    return response;\n  };\n\n  proto.appendNextPage = function (response, path) {\n    var optAppend = this.options.append; // do not append json\n\n    var isDocument = this.options.responseType == 'document';\n\n    if (!isDocument || !optAppend) {\n      return;\n    }\n\n    var items = response.querySelectorAll(optAppend);\n    var fragment = getItemsFragment(items);\n\n    var appendReady = function () {\n      this.appendItems(items, fragment);\n      this.isLoading = false;\n      this.dispatchEvent('append', null, [response, path, items]);\n    }.bind(this); // TODO add hook for option to trigger appendReady\n\n\n    if (this.options.outlayer) {\n      this.appendOutlayerItems(fragment, appendReady);\n    } else {\n      appendReady();\n    }\n  };\n\n  proto.appendItems = function (items, fragment) {\n    if (!items || !items.length) {\n      return;\n    } // get fragment if not provided\n\n\n    fragment = fragment || getItemsFragment(items);\n    refreshScripts(fragment);\n    this.element.appendChild(fragment);\n  };\n\n  function getItemsFragment(items) {\n    // add items to fragment\n    var fragment = document.createDocumentFragment();\n\n    for (var i = 0; items && i < items.length; i++) {\n      fragment.appendChild(items[i]);\n    }\n\n    return fragment;\n  } // replace <script>s with copies so they load\n  // <script>s added by InfiniteScroll will not load\n  // similar to https://stackoverflow.com/questions/610995\n\n\n  function refreshScripts(fragment) {\n    var scripts = fragment.querySelectorAll('script');\n\n    for (var i = 0; i < scripts.length; i++) {\n      var script = scripts[i];\n      var freshScript = document.createElement('script');\n      copyAttributes(script, freshScript);\n      script.parentNode.replaceChild(freshScript, script);\n    }\n  }\n\n  function copyAttributes(fromNode, toNode) {\n    var attrs = fromNode.attributes;\n\n    for (var i = 0; i < attrs.length; i++) {\n      var attr = attrs[i];\n      toNode.setAttribute(attr.name, attr.value);\n    }\n  } // ----- outlayer ----- //\n\n\n  proto.appendOutlayerItems = function (fragment, appendReady) {\n    var imagesLoaded = InfiniteScroll.imagesLoaded || window.imagesLoaded;\n\n    if (!imagesLoaded) {\n      console.error('[InfiniteScroll] imagesLoaded required for outlayer option');\n      this.isLoading = false;\n      return;\n    } // append once images loaded\n\n\n    imagesLoaded(fragment, appendReady);\n  };\n\n  proto.onAppendOutlayer = function (response, path, items) {\n    this.options.outlayer.appended(items);\n  }; // ----- checkLastPage ----- //\n  // check response for next element\n\n\n  proto.checkLastPage = function (response, path) {\n    var checkLastPage = this.options.checkLastPage;\n\n    if (!checkLastPage) {\n      return;\n    }\n\n    var pathOpt = this.options.path; // if path is function, check if next path is truthy\n\n    if (typeof pathOpt == 'function') {\n      var nextPath = this.getPath();\n\n      if (!nextPath) {\n        this.lastPageReached(response, path);\n        return;\n      }\n    } // get selector from checkLastPage or path option\n\n\n    var selector;\n\n    if (typeof checkLastPage == 'string') {\n      selector = checkLastPage;\n    } else if (this.isPathSelector) {\n      // path option is selector string\n      selector = pathOpt;\n    } // check last page for selector\n    // bail if no selector or not document response\n\n\n    if (!selector || !response.querySelector) {\n      return;\n    } // check if response has selector\n\n\n    var nextElem = response.querySelector(selector);\n\n    if (!nextElem) {\n      this.lastPageReached(response, path);\n    }\n  };\n\n  proto.lastPageReached = function (response, path) {\n    this.canLoad = false;\n    this.dispatchEvent('last', null, [response, path]);\n  }; // ----- error ----- //\n\n\n  proto.onPageError = function (error, path) {\n    this.isLoading = false;\n    this.canLoad = false;\n    this.dispatchEvent('error', null, [error, path]);\n    return error;\n  }; // -------------------------- prefill -------------------------- //\n\n\n  InfiniteScroll.create.prefill = function () {\n    if (!this.options.prefill) {\n      return;\n    }\n\n    var append = this.options.append;\n\n    if (!append) {\n      console.error('append option required for prefill. Set as :' + append);\n      return;\n    }\n\n    this.updateMeasurements();\n    this.updateScroller();\n    this.isPrefilling = true;\n    this.on('append', this.prefill);\n    this.once('error', this.stopPrefill);\n    this.once('last', this.stopPrefill);\n    this.prefill();\n  };\n\n  proto.prefill = function () {\n    var distance = this.getPrefillDistance();\n    this.isPrefilling = distance >= 0;\n\n    if (this.isPrefilling) {\n      this.log('prefill');\n      this.loadNextPage();\n    } else {\n      this.stopPrefill();\n    }\n  };\n\n  proto.getPrefillDistance = function () {\n    // element scroll\n    if (this.options.elementScroll) {\n      return this.scroller.clientHeight - this.scroller.scrollHeight;\n    } // window\n\n\n    return this.windowHeight - this.element.clientHeight;\n  };\n\n  proto.stopPrefill = function () {\n    console.log('stopping prefill');\n    this.off('append', this.prefill);\n  }; // -------------------------- request -------------------------- //\n\n\n  function request(url, responseType, onLoad, onError) {\n    var req = new XMLHttpRequest();\n    req.open('GET', url, true); // set responseType document to return DOM\n\n    req.responseType = responseType || ''; // set X-Requested-With header to check that is ajax request\n\n    req.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n\n    req.onload = function () {\n      if (req.status == 200) {\n        onLoad(req.response);\n      } else {\n        // not 200 OK, error\n        var error = new Error(req.statusText);\n        onError(error);\n      }\n    }; // Handle network errors\n\n\n    req.onerror = function () {\n      var error = new Error('Network error requesting ' + url);\n      onError(error);\n    };\n\n    req.send();\n  } // --------------------------  -------------------------- //\n\n\n  return InfiniteScroll;\n}); // scroll-watch\n\n\n(function (window, factory) {\n  // universal module definition\n\n  /* globals define, module, require */\n  if (typeof define == 'function' && define.amd) {\n    // AMD\n    define('infinite-scroll/js/scroll-watch', ['./core', 'fizzy-ui-utils/utils'], function (InfiniteScroll, utils) {\n      return factory(window, InfiniteScroll, utils);\n    });\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS\n    module.exports = factory(window, require('./core'), require('fizzy-ui-utils'));\n  } else {\n    // browser global\n    factory(window, window.InfiniteScroll, window.fizzyUIUtils);\n  }\n})(window, function factory(window, InfiniteScroll, utils) {\n  var proto = InfiniteScroll.prototype; // default options\n\n  InfiniteScroll.defaults.scrollThreshold = 400; // InfiniteScroll.defaults.elementScroll = null;\n\n  InfiniteScroll.create.scrollWatch = function () {\n    // events\n    this.pageScrollHandler = this.onPageScroll.bind(this);\n    this.resizeHandler = this.onResize.bind(this);\n    var scrollThreshold = this.options.scrollThreshold;\n    var isEnable = scrollThreshold || scrollThreshold === 0;\n\n    if (isEnable) {\n      this.enableScrollWatch();\n    }\n  };\n\n  InfiniteScroll.destroy.scrollWatch = function () {\n    this.disableScrollWatch();\n  };\n\n  proto.enableScrollWatch = function () {\n    if (this.isScrollWatching) {\n      return;\n    }\n\n    this.isScrollWatching = true;\n    this.updateMeasurements();\n    this.updateScroller(); // TODO disable after error?\n\n    this.on('last', this.disableScrollWatch);\n    this.bindScrollWatchEvents(true);\n  };\n\n  proto.disableScrollWatch = function () {\n    if (!this.isScrollWatching) {\n      return;\n    }\n\n    this.bindScrollWatchEvents(false);\n    delete this.isScrollWatching;\n  };\n\n  proto.bindScrollWatchEvents = function (isBind) {\n    var addRemove = isBind ? 'addEventListener' : 'removeEventListener';\n    this.scroller[addRemove]('scroll', this.pageScrollHandler);\n    window[addRemove]('resize', this.resizeHandler);\n  };\n\n  proto.onPageScroll = InfiniteScroll.throttle(function () {\n    var distance = this.getBottomDistance();\n\n    if (distance <= this.options.scrollThreshold) {\n      this.dispatchEvent('scrollThreshold');\n    }\n  });\n\n  proto.getBottomDistance = function () {\n    if (this.options.elementScroll) {\n      return this.getElementBottomDistance();\n    } else {\n      return this.getWindowBottomDistance();\n    }\n  };\n\n  proto.getWindowBottomDistance = function () {\n    var bottom = this.top + this.element.clientHeight;\n    var scrollY = window.pageYOffset + this.windowHeight;\n    return bottom - scrollY;\n  };\n\n  proto.getElementBottomDistance = function () {\n    var bottom = this.scroller.scrollHeight;\n    var scrollY = this.scroller.scrollTop + this.scroller.clientHeight;\n    return bottom - scrollY;\n  };\n\n  proto.onResize = function () {\n    this.updateMeasurements();\n  };\n\n  utils.debounceMethod(InfiniteScroll, 'onResize', 150); // --------------------------  -------------------------- //\n\n  return InfiniteScroll;\n}); // history\n\n\n(function (window, factory) {\n  // universal module definition\n\n  /* globals define, module, require */\n  if (typeof define == 'function' && define.amd) {\n    // AMD\n    define('infinite-scroll/js/history', ['./core', 'fizzy-ui-utils/utils'], function (InfiniteScroll, utils) {\n      return factory(window, InfiniteScroll, utils);\n    });\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS\n    module.exports = factory(window, require('./core'), require('fizzy-ui-utils'));\n  } else {\n    // browser global\n    factory(window, window.InfiniteScroll, window.fizzyUIUtils);\n  }\n})(window, function factory(window, InfiniteScroll, utils) {\n  var proto = InfiniteScroll.prototype;\n  InfiniteScroll.defaults.history = 'replace'; // InfiniteScroll.defaults.historyTitle = false;\n\n  var link = document.createElement('a'); // ----- create/destroy ----- //\n\n  InfiniteScroll.create.history = function () {\n    if (!this.options.history) {\n      return;\n    } // check for same origin\n\n\n    link.href = this.getAbsolutePath(); // MS Edge does not have origin on link https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12236493/\n\n    var linkOrigin = link.origin || link.protocol + '//' + link.host;\n    var isSameOrigin = linkOrigin == location.origin;\n\n    if (!isSameOrigin) {\n      console.error('[InfiniteScroll] cannot set history with different origin: ' + link.origin + ' on ' + location.origin + ' . History behavior disabled.');\n      return;\n    } // two ways to handle changing history\n\n\n    if (this.options.append) {\n      this.createHistoryAppend();\n    } else {\n      this.createHistoryPageLoad();\n    }\n  };\n\n  proto.createHistoryAppend = function () {\n    this.updateMeasurements();\n    this.updateScroller(); // array of scroll positions of appended pages\n\n    this.scrollPages = [{\n      // first page\n      top: 0,\n      path: location.href,\n      title: document.title\n    }];\n    this.scrollPageIndex = 0; // events\n\n    this.scrollHistoryHandler = this.onScrollHistory.bind(this);\n    this.unloadHandler = this.onUnload.bind(this);\n    this.scroller.addEventListener('scroll', this.scrollHistoryHandler);\n    this.on('append', this.onAppendHistory);\n    this.bindHistoryAppendEvents(true);\n  };\n\n  proto.bindHistoryAppendEvents = function (isBind) {\n    var addRemove = isBind ? 'addEventListener' : 'removeEventListener';\n    this.scroller[addRemove]('scroll', this.scrollHistoryHandler);\n    window[addRemove]('unload', this.unloadHandler);\n  };\n\n  proto.createHistoryPageLoad = function () {\n    this.on('load', this.onPageLoadHistory);\n  };\n\n  InfiniteScroll.destroy.history = proto.destroyHistory = function () {\n    var isHistoryAppend = this.options.history && this.options.append;\n\n    if (isHistoryAppend) {\n      this.bindHistoryAppendEvents(false);\n    }\n  }; // ----- append history ----- //\n\n\n  proto.onAppendHistory = function (response, path, items) {\n    var firstItem = items[0];\n    var elemScrollY = this.getElementScrollY(firstItem); // resolve path\n\n    link.href = path; // add page data to hash\n\n    this.scrollPages.push({\n      top: elemScrollY,\n      path: link.href,\n      title: response.title\n    });\n  };\n\n  proto.getElementScrollY = function (elem) {\n    if (this.options.elementScroll) {\n      return this.getElementElementScrollY(elem);\n    } else {\n      return this.getElementWindowScrollY(elem);\n    }\n  };\n\n  proto.getElementWindowScrollY = function (elem) {\n    var rect = elem.getBoundingClientRect();\n    return rect.top + window.pageYOffset;\n  }; // wow, stupid name\n\n\n  proto.getElementElementScrollY = function (elem) {\n    return elem.offsetTop - this.top;\n  };\n\n  proto.onScrollHistory = function () {\n    // cycle through positions, find biggest without going over\n    var scrollViewY = this.getScrollViewY();\n    var pageIndex, page;\n\n    for (var i = 0; i < this.scrollPages.length; i++) {\n      var scrollPage = this.scrollPages[i];\n\n      if (scrollPage.top >= scrollViewY) {\n        break;\n      }\n\n      pageIndex = i;\n      page = scrollPage;\n    } // set history if changed\n\n\n    if (pageIndex != this.scrollPageIndex) {\n      this.scrollPageIndex = pageIndex;\n      this.setHistory(page.title, page.path);\n    }\n  };\n\n  utils.debounceMethod(InfiniteScroll, 'onScrollHistory', 150);\n\n  proto.getScrollViewY = function () {\n    if (this.options.elementScroll) {\n      return this.scroller.scrollTop + this.scroller.clientHeight / 2;\n    } else {\n      return window.pageYOffset + this.windowHeight / 2;\n    }\n  };\n\n  proto.setHistory = function (title, path) {\n    var optHistory = this.options.history;\n    var historyMethod = optHistory && history[optHistory + 'State'];\n\n    if (!historyMethod) {\n      return;\n    }\n\n    history[optHistory + 'State'](null, title, path);\n\n    if (this.options.historyTitle) {\n      document.title = title;\n    }\n\n    this.dispatchEvent('history', null, [title, path]);\n  }; // scroll to top to prevent initial scroll-reset after page refresh\n  // http://stackoverflow.com/a/18633915/182183\n\n\n  proto.onUnload = function () {\n    var pageIndex = this.scrollPageIndex;\n\n    if (pageIndex === 0) {\n      return;\n    } // calculate where scroll position would be on refresh\n\n\n    var scrollPage = this.scrollPages[pageIndex];\n    var scrollY = window.pageYOffset - scrollPage.top + this.top; // disable scroll event before setting scroll #679\n\n    this.destroyHistory();\n    scrollTo(0, scrollY);\n  }; // ----- load history ----- //\n  // update URL\n\n\n  proto.onPageLoadHistory = function (response, path) {\n    this.setHistory(response.title, path);\n  }; // --------------------------  -------------------------- //\n\n\n  return InfiniteScroll;\n}); // button\n\n\n(function (window, factory) {\n  // universal module definition\n\n  /* globals define, module, require */\n  if (typeof define == 'function' && define.amd) {\n    // AMD\n    define('infinite-scroll/js/button', ['./core', 'fizzy-ui-utils/utils'], function (InfiniteScroll, utils) {\n      return factory(window, InfiniteScroll, utils);\n    });\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS\n    module.exports = factory(window, require('./core'), require('fizzy-ui-utils'));\n  } else {\n    // browser global\n    factory(window, window.InfiniteScroll, window.fizzyUIUtils);\n  }\n})(window, function factory(window, InfiniteScroll, utils) {\n  // InfiniteScroll.defaults.button = null;\n  InfiniteScroll.create.button = function () {\n    var buttonElem = utils.getQueryElement(this.options.button);\n\n    if (buttonElem) {\n      this.button = new InfiniteScrollButton(buttonElem, this);\n      return;\n    }\n  };\n\n  InfiniteScroll.destroy.button = function () {\n    if (this.button) {\n      this.button.destroy();\n    }\n  }; // -------------------------- InfiniteScrollButton -------------------------- //\n\n\n  function InfiniteScrollButton(element, infScroll) {\n    this.element = element;\n    this.infScroll = infScroll; // events\n\n    this.clickHandler = this.onClick.bind(this);\n    this.element.addEventListener('click', this.clickHandler);\n    infScroll.on('request', this.disable.bind(this));\n    infScroll.on('load', this.enable.bind(this));\n    infScroll.on('error', this.hide.bind(this));\n    infScroll.on('last', this.hide.bind(this));\n  }\n\n  InfiniteScrollButton.prototype.onClick = function (event) {\n    event.preventDefault();\n    this.infScroll.loadNextPage();\n  };\n\n  InfiniteScrollButton.prototype.enable = function () {\n    this.element.removeAttribute('disabled');\n  };\n\n  InfiniteScrollButton.prototype.disable = function () {\n    this.element.disabled = 'disabled';\n  };\n\n  InfiniteScrollButton.prototype.hide = function () {\n    this.element.style.display = 'none';\n  };\n\n  InfiniteScrollButton.prototype.destroy = function () {\n    this.element.removeEventListener('click', this.clickHandler);\n  }; // --------------------------  -------------------------- //\n\n\n  InfiniteScroll.Button = InfiniteScrollButton;\n  return InfiniteScroll;\n}); // status\n\n\n(function (window, factory) {\n  // universal module definition\n\n  /* globals define, module, require */\n  if (typeof define == 'function' && define.amd) {\n    // AMD\n    define('infinite-scroll/js/status', ['./core', 'fizzy-ui-utils/utils'], function (InfiniteScroll, utils) {\n      return factory(window, InfiniteScroll, utils);\n    });\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS\n    module.exports = factory(window, require('./core'), require('fizzy-ui-utils'));\n  } else {\n    // browser global\n    factory(window, window.InfiniteScroll, window.fizzyUIUtils);\n  }\n})(window, function factory(window, InfiniteScroll, utils) {\n  var proto = InfiniteScroll.prototype; // InfiniteScroll.defaults.status = null;\n\n  InfiniteScroll.create.status = function () {\n    var statusElem = utils.getQueryElement(this.options.status);\n\n    if (!statusElem) {\n      return;\n    } // elements\n\n\n    this.statusElement = statusElem;\n    this.statusEventElements = {\n      request: statusElem.querySelector('.infinite-scroll-request'),\n      error: statusElem.querySelector('.infinite-scroll-error'),\n      last: statusElem.querySelector('.infinite-scroll-last')\n    }; // events\n\n    this.on('request', this.showRequestStatus);\n    this.on('error', this.showErrorStatus);\n    this.on('last', this.showLastStatus);\n    this.bindHideStatus('on');\n  };\n\n  proto.bindHideStatus = function (bindMethod) {\n    var hideEvent = this.options.append ? 'append' : 'load';\n    this[bindMethod](hideEvent, this.hideAllStatus);\n  };\n\n  proto.showRequestStatus = function () {\n    this.showStatus('request');\n  };\n\n  proto.showErrorStatus = function () {\n    this.showStatus('error');\n  };\n\n  proto.showLastStatus = function () {\n    this.showStatus('last'); // prevent last then append event race condition from showing last status #706\n\n    this.bindHideStatus('off');\n  };\n\n  proto.showStatus = function (eventName) {\n    show(this.statusElement);\n    this.hideStatusEventElements();\n    var eventElem = this.statusEventElements[eventName];\n    show(eventElem);\n  };\n\n  proto.hideAllStatus = function () {\n    hide(this.statusElement);\n    this.hideStatusEventElements();\n  };\n\n  proto.hideStatusEventElements = function () {\n    for (var type in this.statusEventElements) {\n      var eventElem = this.statusEventElements[type];\n      hide(eventElem);\n    }\n  }; // --------------------------  -------------------------- //\n\n\n  function hide(elem) {\n    setDisplay(elem, 'none');\n  }\n\n  function show(elem) {\n    setDisplay(elem, 'block');\n  }\n\n  function setDisplay(elem, value) {\n    if (elem) {\n      elem.style.display = value;\n    }\n  } // --------------------------  -------------------------- //\n\n\n  return InfiniteScroll;\n});\n/*!\n * Infinite Scroll v3.0.2\n * Automatically add next page\n *\n * Licensed GPLv3 for open source use\n * or Infinite Scroll Commercial License for commercial use\n *\n * https://infinite-scroll.com\n * Copyright 2017 Metafizzy\n */\n\n\n(function (window, factory) {\n  // universal module definition\n\n  /* globals define, module, require */\n  if (typeof define == 'function' && define.amd) {\n    // AMD\n    define(['infinite-scroll/js/core', 'infinite-scroll/js/page-load', 'infinite-scroll/js/scroll-watch', 'infinite-scroll/js/history', 'infinite-scroll/js/button', 'infinite-scroll/js/status'], factory);\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS\n    module.exports = factory(require('./core'), require('./page-load'), require('./scroll-watch'), require('./history'), require('./button'), require('./status'));\n  }\n})(window, function factory(InfiniteScroll) {\n  return InfiniteScroll;\n});\n/*!\n * imagesLoaded v4.1.3\n * JavaScript is all like \"You images are done yet or what?\"\n * MIT License\n */\n\n\n(function (window, factory) {\n  'use strict'; // universal module definition\n\n  /*global define: false, module: false, require: false */\n\n  if (typeof define == 'function' && define.amd) {\n    // AMD\n    define('imagesloaded/imagesloaded', ['ev-emitter/ev-emitter'], function (EvEmitter) {\n      return factory(window, EvEmitter);\n    });\n  } else if (typeof module == 'object' && module.exports) {\n    // CommonJS\n    module.exports = factory(window, require('ev-emitter'));\n  } else {\n    // browser global\n    window.imagesLoaded = factory(window, window.EvEmitter);\n  }\n})(typeof window !== 'undefined' ? window : this, // --------------------------  factory -------------------------- //\nfunction factory(window, EvEmitter) {\n  var $ = window.jQuery;\n  var console = window.console; // -------------------------- helpers -------------------------- //\n  // extend objects\n\n  function extend(a, b) {\n    for (var prop in b) {\n      a[prop] = b[prop];\n    }\n\n    return a;\n  } // turn element or nodeList into an array\n\n\n  function makeArray(obj) {\n    var ary = [];\n\n    if (Array.isArray(obj)) {\n      // use object if already an array\n      ary = obj;\n    } else if (typeof obj.length == 'number') {\n      // convert nodeList to array\n      for (var i = 0; i < obj.length; i++) {\n        ary.push(obj[i]);\n      }\n    } else {\n      // array of single index\n      ary.push(obj);\n    }\n\n    return ary;\n  } // -------------------------- imagesLoaded -------------------------- //\n\n  /**\n   * @param {Array, Element, NodeList, String} elem\n   * @param {Object or Function} options - if function, use as callback\n   * @param {Function} onAlways - callback function\n   */\n\n\n  function ImagesLoaded(elem, options, onAlways) {\n    // coerce ImagesLoaded() without new, to be new ImagesLoaded()\n    if (!(this instanceof ImagesLoaded)) {\n      return new ImagesLoaded(elem, options, onAlways);\n    } // use elem as selector string\n\n\n    if (typeof elem == 'string') {\n      elem = document.querySelectorAll(elem);\n    }\n\n    this.elements = makeArray(elem);\n    this.options = extend({}, this.options);\n\n    if (typeof options == 'function') {\n      onAlways = options;\n    } else {\n      extend(this.options, options);\n    }\n\n    if (onAlways) {\n      this.on('always', onAlways);\n    }\n\n    this.getImages();\n\n    if ($) {\n      // add jQuery Deferred object\n      this.jqDeferred = new $.Deferred();\n    } // HACK check async to allow time to bind listeners\n\n\n    setTimeout(function () {\n      this.check();\n    }.bind(this));\n  }\n\n  ImagesLoaded.prototype = Object.create(EvEmitter.prototype);\n  ImagesLoaded.prototype.options = {};\n\n  ImagesLoaded.prototype.getImages = function () {\n    this.images = []; // filter & find items if we have an item selector\n\n    this.elements.forEach(this.addElementImages, this);\n  };\n  /**\n   * @param {Node} element\n   */\n\n\n  ImagesLoaded.prototype.addElementImages = function (elem) {\n    // filter siblings\n    if (elem.nodeName == 'IMG') {\n      this.addImage(elem);\n    } // get background image on element\n\n\n    if (this.options.background === true) {\n      this.addElementBackgroundImages(elem);\n    } // find children\n    // no non-element nodes, #143\n\n\n    var nodeType = elem.nodeType;\n\n    if (!nodeType || !elementNodeTypes[nodeType]) {\n      return;\n    }\n\n    var childImgs = elem.querySelectorAll('img'); // concat childElems to filterFound array\n\n    for (var i = 0; i < childImgs.length; i++) {\n      var img = childImgs[i];\n      this.addImage(img);\n    } // get child background images\n\n\n    if (typeof this.options.background == 'string') {\n      var children = elem.querySelectorAll(this.options.background);\n\n      for (i = 0; i < children.length; i++) {\n        var child = children[i];\n        this.addElementBackgroundImages(child);\n      }\n    }\n  };\n\n  var elementNodeTypes = {\n    1: true,\n    9: true,\n    11: true\n  };\n\n  ImagesLoaded.prototype.addElementBackgroundImages = function (elem) {\n    var style = getComputedStyle(elem);\n\n    if (!style) {\n      // Firefox returns null if in a hidden iframe https://bugzil.la/548397\n      return;\n    } // get url inside url(\"...\")\n\n\n    var reURL = /url\\((['\"])?(.*?)\\1\\)/gi;\n    var matches = reURL.exec(style.backgroundImage);\n\n    while (matches !== null) {\n      var url = matches && matches[2];\n\n      if (url) {\n        this.addBackground(url, elem);\n      }\n\n      matches = reURL.exec(style.backgroundImage);\n    }\n  };\n  /**\n   * @param {Image} img\n   */\n\n\n  ImagesLoaded.prototype.addImage = function (img) {\n    var loadingImage = new LoadingImage(img);\n    this.images.push(loadingImage);\n  };\n\n  ImagesLoaded.prototype.addBackground = function (url, elem) {\n    var background = new Background(url, elem);\n    this.images.push(background);\n  };\n\n  ImagesLoaded.prototype.check = function () {\n    var _this = this;\n\n    this.progressedCount = 0;\n    this.hasAnyBroken = false; // complete if no images\n\n    if (!this.images.length) {\n      this.complete();\n      return;\n    }\n\n    function onProgress(image, elem, message) {\n      // HACK - Chrome triggers event before object properties have changed. #83\n      setTimeout(function () {\n        _this.progress(image, elem, message);\n      });\n    }\n\n    this.images.forEach(function (loadingImage) {\n      loadingImage.once('progress', onProgress);\n      loadingImage.check();\n    });\n  };\n\n  ImagesLoaded.prototype.progress = function (image, elem, message) {\n    this.progressedCount++;\n    this.hasAnyBroken = this.hasAnyBroken || !image.isLoaded; // progress event\n\n    this.emitEvent('progress', [this, image, elem]);\n\n    if (this.jqDeferred && this.jqDeferred.notify) {\n      this.jqDeferred.notify(this, image);\n    } // check if completed\n\n\n    if (this.progressedCount == this.images.length) {\n      this.complete();\n    }\n\n    if (this.options.debug && console) {\n      console.log('progress: ' + message, image, elem);\n    }\n  };\n\n  ImagesLoaded.prototype.complete = function () {\n    var eventName = this.hasAnyBroken ? 'fail' : 'done';\n    this.isComplete = true;\n    this.emitEvent(eventName, [this]);\n    this.emitEvent('always', [this]);\n\n    if (this.jqDeferred) {\n      var jqMethod = this.hasAnyBroken ? 'reject' : 'resolve';\n      this.jqDeferred[jqMethod](this);\n    }\n  }; // --------------------------  -------------------------- //\n\n\n  function LoadingImage(img) {\n    this.img = img;\n  }\n\n  LoadingImage.prototype = Object.create(EvEmitter.prototype);\n\n  LoadingImage.prototype.check = function () {\n    // If complete is true and browser supports natural sizes,\n    // try to check for image status manually.\n    var isComplete = this.getIsImageComplete();\n\n    if (isComplete) {\n      // report based on naturalWidth\n      this.confirm(this.img.naturalWidth !== 0, 'naturalWidth');\n      return;\n    } // If none of the checks above matched, simulate loading on detached element.\n\n\n    this.proxyImage = new Image();\n    this.proxyImage.addEventListener('load', this);\n    this.proxyImage.addEventListener('error', this); // bind to image as well for Firefox. #191\n\n    this.img.addEventListener('load', this);\n    this.img.addEventListener('error', this);\n    this.proxyImage.src = this.img.src;\n  };\n\n  LoadingImage.prototype.getIsImageComplete = function () {\n    return this.img.complete && this.img.naturalWidth !== undefined;\n  };\n\n  LoadingImage.prototype.confirm = function (isLoaded, message) {\n    this.isLoaded = isLoaded;\n    this.emitEvent('progress', [this, this.img, message]);\n  }; // ----- events ----- //\n  // trigger specified handler for event type\n\n\n  LoadingImage.prototype.handleEvent = function (event) {\n    var method = 'on' + event.type;\n\n    if (this[method]) {\n      this[method](event);\n    }\n  };\n\n  LoadingImage.prototype.onload = function () {\n    this.confirm(true, 'onload');\n    this.unbindEvents();\n  };\n\n  LoadingImage.prototype.onerror = function () {\n    this.confirm(false, 'onerror');\n    this.unbindEvents();\n  };\n\n  LoadingImage.prototype.unbindEvents = function () {\n    this.proxyImage.removeEventListener('load', this);\n    this.proxyImage.removeEventListener('error', this);\n    this.img.removeEventListener('load', this);\n    this.img.removeEventListener('error', this);\n  }; // -------------------------- Background -------------------------- //\n\n\n  function Background(url, element) {\n    this.url = url;\n    this.element = element;\n    this.img = new Image();\n  } // inherit LoadingImage prototype\n\n\n  Background.prototype = Object.create(LoadingImage.prototype);\n\n  Background.prototype.check = function () {\n    this.img.addEventListener('load', this);\n    this.img.addEventListener('error', this);\n    this.img.src = this.url; // check if image is already complete\n\n    var isComplete = this.getIsImageComplete();\n\n    if (isComplete) {\n      this.confirm(this.img.naturalWidth !== 0, 'naturalWidth');\n      this.unbindEvents();\n    }\n  };\n\n  Background.prototype.unbindEvents = function () {\n    this.img.removeEventListener('load', this);\n    this.img.removeEventListener('error', this);\n  };\n\n  Background.prototype.confirm = function (isLoaded, message) {\n    this.isLoaded = isLoaded;\n    this.emitEvent('progress', [this, this.element, message]);\n  }; // -------------------------- jQuery -------------------------- //\n\n\n  ImagesLoaded.makeJQueryPlugin = function (jQuery) {\n    jQuery = jQuery || window.jQuery;\n\n    if (!jQuery) {\n      return;\n    } // set local variable\n\n\n    $ = jQuery; // $().imagesLoaded()\n\n    $.fn.imagesLoaded = function (options, callback) {\n      var instance = new ImagesLoaded(this, options, callback);\n      return instance.jqDeferred.promise($(this));\n    };\n  }; // try making plugin\n\n\n  ImagesLoaded.makeJQueryPlugin(); // --------------------------  -------------------------- //\n\n  return ImagesLoaded;\n});","map":{"version":3,"sources":["/Users/david/Winner-Stock/app/javascript/packs/infinite-scroll.js"],"names":["window","factory","define","amd","jQuery","module","exports","require","jQueryBridget","arraySlice","Array","prototype","slice","console","logError","message","error","namespace","PluginClass","$","option","opts","isPlainObject","options","extend","fn","arg0","args","call","arguments","methodCall","plainCall","$elems","methodName","returnValue","pluginMethodStr","each","i","elem","instance","data","method","charAt","value","apply","undefined","_init","updateJQuery","bridget","global","EvEmitter","proto","on","eventName","listener","events","_events","listeners","indexOf","push","once","onceEvents","_onceEvents","onceListeners","off","length","index","splice","emitEvent","isOnce","allOff","removeAllListeners","matchesSelector","matchesMethod","ElemProto","Element","matches","prefixes","prefix","selector","fizzyUIUtils","utils","a","b","prop","modulo","num","div","makeArray","obj","ary","isArray","removeFrom","getParent","parentNode","document","body","getQueryElement","querySelector","handleEvent","event","type","filterFindElements","elems","ffElems","forEach","HTMLElement","childElems","querySelectorAll","debounceMethod","_class","threshold","timeoutName","timeout","clearTimeout","_this","setTimeout","docReady","callback","readyState","addEventListener","toDashed","str","replace","match","$1","$2","toLowerCase","htmlInit","WidgetClass","dashedNamespace","dataAttr","dataAttrElems","jsDashElems","concat","dataOptionsAttr","attr","getAttribute","JSON","parse","className","InfiniteScroll","instances","element","queryElem","infiniteScrollGUID","defaults","$element","create","destroy","GUID","id","guid","pageIndex","loadCount","updateGetPath","getPath","updateGetAbsolutePath","log","callOnInit","onInit","dispatchEvent","emitArgs","$event","jQEvent","Event","trigger","loggers","initialized","request","path","load","response","title","append","items","last","history","origin","debug","logger","updateMeasurements","windowHeight","innerHeight","rect","getBoundingClientRect","top","pageYOffset","updateScroller","elementScroll","scroller","optPath","templateMatch","updateGetPathTemplate","updateGetPathSelector","nextIndex","bind","regexString","templateRe","RegExp","location","href","parseInt","pathRegexes","hrefElem","pathParts","regex","isPathSelector","isAbsolute","getAbsolutePath","pathname","directory","substring","lastIndexOf","hideNav","nav","style","display","throttle","now","Date","setJQuery","loadOnScroll","checkLastPage","responseType","pageLoad","canLoad","onScrollThresholdLoad","outlayer","onAppendOutlayer","loadNextPage","isLoading","onLoad","onPageLoad","onError","onPageError","appendNextPage","optAppend","isDocument","fragment","getItemsFragment","appendReady","appendItems","appendOutlayerItems","refreshScripts","appendChild","createDocumentFragment","scripts","script","freshScript","createElement","copyAttributes","replaceChild","fromNode","toNode","attrs","attributes","setAttribute","name","imagesLoaded","appended","pathOpt","nextPath","lastPageReached","nextElem","prefill","isPrefilling","stopPrefill","distance","getPrefillDistance","clientHeight","scrollHeight","url","req","XMLHttpRequest","open","setRequestHeader","onload","status","Error","statusText","onerror","send","scrollThreshold","scrollWatch","pageScrollHandler","onPageScroll","resizeHandler","onResize","isEnable","enableScrollWatch","disableScrollWatch","isScrollWatching","bindScrollWatchEvents","isBind","addRemove","getBottomDistance","getElementBottomDistance","getWindowBottomDistance","bottom","scrollY","scrollTop","link","linkOrigin","protocol","host","isSameOrigin","createHistoryAppend","createHistoryPageLoad","scrollPages","scrollPageIndex","scrollHistoryHandler","onScrollHistory","unloadHandler","onUnload","onAppendHistory","bindHistoryAppendEvents","onPageLoadHistory","destroyHistory","isHistoryAppend","firstItem","elemScrollY","getElementScrollY","getElementElementScrollY","getElementWindowScrollY","offsetTop","scrollViewY","getScrollViewY","page","scrollPage","setHistory","optHistory","historyMethod","historyTitle","scrollTo","button","buttonElem","InfiniteScrollButton","infScroll","clickHandler","onClick","disable","enable","hide","preventDefault","removeAttribute","disabled","removeEventListener","Button","statusElem","statusElement","statusEventElements","showRequestStatus","showErrorStatus","showLastStatus","bindHideStatus","bindMethod","hideEvent","hideAllStatus","showStatus","show","hideStatusEventElements","eventElem","setDisplay","ImagesLoaded","onAlways","elements","getImages","jqDeferred","Deferred","check","Object","images","addElementImages","nodeName","addImage","background","addElementBackgroundImages","nodeType","elementNodeTypes","childImgs","img","children","child","getComputedStyle","reURL","exec","backgroundImage","addBackground","loadingImage","LoadingImage","Background","progressedCount","hasAnyBroken","complete","onProgress","image","progress","isLoaded","notify","isComplete","jqMethod","getIsImageComplete","confirm","naturalWidth","proxyImage","Image","src","unbindEvents","makeJQueryPlugin","promise"],"mappings":"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","sourcesContent":["/*!\n * Infinite Scroll PACKAGED v3.0.2\n * Automatically add next page\n *\n * Licensed GPLv3 for open source use\n * or Infinite Scroll Commercial License for commercial use\n *\n * https://infinite-scroll.com\n * Copyright 2017 Metafizzy\n */\n\n/**\n * Bridget makes jQuery widgets\n * v2.0.1\n * MIT license\n */\n\n/* jshint browser: true, strict: true, undef: true, unused: true */\n\n( function( window, factory ) {\n  // universal module definition\n  /*jshint strict: false */ /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'jquery-bridget/jquery-bridget',[ 'jquery' ], function( jQuery ) {\n      return factory( window, jQuery );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('jquery')\n    );\n  } else {\n    // browser global\n    window.jQueryBridget = factory(\n      window,\n      window.jQuery\n    );\n  }\n\n}( window, function factory( window, jQuery ) {\n'use strict';\n\n// ----- utils ----- //\n\nvar arraySlice = Array.prototype.slice;\n\n// helper function for logging errors\n// $.error breaks jQuery chaining\nvar console = window.console;\nvar logError = typeof console == 'undefined' ? function() {} :\n  function( message ) {\n    console.error( message );\n  };\n\n// ----- jQueryBridget ----- //\n\nfunction jQueryBridget( namespace, PluginClass, $ ) {\n  $ = $ || jQuery || window.jQuery;\n  if ( !$ ) {\n    return;\n  }\n\n  // add option method -> $().plugin('option', {...})\n  if ( !PluginClass.prototype.option ) {\n    // option setter\n    PluginClass.prototype.option = function( opts ) {\n      // bail out if not an object\n      if ( !$.isPlainObject( opts ) ){\n        return;\n      }\n      this.options = $.extend( true, this.options, opts );\n    };\n  }\n\n  // make jQuery plugin\n  $.fn[ namespace ] = function( arg0 /*, arg1 */ ) {\n    if ( typeof arg0 == 'string' ) {\n      // method call $().plugin( 'methodName', { options } )\n      // shift arguments by 1\n      var args = arraySlice.call( arguments, 1 );\n      return methodCall( this, arg0, args );\n    }\n    // just $().plugin({ options })\n    plainCall( this, arg0 );\n    return this;\n  };\n\n  // $().plugin('methodName')\n  function methodCall( $elems, methodName, args ) {\n    var returnValue;\n    var pluginMethodStr = '$().' + namespace + '(\"' + methodName + '\")';\n\n    $elems.each( function( i, elem ) {\n      // get instance\n      var instance = $.data( elem, namespace );\n      if ( !instance ) {\n        logError( namespace + ' not initialized. Cannot call methods, i.e. ' +\n          pluginMethodStr );\n        return;\n      }\n\n      var method = instance[ methodName ];\n      if ( !method || methodName.charAt(0) == '_' ) {\n        logError( pluginMethodStr + ' is not a valid method' );\n        return;\n      }\n\n      // apply method, get return value\n      var value = method.apply( instance, args );\n      // set return value if value is returned, use only first value\n      returnValue = returnValue === undefined ? value : returnValue;\n    });\n\n    return returnValue !== undefined ? returnValue : $elems;\n  }\n\n  function plainCall( $elems, options ) {\n    $elems.each( function( i, elem ) {\n      var instance = $.data( elem, namespace );\n      if ( instance ) {\n        // set options & init\n        instance.option( options );\n        instance._init();\n      } else {\n        // initialize new instance\n        instance = new PluginClass( elem, options );\n        $.data( elem, namespace, instance );\n      }\n    });\n  }\n\n  updateJQuery( $ );\n\n}\n\n// ----- updateJQuery ----- //\n\n// set $.bridget for v1 backwards compatibility\nfunction updateJQuery( $ ) {\n  if ( !$ || ( $ && $.bridget ) ) {\n    return;\n  }\n  $.bridget = jQueryBridget;\n}\n\nupdateJQuery( jQuery || window.jQuery );\n\n// -----  ----- //\n\nreturn jQueryBridget;\n\n}));\n\n/**\n * EvEmitter v1.1.0\n * Lil' event emitter\n * MIT License\n */\n\n/* jshint unused: true, undef: true, strict: true */\n\n( function( global, factory ) {\n  // universal module definition\n  /* jshint strict: false */ /* globals define, module, window */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD - RequireJS\n    define( 'ev-emitter/ev-emitter',factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS - Browserify, Webpack\n    module.exports = factory();\n  } else {\n    // Browser globals\n    global.EvEmitter = factory();\n  }\n\n}( typeof window != 'undefined' ? window : this, function() {\n\n\n\nfunction EvEmitter() {}\n\nvar proto = EvEmitter.prototype;\n\nproto.on = function( eventName, listener ) {\n  if ( !eventName || !listener ) {\n    return;\n  }\n  // set events hash\n  var events = this._events = this._events || {};\n  // set listeners array\n  var listeners = events[ eventName ] = events[ eventName ] || [];\n  // only add once\n  if ( listeners.indexOf( listener ) == -1 ) {\n    listeners.push( listener );\n  }\n\n  return this;\n};\n\nproto.once = function( eventName, listener ) {\n  if ( !eventName || !listener ) {\n    return;\n  }\n  // add event\n  this.on( eventName, listener );\n  // set once flag\n  // set onceEvents hash\n  var onceEvents = this._onceEvents = this._onceEvents || {};\n  // set onceListeners object\n  var onceListeners = onceEvents[ eventName ] = onceEvents[ eventName ] || {};\n  // set flag\n  onceListeners[ listener ] = true;\n\n  return this;\n};\n\nproto.off = function( eventName, listener ) {\n  var listeners = this._events && this._events[ eventName ];\n  if ( !listeners || !listeners.length ) {\n    return;\n  }\n  var index = listeners.indexOf( listener );\n  if ( index != -1 ) {\n    listeners.splice( index, 1 );\n  }\n\n  return this;\n};\n\nproto.emitEvent = function( eventName, args ) {\n  var listeners = this._events && this._events[ eventName ];\n  if ( !listeners || !listeners.length ) {\n    return;\n  }\n  var i = 0;\n  var listener = listeners[i];\n  args = args || [];\n  // once stuff\n  var onceListeners = this._onceEvents && this._onceEvents[ eventName ];\n\n  while ( listener ) {\n    var isOnce = onceListeners && onceListeners[ listener ];\n    if ( isOnce ) {\n      // remove listener\n      // remove before trigger to prevent recursion\n      this.off( eventName, listener );\n      // unset once flag\n      delete onceListeners[ listener ];\n    }\n    // trigger listener\n    listener.apply( this, args );\n    // get next listener\n    i += isOnce ? 0 : 1;\n    listener = listeners[i];\n  }\n\n  return this;\n};\n\nproto.allOff =\nproto.removeAllListeners = function() {\n  delete this._events;\n  delete this._onceEvents;\n};\n\nreturn EvEmitter;\n\n}));\n\n/**\n * matchesSelector v2.0.2\n * matchesSelector( element, '.selector' )\n * MIT license\n */\n\n/*jshint browser: true, strict: true, undef: true, unused: true */\n\n( function( window, factory ) {\n  /*global define: false, module: false */\n  'use strict';\n  // universal module definition\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'desandro-matches-selector/matches-selector',factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory();\n  } else {\n    // browser global\n    window.matchesSelector = factory();\n  }\n\n}( window, function factory() {\n  'use strict';\n\n  var matchesMethod = ( function() {\n    var ElemProto = window.Element.prototype;\n    // check for the standard method name first\n    if ( ElemProto.matches ) {\n      return 'matches';\n    }\n    // check un-prefixed\n    if ( ElemProto.matchesSelector ) {\n      return 'matchesSelector';\n    }\n    // check vendor prefixes\n    var prefixes = [ 'webkit', 'moz', 'ms', 'o' ];\n\n    for ( var i=0; i < prefixes.length; i++ ) {\n      var prefix = prefixes[i];\n      var method = prefix + 'MatchesSelector';\n      if ( ElemProto[ method ] ) {\n        return method;\n      }\n    }\n  })();\n\n  return function matchesSelector( elem, selector ) {\n    return elem[ matchesMethod ]( selector );\n  };\n\n}));\n\n/**\n * Fizzy UI utils v2.0.5\n * MIT license\n */\n\n/*jshint browser: true, undef: true, unused: true, strict: true */\n\n( function( window, factory ) {\n  // universal module definition\n  /*jshint strict: false */ /*globals define, module, require */\n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'fizzy-ui-utils/utils',[\n      'desandro-matches-selector/matches-selector'\n    ], function( matchesSelector ) {\n      return factory( window, matchesSelector );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('desandro-matches-selector')\n    );\n  } else {\n    // browser global\n    window.fizzyUIUtils = factory(\n      window,\n      window.matchesSelector\n    );\n  }\n\n}( window, function factory( window, matchesSelector ) {\n\n\n\nvar utils = {};\n\n// ----- extend ----- //\n\n// extends objects\nutils.extend = function( a, b ) {\n  for ( var prop in b ) {\n    a[ prop ] = b[ prop ];\n  }\n  return a;\n};\n\n// ----- modulo ----- //\n\nutils.modulo = function( num, div ) {\n  return ( ( num % div ) + div ) % div;\n};\n\n// ----- makeArray ----- //\n\n// turn element or nodeList into an array\nutils.makeArray = function( obj ) {\n  var ary = [];\n  if ( Array.isArray( obj ) ) {\n    // use object if already an array\n    ary = obj;\n  } else if ( obj && typeof obj == 'object' &&\n    typeof obj.length == 'number' ) {\n    // convert nodeList to array\n    for ( var i=0; i < obj.length; i++ ) {\n      ary.push( obj[i] );\n    }\n  } else {\n    // array of single index\n    ary.push( obj );\n  }\n  return ary;\n};\n\n// ----- removeFrom ----- //\n\nutils.removeFrom = function( ary, obj ) {\n  var index = ary.indexOf( obj );\n  if ( index != -1 ) {\n    ary.splice( index, 1 );\n  }\n};\n\n// ----- getParent ----- //\n\nutils.getParent = function( elem, selector ) {\n  while ( elem.parentNode && elem != document.body ) {\n    elem = elem.parentNode;\n    if ( matchesSelector( elem, selector ) ) {\n      return elem;\n    }\n  }\n};\n\n// ----- getQueryElement ----- //\n\n// use element as selector string\nutils.getQueryElement = function( elem ) {\n  if ( typeof elem == 'string' ) {\n    return document.querySelector( elem );\n  }\n  return elem;\n};\n\n// ----- handleEvent ----- //\n\n// enable .ontype to trigger from .addEventListener( elem, 'type' )\nutils.handleEvent = function( event ) {\n  var method = 'on' + event.type;\n  if ( this[ method ] ) {\n    this[ method ]( event );\n  }\n};\n\n// ----- filterFindElements ----- //\n\nutils.filterFindElements = function( elems, selector ) {\n  // make array of elems\n  elems = utils.makeArray( elems );\n  var ffElems = [];\n\n  elems.forEach( function( elem ) {\n    // check that elem is an actual element\n    if ( !( elem instanceof HTMLElement ) ) {\n      return;\n    }\n    // add elem if no selector\n    if ( !selector ) {\n      ffElems.push( elem );\n      return;\n    }\n    // filter & find items if we have a selector\n    // filter\n    if ( matchesSelector( elem, selector ) ) {\n      ffElems.push( elem );\n    }\n    // find children\n    var childElems = elem.querySelectorAll( selector );\n    // concat childElems to filterFound array\n    for ( var i=0; i < childElems.length; i++ ) {\n      ffElems.push( childElems[i] );\n    }\n  });\n\n  return ffElems;\n};\n\n// ----- debounceMethod ----- //\n\nutils.debounceMethod = function( _class, methodName, threshold ) {\n  // original method\n  var method = _class.prototype[ methodName ];\n  var timeoutName = methodName + 'Timeout';\n\n  _class.prototype[ methodName ] = function() {\n    var timeout = this[ timeoutName ];\n    if ( timeout ) {\n      clearTimeout( timeout );\n    }\n    var args = arguments;\n\n    var _this = this;\n    this[ timeoutName ] = setTimeout( function() {\n      method.apply( _this, args );\n      delete _this[ timeoutName ];\n    }, threshold || 100 );\n  };\n};\n\n// ----- docReady ----- //\n\nutils.docReady = function( callback ) {\n  var readyState = document.readyState;\n  if ( readyState == 'complete' || readyState == 'interactive' ) {\n    // do async to allow for other scripts to run. metafizzy/flickity#441\n    setTimeout( callback );\n  } else {\n    document.addEventListener( 'DOMContentLoaded', callback );\n  }\n};\n\n// ----- htmlInit ----- //\n\n// http://jamesroberts.name/blog/2010/02/22/string-functions-for-javascript-trim-to-camel-case-to-dashed-and-to-underscore/\nutils.toDashed = function( str ) {\n  return str.replace( /(.)([A-Z])/g, function( match, $1, $2 ) {\n    return $1 + '-' + $2;\n  }).toLowerCase();\n};\n\nvar console = window.console;\n/**\n * allow user to initialize classes via [data-namespace] or .js-namespace class\n * htmlInit( Widget, 'widgetName' )\n * options are parsed from data-namespace-options\n */\nutils.htmlInit = function( WidgetClass, namespace ) {\n  utils.docReady( function() {\n    var dashedNamespace = utils.toDashed( namespace );\n    var dataAttr = 'data-' + dashedNamespace;\n    var dataAttrElems = document.querySelectorAll( '[' + dataAttr + ']' );\n    var jsDashElems = document.querySelectorAll( '.js-' + dashedNamespace );\n    var elems = utils.makeArray( dataAttrElems )\n      .concat( utils.makeArray( jsDashElems ) );\n    var dataOptionsAttr = dataAttr + '-options';\n    var jQuery = window.jQuery;\n\n    elems.forEach( function( elem ) {\n      var attr = elem.getAttribute( dataAttr ) ||\n        elem.getAttribute( dataOptionsAttr );\n      var options;\n      try {\n        options = attr && JSON.parse( attr );\n      } catch ( error ) {\n        // log error, do not initialize\n        if ( console ) {\n          console.error( 'Error parsing ' + dataAttr + ' on ' + elem.className +\n          ': ' + error );\n        }\n        return;\n      }\n      // initialize\n      var instance = new WidgetClass( elem, options );\n      // make available via $().data('namespace')\n      if ( jQuery ) {\n        jQuery.data( elem, namespace, instance );\n      }\n    });\n\n  });\n};\n\n// -----  ----- //\n\nreturn utils;\n\n}));\n\n// core\n( function( window, factory ) {\n  // universal module definition\n  /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'infinite-scroll/js/core',[\n      'ev-emitter/ev-emitter',\n      'fizzy-ui-utils/utils',\n    ], function( EvEmitter, utils) {\n      return factory( window, EvEmitter, utils );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('ev-emitter'),\n      require('fizzy-ui-utils')\n    );\n  } else {\n    // browser global\n    window.InfiniteScroll = factory(\n      window,\n      window.EvEmitter,\n      window.fizzyUIUtils\n    );\n  }\n\n}( window, function factory( window, EvEmitter, utils ) {\n\nvar jQuery = window.jQuery;\n// internal store of all InfiniteScroll intances\nvar instances = {};\n\nfunction InfiniteScroll( element, options ) {\n  var queryElem = utils.getQueryElement( element );\n\n  if ( !queryElem ) {\n    console.error( 'Bad element for InfiniteScroll: ' + ( queryElem || element ) );\n    return;\n  }\n  element = queryElem;\n  // do not initialize twice on same element\n  if ( element.infiniteScrollGUID ) {\n    var instance = instances[ element.infiniteScrollGUID ];\n    instance.option( options );\n    return instance;\n  }\n\n  this.element = element;\n  // options\n  this.options = utils.extend( {}, InfiniteScroll.defaults );\n  this.option( options );\n  // add jQuery\n  if ( jQuery ) {\n    this.$element = jQuery( this.element );\n  }\n\n  this.create();\n}\n\n// defaults\nInfiniteScroll.defaults = {\n  // path: null,\n  // hideNav: null,\n  // debug: false,\n};\n\n// create & destroy methods\nInfiniteScroll.create = {};\nInfiniteScroll.destroy = {};\n\nvar proto = InfiniteScroll.prototype;\n// inherit EvEmitter\nutils.extend( proto, EvEmitter.prototype );\n\n// --------------------------  -------------------------- //\n\n// globally unique identifiers\nvar GUID = 0;\n\nproto.create = function() {\n  // create core\n  // add id for InfiniteScroll.data\n  var id = this.guid = ++GUID;\n  this.element.infiniteScrollGUID = id; // expando\n  instances[ id ] = this; // associate via id\n  // properties\n  this.pageIndex = 1; // default to first page\n  this.loadCount = 0;\n  this.updateGetPath();\n  // bail if getPath not set\n  if ( !this.getPath ) {\n    console.error('Disabling InfiniteScroll');\n    return;\n  }\n  this.updateGetAbsolutePath();\n  this.log( 'initialized', [ this.element.className ] );\n  this.callOnInit();\n  // create features\n  for ( var method in InfiniteScroll.create ) {\n    InfiniteScroll.create[ method ].call( this );\n  }\n};\n\nproto.option = function( opts ) {\n  utils.extend( this.options, opts );\n};\n\n// call onInit option, used for binding events on init\nproto.callOnInit = function() {\n  var onInit = this.options.onInit;\n  if ( onInit ) {\n    onInit.call( this, this );\n  }\n};\n\n// ----- events ----- //\n\nproto.dispatchEvent = function( type, event, args ) {\n  this.log( type, args );\n  var emitArgs = event ? [ event ].concat( args ) : args;\n  this.emitEvent( type, emitArgs );\n  // trigger jQuery event\n  if ( !jQuery || !this.$element ) {\n    return;\n  }\n  // namespace jQuery event\n  type += '.infiniteScroll';\n  var $event = type;\n  if ( event ) {\n    // create jQuery event\n    var jQEvent = jQuery.Event( event );\n    jQEvent.type = type;\n    $event = jQEvent;\n  }\n  this.$element.trigger( $event, args );\n};\n\nvar loggers = {\n  initialized: function( className ) {\n    return 'on ' + className;\n  },\n  request: function( path ) {\n    return 'URL: ' + path;\n  },\n  load: function( response, path ) {\n    return ( response.title || '' ) + '. URL: ' + path;\n  },\n  error: function( error, path ) {\n    return error + '. URL: ' + path;\n  },\n  append: function( response, path, items ) {\n    return items.length + ' items. URL: ' + path;\n  },\n  last: function( response, path ) {\n    return 'URL: ' + path;\n  },\n  history: function( title, path ) {\n    return 'URL: ' + path;\n  },\n  pageIndex: function( index, origin ) {\n    return 'current page determined to be: ' + index + ' from ' + origin;\n  },\n};\n\n// log events\nproto.log = function( type, args ) {\n  if ( !this.options.debug ) {\n    return;\n  }\n  var message = '[InfiniteScroll] ' + type;\n  var logger = loggers[ type ];\n  if ( logger ) {\n    message += '. ' + logger.apply( this, args );\n  }\n  console.log( message );\n};\n\n// -------------------------- methods used amoung features -------------------------- //\n\nproto.updateMeasurements = function() {\n  this.windowHeight = window.innerHeight;\n  var rect = this.element.getBoundingClientRect();\n  this.top = rect.top + window.pageYOffset;\n};\n\nproto.updateScroller = function() {\n  var elementScroll = this.options.elementScroll;\n  if ( !elementScroll ) {\n    // default, use window\n    this.scroller = window;\n    return;\n  }\n  // if true, set to element, otherwise use option\n  this.scroller = elementScroll === true ? this.element :\n    utils.getQueryElement( elementScroll );\n  if ( !this.scroller ) {\n    throw 'Unable to find elementScroll: ' + elementScroll;\n  }\n};\n\n// -------------------------- page path -------------------------- //\n\nproto.updateGetPath = function() {\n  var optPath = this.options.path;\n  if ( !optPath ) {\n    console.error( 'InfiniteScroll path option required. Set as: ' + optPath );\n    return;\n  }\n  // function\n  var type = typeof optPath;\n  if ( type == 'function' ) {\n    this.getPath = optPath;\n    return;\n  }\n  // template string: '/pages/{{#}}.html'\n  var templateMatch = type == 'string' && optPath.match('{{#}}');\n  if ( templateMatch ) {\n    this.updateGetPathTemplate( optPath );\n    return;\n  }\n  // selector: '.next-page-selector'\n  this.updateGetPathSelector( optPath );\n};\n\nproto.updateGetPathTemplate = function( optPath ) {\n  // set getPath with template string\n  this.getPath = function() {\n    var nextIndex = this.pageIndex + 1;\n    return optPath.replace( '{{#}}', nextIndex );\n  }.bind( this );\n  // get pageIndex from location\n  // convert path option into regex to look for pattern in location\n  var regexString = optPath.replace( '{{#}}', '(\\\\d\\\\d?\\\\d?)' );\n  var templateRe = new RegExp( regexString );\n  var match = location.href.match( templateRe );\n  if ( match ) {\n    this.pageIndex = parseInt( match[1], 10 );\n    this.log( 'pageIndex', this.pageIndex, 'template string' );\n  }\n};\n\nvar pathRegexes = [\n  // WordPress & Tumblr - example.com/page/2\n  // Jekyll - example.com/page2\n  /^(.*?\\/?page\\/?)(\\d\\d?\\d?)(.*?$)/,\n  // Drupal - example.com/?page=1\n  /^(.*?\\/?\\?page=)(\\d\\d?\\d?)(.*?$)/,\n  // catch all, last occurence of a number\n  /(.*?)(\\d\\d?\\d?)(?!.*\\d)(.*?$)/,\n];\n\nproto.updateGetPathSelector = function( optPath ) {\n  // parse href of link: '.next-page-link'\n  var hrefElem = document.querySelector( optPath );\n  if ( !hrefElem ) {\n    console.error( 'Bad InfiniteScroll path option. Next link not found: ' +\n      optPath );\n    return;\n  }\n  var href = hrefElem.getAttribute('href');\n  // try matching href to pathRegexes patterns\n  var pathParts, regex;\n  for ( var i=0; href && i < pathRegexes.length; i++ ) {\n    regex = pathRegexes[i];\n    var match = href.match( regex );\n    if ( match ) {\n      pathParts = match.slice(1); // remove first part\n      break;\n    }\n  }\n  if ( !pathParts ) {\n    console.error( 'InfiniteScroll unable to parse next link href: ' + href );\n    return;\n  }\n  this.isPathSelector = true; // flag for checkLastPage()\n  this.getPath = function() {\n    var nextIndex = this.pageIndex + 1;\n    return pathParts[0] + nextIndex + pathParts[2];\n  }.bind( this );\n  // get pageIndex from href\n  this.pageIndex = parseInt( pathParts[1], 10 ) - 1;\n  this.log( 'pageIndex', [ this.pageIndex, 'next link' ] );\n};\n\nproto.updateGetAbsolutePath = function() {\n  var path = this.getPath();\n  // path doesn't start with http or /\n  var isAbsolute = path.match( /^http/ ) || path.match( /^\\// );\n  if ( isAbsolute ) {\n    this.getAbsolutePath = this.getPath;\n    return;\n  }\n\n  var pathname = location.pathname;\n  // /foo/bar/index.html => /foo/bar\n  var directory = pathname.substring( 0, pathname.lastIndexOf('/') );\n\n  this.getAbsolutePath = function() {\n    return directory + '/' + this.getPath();\n  };\n};\n\n// -------------------------- nav -------------------------- //\n\n// hide navigation\nInfiniteScroll.create.hideNav = function() {\n  var nav = utils.getQueryElement( this.options.hideNav );\n  if ( !nav ) {\n    return;\n  }\n  nav.style.display = 'none';\n  this.nav = nav;\n};\n\nInfiniteScroll.destroy.hideNav = function() {\n  if ( this.nav ) {\n    this.nav.style.display = '';\n  }\n};\n\n// -------------------------- destroy -------------------------- //\n\nproto.destroy = function() {\n  this.allOff(); // remove all event listeners\n  // call destroy methods\n  for ( var method in InfiniteScroll.destroy ) {\n    InfiniteScroll.destroy[ method ].call( this );\n  }\n\n  delete this.element.infiniteScrollGUID;\n  delete instances[ this.guid ];\n};\n\n// -------------------------- utilities -------------------------- //\n\n// https://remysharp.com/2010/07/21/throttling-function-calls\nInfiniteScroll.throttle = function( fn, threshold ) {\n  threshold = threshold || 200;\n  var last, timeout;\n\n  return function() {\n    var now = +new Date();\n    var args = arguments;\n    var trigger = function() {\n      last = now;\n      fn.apply( this, args );\n    }.bind( this );\n    if ( last && now < last + threshold ) {\n      // hold on to it\n      clearTimeout( timeout );\n      timeout = setTimeout( trigger, threshold );\n    } else {\n      trigger();\n    }\n  };\n};\n\nInfiniteScroll.data = function( elem ) {\n  elem = utils.getQueryElement( elem );\n  var id = elem && elem.infiniteScrollGUID;\n  return id && instances[ id ];\n};\n\n// set internal jQuery, for Webpack + jQuery v3\nInfiniteScroll.setJQuery = function( $ ) {\n  jQuery = $;\n};\n\n// -------------------------- setup -------------------------- //\n\nutils.htmlInit( InfiniteScroll, 'infinite-scroll' );\n\nif ( jQuery && jQuery.bridget ) {\n  jQuery.bridget( 'infiniteScroll', InfiniteScroll );\n}\n\n// --------------------------  -------------------------- //\n\nreturn InfiniteScroll;\n\n}));\n\n// page-load\n( function( window, factory ) {\n  // universal module definition\n  /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'infinite-scroll/js/page-load',[\n      './core',\n    ], function( InfiniteScroll ) {\n      return factory( window, InfiniteScroll );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('./core')\n    );\n  } else {\n    // browser global\n    factory(\n      window,\n      window.InfiniteScroll\n    );\n  }\n\n}( window, function factory( window, InfiniteScroll ) {\n\nvar proto = InfiniteScroll.prototype;\n\n// InfiniteScroll.defaults.append = false;\nInfiniteScroll.defaults.loadOnScroll = true;\nInfiniteScroll.defaults.checkLastPage = true;\nInfiniteScroll.defaults.responseType = 'document';\n// InfiniteScroll.defaults.prefill = false;\n// InfiniteScroll.defaults.outlayer = null;\n\nInfiniteScroll.create.pageLoad = function() {\n  this.canLoad = true;\n  this.on( 'scrollThreshold', this.onScrollThresholdLoad );\n  this.on( 'append', this.checkLastPage );\n  if ( this.options.outlayer ) {\n    this.on( 'append', this.onAppendOutlayer );\n  }\n};\n\nproto.onScrollThresholdLoad = function() {\n  if ( this.options.loadOnScroll ) {\n    this.loadNextPage();\n  }\n};\n\nproto.loadNextPage = function() {\n  if ( this.isLoading || !this.canLoad ) {\n    return;\n  }\n\n  var path = this.getAbsolutePath();\n  this.isLoading = true;\n\n  var onLoad = function( response ) {\n    this.onPageLoad( response, path );\n  }.bind( this );\n\n  var onError = function( error ) {\n    this.onPageError( error, path );\n  }.bind( this );\n\n  request( path, this.options.responseType, onLoad, onError );\n  this.dispatchEvent( 'request', null, [ path ] );\n};\n\nproto.onPageLoad = function( response, path ) {\n  // done loading if not appending\n  if ( !this.options.append ) {\n    this.isLoading = false;\n  }\n  this.pageIndex++;\n  this.loadCount++;\n  this.dispatchEvent( 'load', null, [ response, path ] );\n  this.appendNextPage( response, path );\n  return response;\n};\n\nproto.appendNextPage = function( response, path ) {\n  var optAppend = this.options.append;\n  // do not append json\n  var isDocument = this.options.responseType == 'document';\n  if ( !isDocument || !optAppend ) {\n    return;\n  }\n\n  var items = response.querySelectorAll( optAppend );\n  var fragment = getItemsFragment( items );\n  var appendReady = function () {\n    this.appendItems( items, fragment );\n    this.isLoading = false;\n    this.dispatchEvent( 'append', null, [ response, path, items ] );\n  }.bind( this );\n\n  // TODO add hook for option to trigger appendReady\n  if ( this.options.outlayer ) {\n    this.appendOutlayerItems( fragment, appendReady );\n  } else {\n    appendReady();\n  }\n};\n\nproto.appendItems = function( items, fragment ) {\n  if ( !items || !items.length ) {\n    return;\n  }\n  // get fragment if not provided\n  fragment = fragment || getItemsFragment( items );\n  refreshScripts( fragment );\n  this.element.appendChild( fragment );\n};\n\nfunction getItemsFragment( items ) {\n  // add items to fragment\n  var fragment = document.createDocumentFragment();\n  for ( var i=0; items && i < items.length; i++ ) {\n    fragment.appendChild( items[i] );\n  }\n  return fragment;\n}\n\n// replace <script>s with copies so they load\n// <script>s added by InfiniteScroll will not load\n// similar to https://stackoverflow.com/questions/610995\nfunction refreshScripts( fragment ) {\n  var scripts = fragment.querySelectorAll('script');\n  for ( var i=0; i < scripts.length; i++ ) {\n    var script = scripts[i];\n    var freshScript = document.createElement('script');\n    copyAttributes( script, freshScript );\n    script.parentNode.replaceChild( freshScript, script );\n  }\n}\n\nfunction copyAttributes( fromNode, toNode ) {\n  var attrs = fromNode.attributes;\n  for ( var i=0; i < attrs.length; i++ ) {\n    var attr = attrs[i];\n    toNode.setAttribute( attr.name, attr.value );\n  }\n}\n\n// ----- outlayer ----- //\n\nproto.appendOutlayerItems = function( fragment, appendReady ) {\n  var imagesLoaded = InfiniteScroll.imagesLoaded || window.imagesLoaded;\n  if ( !imagesLoaded ) {\n    console.error('[InfiniteScroll] imagesLoaded required for outlayer option');\n    this.isLoading = false;\n    return;\n  }\n  // append once images loaded\n  imagesLoaded( fragment, appendReady );\n};\n\nproto.onAppendOutlayer = function( response, path, items ) {\n  this.options.outlayer.appended( items );\n};\n\n// ----- checkLastPage ----- //\n\n// check response for next element\nproto.checkLastPage = function( response, path ) {\n  var checkLastPage = this.options.checkLastPage;\n  if ( !checkLastPage ) {\n    return;\n  }\n\n  var pathOpt = this.options.path;\n  // if path is function, check if next path is truthy\n  if ( typeof pathOpt == 'function' ) {\n    var nextPath = this.getPath();\n    if ( !nextPath ) {\n      this.lastPageReached( response, path );\n      return;\n    }\n  }\n  // get selector from checkLastPage or path option\n  var selector;\n  if ( typeof checkLastPage == 'string' ) {\n    selector = checkLastPage;\n  } else if ( this.isPathSelector ) {\n    // path option is selector string\n    selector = pathOpt;\n  }\n  // check last page for selector\n  // bail if no selector or not document response\n  if ( !selector || !response.querySelector ) {\n    return;\n  }\n  // check if response has selector\n  var nextElem = response.querySelector( selector );\n  if ( !nextElem ) {\n    this.lastPageReached( response, path );\n  }\n};\n\nproto.lastPageReached = function( response, path ) {\n  this.canLoad = false;\n  this.dispatchEvent( 'last', null, [ response, path ] );\n};\n\n// ----- error ----- //\n\nproto.onPageError = function( error, path ) {\n  this.isLoading = false;\n  this.canLoad = false;\n  this.dispatchEvent( 'error', null, [ error, path ] );\n  return error;\n};\n\n// -------------------------- prefill -------------------------- //\n\nInfiniteScroll.create.prefill = function() {\n  if ( !this.options.prefill ) {\n    return;\n  }\n  var append = this.options.append;\n  if ( !append ) {\n    console.error( 'append option required for prefill. Set as :' + append );\n    return;\n  }\n  this.updateMeasurements();\n  this.updateScroller();\n  this.isPrefilling = true;\n  this.on( 'append', this.prefill );\n  this.once( 'error', this.stopPrefill );\n  this.once( 'last', this.stopPrefill );\n  this.prefill();\n};\n\nproto.prefill = function() {\n  var distance = this.getPrefillDistance();\n  this.isPrefilling = distance >= 0;\n  if ( this.isPrefilling ) {\n    this.log('prefill');\n    this.loadNextPage();\n  } else {\n    this.stopPrefill();\n  }\n};\n\nproto.getPrefillDistance = function() {\n  // element scroll\n  if ( this.options.elementScroll ) {\n    return this.scroller.clientHeight - this.scroller.scrollHeight;\n  }\n  // window\n  return this.windowHeight - this.element.clientHeight;\n};\n\nproto.stopPrefill = function() {\n  console.log('stopping prefill');\n  this.off( 'append', this.prefill );\n};\n\n// -------------------------- request -------------------------- //\n\nfunction request( url, responseType, onLoad, onError ) {\n  var req = new XMLHttpRequest();\n  req.open( 'GET', url, true );\n  // set responseType document to return DOM\n  req.responseType = responseType || '';\n\n  // set X-Requested-With header to check that is ajax request\n  req.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n\n  req.onload = function() {\n    if ( req.status == 200 ) {\n      onLoad( req.response );\n    } else {\n      // not 200 OK, error\n      var error = new Error( req.statusText );\n      onError( error );\n    }\n  };\n\n  // Handle network errors\n  req.onerror = function() {\n    var error = new Error( 'Network error requesting ' + url );\n    onError( error );\n  };\n\n  req.send();\n}\n\n// --------------------------  -------------------------- //\n\nreturn InfiniteScroll;\n\n}));\n\n// scroll-watch\n( function( window, factory ) {\n  // universal module definition\n  /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'infinite-scroll/js/scroll-watch',[\n      './core',\n      'fizzy-ui-utils/utils',\n    ], function( InfiniteScroll, utils ) {\n      return factory( window, InfiniteScroll, utils );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('./core'),\n      require('fizzy-ui-utils')\n    );\n  } else {\n    // browser global\n    factory(\n      window,\n      window.InfiniteScroll,\n      window.fizzyUIUtils\n    );\n  }\n\n}( window, function factory( window, InfiniteScroll, utils ) {\n\nvar proto = InfiniteScroll.prototype;\n\n// default options\nInfiniteScroll.defaults.scrollThreshold = 400;\n// InfiniteScroll.defaults.elementScroll = null;\n\nInfiniteScroll.create.scrollWatch = function() {\n  // events\n  this.pageScrollHandler = this.onPageScroll.bind( this );\n  this.resizeHandler = this.onResize.bind( this );\n\n  var scrollThreshold = this.options.scrollThreshold;\n  var isEnable = scrollThreshold || scrollThreshold === 0;\n  if ( isEnable ) {\n    this.enableScrollWatch();\n  }\n};\n\nInfiniteScroll.destroy.scrollWatch = function() {\n  this.disableScrollWatch();\n};\n\nproto.enableScrollWatch = function() {\n  if ( this.isScrollWatching ) {\n    return;\n  }\n  this.isScrollWatching = true;\n  this.updateMeasurements();\n  this.updateScroller();\n  // TODO disable after error?\n  this.on( 'last', this.disableScrollWatch );\n  this.bindScrollWatchEvents( true );\n};\n\nproto.disableScrollWatch = function() {\n  if ( !this.isScrollWatching ) {\n    return;\n  }\n  this.bindScrollWatchEvents( false );\n  delete this.isScrollWatching;\n};\n\nproto.bindScrollWatchEvents = function( isBind ) {\n  var addRemove = isBind ? 'addEventListener' : 'removeEventListener';\n  this.scroller[ addRemove ]( 'scroll', this.pageScrollHandler );\n  window[ addRemove ]( 'resize', this.resizeHandler );\n};\n\nproto.onPageScroll = InfiniteScroll.throttle( function() {\n  var distance = this.getBottomDistance();\n  if ( distance <= this.options.scrollThreshold ) {\n    this.dispatchEvent('scrollThreshold');\n  }\n});\n\nproto.getBottomDistance = function() {\n  if ( this.options.elementScroll ) {\n    return this.getElementBottomDistance();\n  } else {\n    return this.getWindowBottomDistance();\n  }\n};\n\nproto.getWindowBottomDistance = function() {\n  var bottom = this.top + this.element.clientHeight;\n  var scrollY = window.pageYOffset + this.windowHeight;\n  return bottom - scrollY;\n};\n\nproto.getElementBottomDistance = function() {\n  var bottom = this.scroller.scrollHeight;\n  var scrollY = this.scroller.scrollTop + this.scroller.clientHeight;\n  return bottom - scrollY;\n};\n\nproto.onResize = function() {\n  this.updateMeasurements();\n};\n\nutils.debounceMethod( InfiniteScroll, 'onResize', 150 );\n\n// --------------------------  -------------------------- //\n\nreturn InfiniteScroll;\n\n}));\n\n// history\n( function( window, factory ) {\n  // universal module definition\n  /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'infinite-scroll/js/history',[\n      './core',\n      'fizzy-ui-utils/utils',\n    ], function( InfiniteScroll, utils ) {\n      return factory( window, InfiniteScroll, utils );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('./core'),\n      require('fizzy-ui-utils')\n    );\n  } else {\n    // browser global\n    factory(\n      window,\n      window.InfiniteScroll,\n      window.fizzyUIUtils\n    );\n  }\n\n}( window, function factory( window, InfiniteScroll, utils ) {\n\nvar proto = InfiniteScroll.prototype;\n\nInfiniteScroll.defaults.history = 'replace';\n// InfiniteScroll.defaults.historyTitle = false;\n\nvar link = document.createElement('a');\n\n// ----- create/destroy ----- //\n\nInfiniteScroll.create.history = function() {\n  if ( !this.options.history ) {\n    return;\n  }\n  // check for same origin\n  link.href = this.getAbsolutePath();\n  // MS Edge does not have origin on link https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/12236493/\n  var linkOrigin = link.origin || link.protocol + '//' + link.host;\n  var isSameOrigin = linkOrigin == location.origin;\n  if ( !isSameOrigin ) {\n    console.error( '[InfiniteScroll] cannot set history with different origin: ' +\n      link.origin + ' on ' + location.origin +\n      ' . History behavior disabled.' );\n    return;\n  }\n\n  // two ways to handle changing history\n  if ( this.options.append ) {\n    this.createHistoryAppend();\n  } else {\n    this.createHistoryPageLoad();\n  }\n};\n\nproto.createHistoryAppend = function() {\n  this.updateMeasurements();\n  this.updateScroller();\n  // array of scroll positions of appended pages\n  this.scrollPages = [\n    {\n      // first page\n      top: 0,\n      path: location.href,\n      title: document.title,\n    }\n  ];\n  this.scrollPageIndex = 0;\n  // events\n  this.scrollHistoryHandler = this.onScrollHistory.bind( this );\n  this.unloadHandler = this.onUnload.bind( this );\n  this.scroller.addEventListener( 'scroll', this.scrollHistoryHandler );\n  this.on( 'append', this.onAppendHistory );\n  this.bindHistoryAppendEvents( true );\n};\n\nproto.bindHistoryAppendEvents = function( isBind ) {\n  var addRemove = isBind ? 'addEventListener' : 'removeEventListener';\n  this.scroller[ addRemove ]( 'scroll', this.scrollHistoryHandler );\n  window[ addRemove ]( 'unload', this.unloadHandler );\n};\n\nproto.createHistoryPageLoad = function() {\n  this.on( 'load', this.onPageLoadHistory );\n};\n\nInfiniteScroll.destroy.history =\nproto.destroyHistory = function() {\n  var isHistoryAppend = this.options.history && this.options.append;\n  if ( isHistoryAppend ) {\n    this.bindHistoryAppendEvents( false );\n  }\n};\n\n// ----- append history ----- //\n\nproto.onAppendHistory = function( response, path, items ) {\n  var firstItem = items[0];\n  var elemScrollY = this.getElementScrollY( firstItem );\n  // resolve path\n  link.href = path;\n  // add page data to hash\n  this.scrollPages.push({\n    top: elemScrollY,\n    path: link.href,\n    title: response.title,\n  });\n};\n\nproto.getElementScrollY = function( elem ) {\n  if ( this.options.elementScroll ) {\n    return this.getElementElementScrollY( elem );\n  } else {\n    return this.getElementWindowScrollY( elem );\n  }\n};\n\nproto.getElementWindowScrollY = function( elem ) {\n  var rect = elem.getBoundingClientRect();\n  return rect.top + window.pageYOffset;\n};\n\n// wow, stupid name\nproto.getElementElementScrollY = function( elem ) {\n  return elem.offsetTop - this.top;\n};\n\nproto.onScrollHistory = function() {\n  // cycle through positions, find biggest without going over\n  var scrollViewY = this.getScrollViewY();\n  var pageIndex, page;\n  for ( var i=0; i < this.scrollPages.length; i++ ) {\n    var scrollPage = this.scrollPages[i];\n    if ( scrollPage.top >= scrollViewY ) {\n      break;\n    }\n    pageIndex = i;\n    page = scrollPage;\n  }\n  // set history if changed\n  if ( pageIndex != this.scrollPageIndex ) {\n    this.scrollPageIndex = pageIndex;\n    this.setHistory( page.title, page.path );\n  }\n};\n\nutils.debounceMethod( InfiniteScroll, 'onScrollHistory', 150 );\n\nproto.getScrollViewY = function() {\n  if ( this.options.elementScroll ) {\n    return this.scroller.scrollTop + this.scroller.clientHeight/2;\n  } else {\n    return window.pageYOffset + this.windowHeight/2;\n  }\n};\n\nproto.setHistory = function( title, path ) {\n  var optHistory = this.options.history;\n  var historyMethod = optHistory && history[ optHistory + 'State' ];\n  if ( !historyMethod ) {\n    return;\n  }\n\n  history[ optHistory + 'State' ]( null, title, path );\n\n  if ( this.options.historyTitle ) {\n    document.title = title;\n  }\n\n  this.dispatchEvent( 'history', null, [ title, path ] );\n};\n\n// scroll to top to prevent initial scroll-reset after page refresh\n// http://stackoverflow.com/a/18633915/182183\nproto.onUnload = function() {\n  var pageIndex = this.scrollPageIndex;\n  if ( pageIndex === 0 ) {\n    return;\n  }\n  // calculate where scroll position would be on refresh\n  var scrollPage = this.scrollPages[ pageIndex ];\n  var scrollY = window.pageYOffset - scrollPage.top + this.top;\n  // disable scroll event before setting scroll #679\n  this.destroyHistory();\n  scrollTo( 0, scrollY );\n};\n\n// ----- load history ----- //\n\n// update URL\nproto.onPageLoadHistory = function( response, path ) {\n  this.setHistory( response.title, path );\n};\n\n// --------------------------  -------------------------- //\n\nreturn InfiniteScroll;\n\n}));\n\n// button\n( function( window, factory ) {\n  // universal module definition\n  /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'infinite-scroll/js/button',[\n      './core',\n      'fizzy-ui-utils/utils',\n    ], function( InfiniteScroll, utils ) {\n      return factory( window, InfiniteScroll, utils );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('./core'),\n      require('fizzy-ui-utils')\n    );\n  } else {\n    // browser global\n    factory(\n      window,\n      window.InfiniteScroll,\n      window.fizzyUIUtils\n    );\n  }\n\n}( window, function factory( window, InfiniteScroll, utils ) {\n\n// InfiniteScroll.defaults.button = null;\n\nInfiniteScroll.create.button = function() {\n  var buttonElem = utils.getQueryElement( this.options.button );\n  if ( buttonElem ) {\n    this.button = new InfiniteScrollButton( buttonElem, this );\n    return;\n  }\n};\n\nInfiniteScroll.destroy.button = function() {\n  if ( this.button ) {\n    this.button.destroy();\n  }\n};\n\n// -------------------------- InfiniteScrollButton -------------------------- //\n\nfunction InfiniteScrollButton( element, infScroll ) {\n  this.element = element;\n  this.infScroll = infScroll;\n  // events\n  this.clickHandler = this.onClick.bind( this );\n  this.element.addEventListener( 'click', this.clickHandler );\n  infScroll.on( 'request', this.disable.bind( this ) );\n  infScroll.on( 'load', this.enable.bind( this ) );\n  infScroll.on( 'error', this.hide.bind( this ) );\n  infScroll.on( 'last', this.hide.bind( this ) );\n}\n\nInfiniteScrollButton.prototype.onClick = function( event ) {\n  event.preventDefault();\n  this.infScroll.loadNextPage();\n};\n\nInfiniteScrollButton.prototype.enable = function() {\n  this.element.removeAttribute('disabled');\n};\n\nInfiniteScrollButton.prototype.disable = function() {\n  this.element.disabled = 'disabled';\n};\n\nInfiniteScrollButton.prototype.hide = function() {\n  this.element.style.display = 'none';\n};\n\nInfiniteScrollButton.prototype.destroy = function() {\n  this.element.removeEventListener( 'click', this.clickHandler );\n};\n\n// --------------------------  -------------------------- //\n\nInfiniteScroll.Button = InfiniteScrollButton;\n\nreturn InfiniteScroll;\n\n}));\n\n// status\n( function( window, factory ) {\n  // universal module definition\n  /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'infinite-scroll/js/status',[\n      './core',\n      'fizzy-ui-utils/utils',\n    ], function( InfiniteScroll, utils ) {\n      return factory( window, InfiniteScroll, utils );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('./core'),\n      require('fizzy-ui-utils')\n    );\n  } else {\n    // browser global\n    factory(\n      window,\n      window.InfiniteScroll,\n      window.fizzyUIUtils\n    );\n  }\n\n}( window, function factory( window, InfiniteScroll, utils ) { \n\nvar proto = InfiniteScroll.prototype;\n\n// InfiniteScroll.defaults.status = null;\n\nInfiniteScroll.create.status = function() {\n  var statusElem = utils.getQueryElement( this.options.status );\n  if ( !statusElem ) {\n    return;\n  }\n  // elements\n  this.statusElement = statusElem;\n  this.statusEventElements = {\n    request: statusElem.querySelector('.infinite-scroll-request'),\n    error: statusElem.querySelector('.infinite-scroll-error'),\n    last: statusElem.querySelector('.infinite-scroll-last'),\n  };\n  // events\n  this.on( 'request', this.showRequestStatus );\n  this.on( 'error', this.showErrorStatus );\n  this.on( 'last', this.showLastStatus );\n  this.bindHideStatus('on');\n};\n\nproto.bindHideStatus = function( bindMethod ) {\n  var hideEvent = this.options.append ? 'append' : 'load';\n  this[ bindMethod ]( hideEvent, this.hideAllStatus );\n};\n\nproto.showRequestStatus = function() {\n  this.showStatus('request');\n};\n\nproto.showErrorStatus = function() {\n  this.showStatus('error');\n};\n\nproto.showLastStatus = function() {\n  this.showStatus('last');\n  // prevent last then append event race condition from showing last status #706\n  this.bindHideStatus('off');\n};\n\nproto.showStatus = function( eventName ) {\n  show( this.statusElement );\n  this.hideStatusEventElements();\n  var eventElem = this.statusEventElements[ eventName ];\n  show( eventElem );\n};\n\nproto.hideAllStatus = function() {\n  hide( this.statusElement );\n  this.hideStatusEventElements();\n};\n\nproto.hideStatusEventElements = function() {\n  for ( var type in this.statusEventElements ) {\n    var eventElem = this.statusEventElements[ type ];\n    hide( eventElem );\n  }\n};\n\n// --------------------------  -------------------------- //\n\nfunction hide( elem ) {\n  setDisplay( elem, 'none' );\n}\n\nfunction show( elem ) {\n  setDisplay( elem, 'block' );\n}\n\nfunction setDisplay( elem, value ) {\n  if ( elem ) {\n    elem.style.display = value;\n  }\n}\n\n// --------------------------  -------------------------- //\n\nreturn InfiniteScroll;\n\n}));\n\n/*!\n * Infinite Scroll v3.0.2\n * Automatically add next page\n *\n * Licensed GPLv3 for open source use\n * or Infinite Scroll Commercial License for commercial use\n *\n * https://infinite-scroll.com\n * Copyright 2017 Metafizzy\n */\n\n( function( window, factory ) {\n  // universal module definition\n  /* globals define, module, require */\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( [\n      'infinite-scroll/js/core',\n      'infinite-scroll/js/page-load',\n      'infinite-scroll/js/scroll-watch',\n      'infinite-scroll/js/history',\n      'infinite-scroll/js/button',\n      'infinite-scroll/js/status',\n    ], factory );\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      require('./core'),\n      require('./page-load'),\n      require('./scroll-watch'),\n      require('./history'),\n      require('./button'),\n      require('./status')\n    );\n  }\n\n})( window, function factory( InfiniteScroll ) {\n  return InfiniteScroll;\n});\n\n/*!\n * imagesLoaded v4.1.3\n * JavaScript is all like \"You images are done yet or what?\"\n * MIT License\n */\n\n( function( window, factory ) { 'use strict';\n  // universal module definition\n\n  /*global define: false, module: false, require: false */\n\n  if ( typeof define == 'function' && define.amd ) {\n    // AMD\n    define( 'imagesloaded/imagesloaded',[\n      'ev-emitter/ev-emitter'\n    ], function( EvEmitter ) {\n      return factory( window, EvEmitter );\n    });\n  } else if ( typeof module == 'object' && module.exports ) {\n    // CommonJS\n    module.exports = factory(\n      window,\n      require('ev-emitter')\n    );\n  } else {\n    // browser global\n    window.imagesLoaded = factory(\n      window,\n      window.EvEmitter\n    );\n  }\n\n})( typeof window !== 'undefined' ? window : this,\n\n// --------------------------  factory -------------------------- //\n\nfunction factory( window, EvEmitter ) {\n\n\n\nvar $ = window.jQuery;\nvar console = window.console;\n\n// -------------------------- helpers -------------------------- //\n\n// extend objects\nfunction extend( a, b ) {\n  for ( var prop in b ) {\n    a[ prop ] = b[ prop ];\n  }\n  return a;\n}\n\n// turn element or nodeList into an array\nfunction makeArray( obj ) {\n  var ary = [];\n  if ( Array.isArray( obj ) ) {\n    // use object if already an array\n    ary = obj;\n  } else if ( typeof obj.length == 'number' ) {\n    // convert nodeList to array\n    for ( var i=0; i < obj.length; i++ ) {\n      ary.push( obj[i] );\n    }\n  } else {\n    // array of single index\n    ary.push( obj );\n  }\n  return ary;\n}\n\n// -------------------------- imagesLoaded -------------------------- //\n\n/**\n * @param {Array, Element, NodeList, String} elem\n * @param {Object or Function} options - if function, use as callback\n * @param {Function} onAlways - callback function\n */\nfunction ImagesLoaded( elem, options, onAlways ) {\n  // coerce ImagesLoaded() without new, to be new ImagesLoaded()\n  if ( !( this instanceof ImagesLoaded ) ) {\n    return new ImagesLoaded( elem, options, onAlways );\n  }\n  // use elem as selector string\n  if ( typeof elem == 'string' ) {\n    elem = document.querySelectorAll( elem );\n  }\n\n  this.elements = makeArray( elem );\n  this.options = extend( {}, this.options );\n\n  if ( typeof options == 'function' ) {\n    onAlways = options;\n  } else {\n    extend( this.options, options );\n  }\n\n  if ( onAlways ) {\n    this.on( 'always', onAlways );\n  }\n\n  this.getImages();\n\n  if ( $ ) {\n    // add jQuery Deferred object\n    this.jqDeferred = new $.Deferred();\n  }\n\n  // HACK check async to allow time to bind listeners\n  setTimeout( function() {\n    this.check();\n  }.bind( this ));\n}\n\nImagesLoaded.prototype = Object.create( EvEmitter.prototype );\n\nImagesLoaded.prototype.options = {};\n\nImagesLoaded.prototype.getImages = function() {\n  this.images = [];\n\n  // filter & find items if we have an item selector\n  this.elements.forEach( this.addElementImages, this );\n};\n\n/**\n * @param {Node} element\n */\nImagesLoaded.prototype.addElementImages = function( elem ) {\n  // filter siblings\n  if ( elem.nodeName == 'IMG' ) {\n    this.addImage( elem );\n  }\n  // get background image on element\n  if ( this.options.background === true ) {\n    this.addElementBackgroundImages( elem );\n  }\n\n  // find children\n  // no non-element nodes, #143\n  var nodeType = elem.nodeType;\n  if ( !nodeType || !elementNodeTypes[ nodeType ] ) {\n    return;\n  }\n  var childImgs = elem.querySelectorAll('img');\n  // concat childElems to filterFound array\n  for ( var i=0; i < childImgs.length; i++ ) {\n    var img = childImgs[i];\n    this.addImage( img );\n  }\n\n  // get child background images\n  if ( typeof this.options.background == 'string' ) {\n    var children = elem.querySelectorAll( this.options.background );\n    for ( i=0; i < children.length; i++ ) {\n      var child = children[i];\n      this.addElementBackgroundImages( child );\n    }\n  }\n};\n\nvar elementNodeTypes = {\n  1: true,\n  9: true,\n  11: true\n};\n\nImagesLoaded.prototype.addElementBackgroundImages = function( elem ) {\n  var style = getComputedStyle( elem );\n  if ( !style ) {\n    // Firefox returns null if in a hidden iframe https://bugzil.la/548397\n    return;\n  }\n  // get url inside url(\"...\")\n  var reURL = /url\\((['\"])?(.*?)\\1\\)/gi;\n  var matches = reURL.exec( style.backgroundImage );\n  while ( matches !== null ) {\n    var url = matches && matches[2];\n    if ( url ) {\n      this.addBackground( url, elem );\n    }\n    matches = reURL.exec( style.backgroundImage );\n  }\n};\n\n/**\n * @param {Image} img\n */\nImagesLoaded.prototype.addImage = function( img ) {\n  var loadingImage = new LoadingImage( img );\n  this.images.push( loadingImage );\n};\n\nImagesLoaded.prototype.addBackground = function( url, elem ) {\n  var background = new Background( url, elem );\n  this.images.push( background );\n};\n\nImagesLoaded.prototype.check = function() {\n  var _this = this;\n  this.progressedCount = 0;\n  this.hasAnyBroken = false;\n  // complete if no images\n  if ( !this.images.length ) {\n    this.complete();\n    return;\n  }\n\n  function onProgress( image, elem, message ) {\n    // HACK - Chrome triggers event before object properties have changed. #83\n    setTimeout( function() {\n      _this.progress( image, elem, message );\n    });\n  }\n\n  this.images.forEach( function( loadingImage ) {\n    loadingImage.once( 'progress', onProgress );\n    loadingImage.check();\n  });\n};\n\nImagesLoaded.prototype.progress = function( image, elem, message ) {\n  this.progressedCount++;\n  this.hasAnyBroken = this.hasAnyBroken || !image.isLoaded;\n  // progress event\n  this.emitEvent( 'progress', [ this, image, elem ] );\n  if ( this.jqDeferred && this.jqDeferred.notify ) {\n    this.jqDeferred.notify( this, image );\n  }\n  // check if completed\n  if ( this.progressedCount == this.images.length ) {\n    this.complete();\n  }\n\n  if ( this.options.debug && console ) {\n    console.log( 'progress: ' + message, image, elem );\n  }\n};\n\nImagesLoaded.prototype.complete = function() {\n  var eventName = this.hasAnyBroken ? 'fail' : 'done';\n  this.isComplete = true;\n  this.emitEvent( eventName, [ this ] );\n  this.emitEvent( 'always', [ this ] );\n  if ( this.jqDeferred ) {\n    var jqMethod = this.hasAnyBroken ? 'reject' : 'resolve';\n    this.jqDeferred[ jqMethod ]( this );\n  }\n};\n\n// --------------------------  -------------------------- //\n\nfunction LoadingImage( img ) {\n  this.img = img;\n}\n\nLoadingImage.prototype = Object.create( EvEmitter.prototype );\n\nLoadingImage.prototype.check = function() {\n  // If complete is true and browser supports natural sizes,\n  // try to check for image status manually.\n  var isComplete = this.getIsImageComplete();\n  if ( isComplete ) {\n    // report based on naturalWidth\n    this.confirm( this.img.naturalWidth !== 0, 'naturalWidth' );\n    return;\n  }\n\n  // If none of the checks above matched, simulate loading on detached element.\n  this.proxyImage = new Image();\n  this.proxyImage.addEventListener( 'load', this );\n  this.proxyImage.addEventListener( 'error', this );\n  // bind to image as well for Firefox. #191\n  this.img.addEventListener( 'load', this );\n  this.img.addEventListener( 'error', this );\n  this.proxyImage.src = this.img.src;\n};\n\nLoadingImage.prototype.getIsImageComplete = function() {\n  return this.img.complete && this.img.naturalWidth !== undefined;\n};\n\nLoadingImage.prototype.confirm = function( isLoaded, message ) {\n  this.isLoaded = isLoaded;\n  this.emitEvent( 'progress', [ this, this.img, message ] );\n};\n\n// ----- events ----- //\n\n// trigger specified handler for event type\nLoadingImage.prototype.handleEvent = function( event ) {\n  var method = 'on' + event.type;\n  if ( this[ method ] ) {\n    this[ method ]( event );\n  }\n};\n\nLoadingImage.prototype.onload = function() {\n  this.confirm( true, 'onload' );\n  this.unbindEvents();\n};\n\nLoadingImage.prototype.onerror = function() {\n  this.confirm( false, 'onerror' );\n  this.unbindEvents();\n};\n\nLoadingImage.prototype.unbindEvents = function() {\n  this.proxyImage.removeEventListener( 'load', this );\n  this.proxyImage.removeEventListener( 'error', this );\n  this.img.removeEventListener( 'load', this );\n  this.img.removeEventListener( 'error', this );\n};\n\n// -------------------------- Background -------------------------- //\n\nfunction Background( url, element ) {\n  this.url = url;\n  this.element = element;\n  this.img = new Image();\n}\n\n// inherit LoadingImage prototype\nBackground.prototype = Object.create( LoadingImage.prototype );\n\nBackground.prototype.check = function() {\n  this.img.addEventListener( 'load', this );\n  this.img.addEventListener( 'error', this );\n  this.img.src = this.url;\n  // check if image is already complete\n  var isComplete = this.getIsImageComplete();\n  if ( isComplete ) {\n    this.confirm( this.img.naturalWidth !== 0, 'naturalWidth' );\n    this.unbindEvents();\n  }\n};\n\nBackground.prototype.unbindEvents = function() {\n  this.img.removeEventListener( 'load', this );\n  this.img.removeEventListener( 'error', this );\n};\n\nBackground.prototype.confirm = function( isLoaded, message ) {\n  this.isLoaded = isLoaded;\n  this.emitEvent( 'progress', [ this, this.element, message ] );\n};\n\n// -------------------------- jQuery -------------------------- //\n\nImagesLoaded.makeJQueryPlugin = function( jQuery ) {\n  jQuery = jQuery || window.jQuery;\n  if ( !jQuery ) {\n    return;\n  }\n  // set local variable\n  $ = jQuery;\n  // $().imagesLoaded()\n  $.fn.imagesLoaded = function( options, callback ) {\n    var instance = new ImagesLoaded( this, options, callback );\n    return instance.jqDeferred.promise( $(this) );\n  };\n};\n// try making plugin\nImagesLoaded.makeJQueryPlugin();\n\n// --------------------------  -------------------------- //\n\nreturn ImagesLoaded;\n\n});\n"]},"metadata":{},"sourceType":"module"}