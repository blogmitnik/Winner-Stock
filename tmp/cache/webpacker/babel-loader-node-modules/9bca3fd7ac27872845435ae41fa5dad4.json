{"ast":null,"code":"/*!\n * HTML5 export buttons for Buttons and DataTables.\n * 2016 SpryMedia Ltd - datatables.net/license\n *\n * FileSaver.js (1.1.20160328) - MIT license\n * Copyright Â© 2016 Eli Grey - http://eligrey.com\n */\n(function (factory) {\n  if (typeof define === 'function' && define.amd) {\n    // AMD\n    define(['jquery', 'datatables.net', 'datatables.net-buttons'], function ($) {\n      return factory($, window, document);\n    });\n  } else if (typeof exports === 'object') {\n    // CommonJS\n    module.exports = function (root, $, jszip, pdfmake) {\n      if (!root) {\n        root = window;\n      }\n\n      if (!$ || !$.fn.dataTable) {\n        $ = require('datatables.net')(root, $).$;\n      }\n\n      if (!$.fn.dataTable.Buttons) {\n        require('datatables.net-buttons')(root, $);\n      }\n\n      return factory($, root, root.document, jszip, pdfmake);\n    };\n  } else {\n    // Browser\n    factory(jQuery, window, document);\n  }\n})(function ($, window, document, jszip, pdfmake, undefined) {\n  'use strict';\n\n  var DataTable = $.fn.dataTable; // Allow the constructor to pass in JSZip and PDFMake from external requires.\n  // Otherwise, use globally defined variables, if they are available.\n\n  function _jsZip() {\n    return jszip || window.JSZip;\n  }\n\n  function _pdfMake() {\n    return pdfmake || window.pdfMake;\n  }\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * FileSaver.js dependency\n   */\n\n  /*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\n\n\n  var _saveAs = function (view) {\n    \"use strict\"; // IE <10 is explicitly unsupported\n\n    if (typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\n      return;\n    }\n\n    var doc = view.document // only get URL when necessary in case Blob.js hasn't overridden it yet\n    ,\n        get_URL = function get_URL() {\n      return view.URL || view.webkitURL || view;\n    },\n        save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\"),\n        can_use_save_link = (\"download\" in save_link),\n        click = function click(node) {\n      var event = new MouseEvent(\"click\");\n      node.dispatchEvent(event);\n    },\n        is_safari = /Version\\/[\\d\\.]+.*Safari/.test(navigator.userAgent),\n        webkit_req_fs = view.webkitRequestFileSystem,\n        req_fs = view.requestFileSystem || webkit_req_fs || view.mozRequestFileSystem,\n        throw_outside = function throw_outside(ex) {\n      (view.setImmediate || view.setTimeout)(function () {\n        throw ex;\n      }, 0);\n    },\n        force_saveable_type = \"application/octet-stream\",\n        fs_min_size = 0 // the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\n    ,\n        arbitrary_revoke_timeout = 1000 * 40 // in ms\n    ,\n        revoke = function revoke(file) {\n      var revoker = function revoker() {\n        if (typeof file === \"string\") {\n          // file is an object URL\n          get_URL().revokeObjectURL(file);\n        } else {\n          // file is a File\n          file.remove();\n        }\n      };\n      /* // Take note W3C:\n      var\n        uri = typeof file === \"string\" ? file : file.toURL()\n      , revoker = function(evt) {\n      \t// idealy DownloadFinishedEvent.data would be the URL requested\n      \tif (evt.data === uri) {\n      \t\tif (typeof file === \"string\") { // file is an object URL\n      \t\t\tget_URL().revokeObjectURL(file);\n      \t\t} else { // file is a File\n      \t\t\tfile.remove();\n      \t\t}\n      \t}\n      }\n      ;\n      view.addEventListener(\"downloadfinished\", revoker);\n      */\n\n\n      setTimeout(revoker, arbitrary_revoke_timeout);\n    },\n        dispatch = function dispatch(filesaver, event_types, event) {\n      event_types = [].concat(event_types);\n      var i = event_types.length;\n\n      while (i--) {\n        var listener = filesaver[\"on\" + event_types[i]];\n\n        if (typeof listener === \"function\") {\n          try {\n            listener.call(filesaver, event || filesaver);\n          } catch (ex) {\n            throw_outside(ex);\n          }\n        }\n      }\n    },\n        auto_bom = function auto_bom(blob) {\n      // prepend BOM for UTF-8 XML and text/* types (including HTML)\n      if (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n        return new Blob([\"\\uFEFF\", blob], {\n          type: blob.type\n        });\n      }\n\n      return blob;\n    },\n        FileSaver = function FileSaver(blob, name, no_auto_bom) {\n      if (!no_auto_bom) {\n        blob = auto_bom(blob);\n      } // First try a.download, then web filesystem, then object URLs\n\n\n      var filesaver = this,\n          type = blob.type,\n          blob_changed = false,\n          object_url,\n          target_view,\n          dispatch_all = function dispatch_all() {\n        dispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n      } // on any filesys errors revert to saving with object URLs\n      ,\n          fs_error = function fs_error() {\n        if (target_view && is_safari && typeof FileReader !== \"undefined\") {\n          // Safari doesn't allow downloading of blob urls\n          var reader = new FileReader();\n\n          reader.onloadend = function () {\n            var base64Data = reader.result;\n            target_view.location.href = \"data:attachment/file\" + base64Data.slice(base64Data.search(/[,;]/));\n            filesaver.readyState = filesaver.DONE;\n            dispatch_all();\n          };\n\n          reader.readAsDataURL(blob);\n          filesaver.readyState = filesaver.INIT;\n          return;\n        } // don't create more object URLs than needed\n\n\n        if (blob_changed || !object_url) {\n          object_url = get_URL().createObjectURL(blob);\n        }\n\n        if (target_view) {\n          target_view.location.href = object_url;\n        } else {\n          var new_tab = view.open(object_url, \"_blank\");\n\n          if (new_tab === undefined && is_safari) {\n            //Apple do not allow window.open, see http://bit.ly/1kZffRI\n            view.location.href = object_url;\n          }\n        }\n\n        filesaver.readyState = filesaver.DONE;\n        dispatch_all();\n        revoke(object_url);\n      },\n          abortable = function abortable(func) {\n        return function () {\n          if (filesaver.readyState !== filesaver.DONE) {\n            return func.apply(this, arguments);\n          }\n        };\n      },\n          create_if_not_found = {\n        create: true,\n        exclusive: false\n      },\n          slice;\n\n      filesaver.readyState = filesaver.INIT;\n\n      if (!name) {\n        name = \"download\";\n      }\n\n      if (can_use_save_link) {\n        object_url = get_URL().createObjectURL(blob);\n        setTimeout(function () {\n          save_link.href = object_url;\n          save_link.download = name;\n          click(save_link);\n          dispatch_all();\n          revoke(object_url);\n          filesaver.readyState = filesaver.DONE;\n        });\n        return;\n      } // Object and web filesystem URLs have a problem saving in Google Chrome when\n      // viewed in a tab, so I force save with application/octet-stream\n      // http://code.google.com/p/chromium/issues/detail?id=91158\n      // Update: Google errantly closed 91158, I submitted it again:\n      // https://code.google.com/p/chromium/issues/detail?id=389642\n\n\n      if (view.chrome && type && type !== force_saveable_type) {\n        slice = blob.slice || blob.webkitSlice;\n        blob = slice.call(blob, 0, blob.size, force_saveable_type);\n        blob_changed = true;\n      } // Since I can't be sure that the guessed media type will trigger a download\n      // in WebKit, I append .download to the filename.\n      // https://bugs.webkit.org/show_bug.cgi?id=65440\n\n\n      if (webkit_req_fs && name !== \"download\") {\n        name += \".download\";\n      }\n\n      if (type === force_saveable_type || webkit_req_fs) {\n        target_view = view;\n      }\n\n      if (!req_fs) {\n        fs_error();\n        return;\n      }\n\n      fs_min_size += blob.size;\n      req_fs(view.TEMPORARY, fs_min_size, abortable(function (fs) {\n        fs.root.getDirectory(\"saved\", create_if_not_found, abortable(function (dir) {\n          var save = function save() {\n            dir.getFile(name, create_if_not_found, abortable(function (file) {\n              file.createWriter(abortable(function (writer) {\n                writer.onwriteend = function (event) {\n                  target_view.location.href = file.toURL();\n                  filesaver.readyState = filesaver.DONE;\n                  dispatch(filesaver, \"writeend\", event);\n                  revoke(file);\n                };\n\n                writer.onerror = function () {\n                  var error = writer.error;\n\n                  if (error.code !== error.ABORT_ERR) {\n                    fs_error();\n                  }\n                };\n\n                \"writestart progress write abort\".split(\" \").forEach(function (event) {\n                  writer[\"on\" + event] = filesaver[\"on\" + event];\n                });\n                writer.write(blob);\n\n                filesaver.abort = function () {\n                  writer.abort();\n                  filesaver.readyState = filesaver.DONE;\n                };\n\n                filesaver.readyState = filesaver.WRITING;\n              }), fs_error);\n            }), fs_error);\n          };\n\n          dir.getFile(name, {\n            create: false\n          }, abortable(function (file) {\n            // delete file if it already exists\n            file.remove();\n            save();\n          }), abortable(function (ex) {\n            if (ex.code === ex.NOT_FOUND_ERR) {\n              save();\n            } else {\n              fs_error();\n            }\n          }));\n        }), fs_error);\n      }), fs_error);\n    },\n        FS_proto = FileSaver.prototype,\n        saveAs = function saveAs(blob, name, no_auto_bom) {\n      return new FileSaver(blob, name, no_auto_bom);\n    }; // IE 10+ (native saveAs)\n\n\n    if (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\n      return function (blob, name, no_auto_bom) {\n        if (!no_auto_bom) {\n          blob = auto_bom(blob);\n        }\n\n        return navigator.msSaveOrOpenBlob(blob, name || \"download\");\n      };\n    }\n\n    FS_proto.abort = function () {\n      var filesaver = this;\n      filesaver.readyState = filesaver.DONE;\n      dispatch(filesaver, \"abort\");\n    };\n\n    FS_proto.readyState = FS_proto.INIT = 0;\n    FS_proto.WRITING = 1;\n    FS_proto.DONE = 2;\n    FS_proto.error = FS_proto.onwritestart = FS_proto.onprogress = FS_proto.onwrite = FS_proto.onabort = FS_proto.onerror = FS_proto.onwriteend = null;\n    return saveAs;\n  }(typeof self !== \"undefined\" && self || typeof window !== \"undefined\" && window || this.content); // Expose file saver on the DataTables API. Can't attach to `DataTables.Buttons`\n  // since this file can be loaded before Button's core!\n\n\n  DataTable.fileSave = _saveAs;\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * Local (private) functions\n   */\n\n  /**\n   * Get the file name for an exported file.\n   *\n   * @param {object}\tconfig Button configuration\n   * @param {boolean} incExtension Include the file name extension\n   */\n\n  var _filename = function _filename(config, incExtension) {\n    // Backwards compatibility\n    var filename = config.filename === '*' && config.title !== '*' && config.title !== undefined ? config.title : config.filename;\n\n    if (typeof filename === 'function') {\n      filename = filename();\n    }\n\n    if (filename.indexOf('*') !== -1) {\n      filename = $.trim(filename.replace('*', $('title').text()));\n    } // Strip characters which the OS will object to\n\n\n    filename = filename.replace(/[^a-zA-Z0-9_\\u00A1-\\uFFFF\\.,\\-_ !\\(\\)]/g, \"\");\n    return incExtension === undefined || incExtension === true ? filename + config.extension : filename;\n  };\n  /**\n   * Get the sheet name for Excel exports.\n   *\n   * @param {object}\tconfig Button configuration\n   */\n\n\n  var _sheetname = function _sheetname(config) {\n    var sheetName = 'Sheet1';\n\n    if (config.sheetName) {\n      sheetName = config.sheetName.replace(/[\\[\\]\\*\\/\\\\\\?\\:]/g, '');\n    }\n\n    return sheetName;\n  };\n  /**\n   * Get the title for an exported file.\n   *\n   * @param {object} config\tButton configuration\n   */\n\n\n  var _title = function _title(config) {\n    var title = config.title;\n\n    if (typeof title === 'function') {\n      title = title();\n    }\n\n    return title.indexOf('*') !== -1 ? title.replace('*', $('title').text() || 'Exported data') : title;\n  };\n  /**\n   * Get the newline character(s)\n   *\n   * @param {object}\tconfig Button configuration\n   * @return {string}\t\t\t\tNewline character\n   */\n\n\n  var _newLine = function _newLine(config) {\n    return config.newline ? config.newline : navigator.userAgent.match(/Windows/) ? '\\r\\n' : '\\n';\n  };\n  /**\n   * Combine the data from the `buttons.exportData` method into a string that\n   * will be used in the export file.\n   *\n   * @param\t{DataTable.Api} dt\t\t DataTables API instance\n   * @param\t{object}\t\t\t\tconfig Button configuration\n   * @return {object}\t\t\t\t\t\t\t The data to export\n   */\n\n\n  var _exportData = function _exportData(dt, config) {\n    var newLine = _newLine(config);\n\n    var data = dt.buttons.exportData(config.exportOptions);\n    var boundary = config.fieldBoundary;\n    var separator = config.fieldSeparator;\n    var reBoundary = new RegExp(boundary, 'g');\n    var escapeChar = config.escapeChar !== undefined ? config.escapeChar : '\\\\';\n\n    var join = function join(a) {\n      var s = ''; // If there is a field boundary, then we might need to escape it in\n      // the source data\n\n      for (var i = 0, ien = a.length; i < ien; i++) {\n        if (i > 0) {\n          s += separator;\n        }\n\n        s += boundary ? boundary + ('' + a[i]).replace(reBoundary, escapeChar + boundary) + boundary : a[i];\n      }\n\n      return s;\n    };\n\n    var header = config.header ? join(data.header) + newLine : '';\n    var footer = config.footer && data.footer ? newLine + join(data.footer) : '';\n    var body = [];\n\n    for (var i = 0, ien = data.body.length; i < ien; i++) {\n      body.push(join(data.body[i]));\n    }\n\n    return {\n      str: header + body.join(newLine) + footer,\n      rows: body.length\n    };\n  };\n  /**\n   * Safari's data: support for creating and downloading files is really poor, so\n   * various options need to be disabled in it. See\n   * https://bugs.webkit.org/show_bug.cgi?id=102914\n   *\n   * @return {Boolean} `true` if Safari\n   */\n\n\n  var _isSafari = function _isSafari() {\n    return navigator.userAgent.indexOf('Safari') !== -1 && navigator.userAgent.indexOf('Chrome') === -1 && navigator.userAgent.indexOf('Opera') === -1;\n  };\n  /**\n   * Convert from numeric position to letter for column names in Excel\n   * @param  {int} n Column number\n   * @return {string} Column letter(s) name\n   */\n\n\n  function createCellPos(n) {\n    var ordA = 'A'.charCodeAt(0);\n    var ordZ = 'Z'.charCodeAt(0);\n    var len = ordZ - ordA + 1;\n    var s = \"\";\n\n    while (n >= 0) {\n      s = String.fromCharCode(n % len + ordA) + s;\n      n = Math.floor(n / len) - 1;\n    }\n\n    return s;\n  }\n\n  try {\n    var _serialiser = new XMLSerializer();\n\n    var _ieExcel;\n  } catch (t) {}\n  /**\n   * Recursively add XML files from an object's structure to a ZIP file. This\n   * allows the XSLX file to be easily defined with an object's structure matching\n   * the files structure.\n   *\n   * @param {JSZip} zip ZIP package\n   * @param {object} obj Object to add (recursive)\n   */\n\n\n  function _addToZip(zip, obj) {\n    if (_ieExcel === undefined) {\n      // Detect if we are dealing with IE's _awful_ serialiser by seeing if it\n      // drop attributes\n      _ieExcel = _serialiser.serializeToString($.parseXML(excelStrings['xl/worksheets/sheet1.xml'])).indexOf('xmlns:r') === -1;\n    }\n\n    $.each(obj, function (name, val) {\n      if ($.isPlainObject(val)) {\n        var newDir = zip.folder(name);\n\n        _addToZip(newDir, val);\n      } else {\n        if (_ieExcel) {\n          // IE's XML serialiser will drop some name space attributes from\n          // from the root node, so we need to save them. Do this by\n          // replacing the namespace nodes with a regular attribute that\n          // we convert back when serialised. Edge does not have this\n          // issue\n          var worksheet = val.childNodes[0];\n          var i, ien;\n          var attrs = [];\n\n          for (i = worksheet.attributes.length - 1; i >= 0; i--) {\n            var attrName = worksheet.attributes[i].nodeName;\n            var attrValue = worksheet.attributes[i].nodeValue;\n\n            if (attrName.indexOf(':') !== -1) {\n              attrs.push({\n                name: attrName,\n                value: attrValue\n              });\n              worksheet.removeAttribute(attrName);\n            }\n          }\n\n          for (i = 0, ien = attrs.length; i < ien; i++) {\n            var attr = val.createAttribute(attrs[i].name.replace(':', '_dt_b_namespace_token_'));\n            attr.value = attrs[i].value;\n            worksheet.setAttributeNode(attr);\n          }\n        }\n\n        var str = _serialiser.serializeToString(val); // Fix IE's XML\n\n\n        if (_ieExcel) {\n          // IE doesn't include the XML declaration\n          if (str.indexOf('<?xml') === -1) {\n            str = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + str;\n          } // Return namespace attributes to being as such\n\n\n          str = str.replace(/_dt_b_namespace_token_/g, ':');\n        } // Both IE and Edge will put empty name space attributes onto the\n        // rows and columns making them useless\n\n\n        str = str.replace(/<row xmlns=\"\" /g, '<row ').replace(/<cols xmlns=\"\">/g, '<cols>');\n        zip.file(name, str);\n      }\n    });\n  }\n  /**\n   * Create an XML node and add any children, attributes, etc without needing to\n   * be verbose in the DOM.\n   *\n   * @param  {object} doc      XML document\n   * @param  {string} nodeName Node name\n   * @param  {object} opts     Options - can be `attr` (attributes), `children`\n   *   (child nodes) and `text` (text content)\n   * @return {node}            Created node\n   */\n\n\n  function _createNode(doc, nodeName, opts) {\n    var tempNode = doc.createElement(nodeName);\n\n    if (opts) {\n      if (opts.attr) {\n        $(tempNode).attr(opts.attr);\n      }\n\n      if (opts.children) {\n        $.each(opts.children, function (key, value) {\n          tempNode.appendChild(value);\n        });\n      }\n\n      if (opts.text) {\n        tempNode.appendChild(doc.createTextNode(opts.text));\n      }\n    }\n\n    return tempNode;\n  }\n  /**\n   * Get the width for an Excel column based on the contents of that column\n   * @param  {object} data Data for export\n   * @param  {int}    col  Column index\n   * @return {int}         Column width\n   */\n\n\n  function _excelColWidth(data, col) {\n    var max = data.header[col].length;\n    var len;\n\n    if (data.footer && data.footer[col].length > max) {\n      max = data.footer[col].length;\n    }\n\n    for (var i = 0, ien = data.body.length; i < ien; i++) {\n      len = data.body[i][col].toString().length;\n\n      if (len > max) {\n        max = len;\n      } // Max width rather than having potentially massive column widths\n\n\n      if (max > 40) {\n        break;\n      }\n    } // And a min width\n\n\n    return max > 5 ? max : 5;\n  } // Excel - Pre-defined strings to build a basic XLSX file\n\n\n  var excelStrings = {\n    \"_rels/.rels\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>' + '</Relationships>',\n    \"xl/_rels/workbook.xml.rels\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">' + '<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>' + '<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>' + '</Relationships>',\n    \"[Content_Types].xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">' + '<Default Extension=\"xml\" ContentType=\"application/xml\" />' + '<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />' + '<Default Extension=\"jpeg\" ContentType=\"image/jpeg\" />' + '<Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" />' + '<Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" />' + '<Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" />' + '</Types>',\n    \"xl/workbook.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">' + '<fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"24816\"/>' + '<workbookPr showInkAnnotation=\"0\" autoCompressPictures=\"0\"/>' + '<bookViews>' + '<workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"25600\" windowHeight=\"19020\" tabRatio=\"500\"/>' + '</bookViews>' + '<sheets>' + '<sheet name=\"\" sheetId=\"1\" r:id=\"rId1\"/>' + '</sheets>' + '</workbook>',\n    \"xl/worksheets/sheet1.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>' + '<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">' + '<sheetData/>' + '</worksheet>',\n    \"xl/styles.xml\": '<?xml version=\"1.0\" encoding=\"UTF-8\"?>' + '<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">' + '<fonts count=\"5\" x14ac:knownFonts=\"1\">' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<color rgb=\"FFFFFFFF\" />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<b />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<i />' + '</font>' + '<font>' + '<sz val=\"11\" />' + '<name val=\"Calibri\" />' + '<u />' + '</font>' + '</fonts>' + '<fills count=\"6\">' + '<fill>' + '<patternFill patternType=\"none\" />' + '</fill>' + '<fill/>' + // Excel appears to use this as a dotted background regardless of values\n    '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"FFD9D9D9\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"FFD99795\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"ffc6efce\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '<fill>' + '<patternFill patternType=\"solid\">' + '<fgColor rgb=\"ffc6cfef\" />' + '<bgColor indexed=\"64\" />' + '</patternFill>' + '</fill>' + '</fills>' + '<borders count=\"2\">' + '<border>' + '<left />' + '<right />' + '<top />' + '<bottom />' + '<diagonal />' + '</border>' + '<border diagonalUp=\"false\" diagonalDown=\"false\">' + '<left style=\"thin\">' + '<color auto=\"1\" />' + '</left>' + '<right style=\"thin\">' + '<color auto=\"1\" />' + '</right>' + '<top style=\"thin\">' + '<color auto=\"1\" />' + '</top>' + '<bottom style=\"thin\">' + '<color auto=\"1\" />' + '</bottom>' + '<diagonal />' + '</border>' + '</borders>' + '<cellStyleXfs count=\"1\">' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" />' + '</cellStyleXfs>' + '<cellXfs count=\"56\">' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"left\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"center\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"right\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment horizontal=\"fill\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment textRotation=\"90\"/>' + '</xf>' + '<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">' + '<alignment wrapText=\"1\"/>' + '</xf>' + '</cellXfs>' + '<cellStyles count=\"1\">' + '<cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\" />' + '</cellStyles>' + '<dxfs count=\"0\" />' + '<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\" />' + '</styleSheet>'\n  }; // Note we could use 3 `for` loops for the styles, but when gzipped there is\n  // virtually no difference in size, since the above can be easily compressed\n\n  /* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n   * Buttons\n   */\n  //\n  // Copy to clipboard\n  //\n\n  DataTable.ext.buttons.copyHtml5 = {\n    className: 'buttons-copy buttons-html5',\n    text: function text(dt) {\n      return dt.i18n('buttons.copy', 'Copy');\n    },\n    action: function action(e, dt, button, config) {\n      var exportData = _exportData(dt, config);\n\n      var output = exportData.str;\n      var hiddenDiv = $('<div/>').css({\n        height: 1,\n        width: 1,\n        overflow: 'hidden',\n        position: 'fixed',\n        top: 0,\n        left: 0\n      });\n\n      if (config.customize) {\n        output = config.customize(output, config);\n      }\n\n      var textarea = $('<textarea readonly/>').val(output).appendTo(hiddenDiv); // For browsers that support the copy execCommand, try to use it\n\n      if (document.queryCommandSupported('copy')) {\n        hiddenDiv.appendTo(dt.table().container());\n        textarea[0].focus();\n        textarea[0].select();\n\n        try {\n          var successful = document.execCommand('copy');\n          hiddenDiv.remove();\n\n          if (successful) {\n            dt.buttons.info(dt.i18n('buttons.copyTitle', 'Copy to clipboard'), dt.i18n('buttons.copySuccess', {\n              1: 'Copied one row to clipboard',\n              _: 'Copied %d rows to clipboard'\n            }, exportData.rows), 2000);\n            return;\n          }\n        } catch (t) {}\n      } // Otherwise we show the text box and instruct the user to use it\n\n\n      var message = $('<span>' + dt.i18n('buttons.copyKeys', \"Press <i>ctrl</i> or <i>\\u2318</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>\" + 'To cancel, click this message or press escape.') + '</span>').append(hiddenDiv);\n      dt.buttons.info(dt.i18n('buttons.copyTitle', 'Copy to clipboard'), message, 0); // Select the text so when the user activates their system clipboard\n      // it will copy that text\n\n      textarea[0].focus();\n      textarea[0].select(); // Event to hide the message when the user is done\n\n      var container = $(message).closest('.dt-button-info');\n\n      var close = function close() {\n        container.off('click.buttons-copy');\n        $(document).off('.buttons-copy');\n        dt.buttons.info(false);\n      };\n\n      container.on('click.buttons-copy', close);\n      $(document).on('keydown.buttons-copy', function (e) {\n        if (e.keyCode === 27) {\n          // esc\n          close();\n        }\n      }).on('copy.buttons-copy cut.buttons-copy', function () {\n        close();\n      });\n    },\n    exportOptions: {},\n    fieldSeparator: '\\t',\n    fieldBoundary: '',\n    header: true,\n    footer: false\n  }; //\n  // CSV export\n  //\n\n  DataTable.ext.buttons.csvHtml5 = {\n    bom: false,\n    className: 'buttons-csv buttons-html5',\n    available: function available() {\n      return window.FileReader !== undefined && window.Blob;\n    },\n    text: function text(dt) {\n      return dt.i18n('buttons.csv', 'CSV');\n    },\n    action: function action(e, dt, button, config) {\n      // Set the text\n      var output = _exportData(dt, config).str;\n\n      var charset = config.charset;\n\n      if (config.customize) {\n        output = config.customize(output, config);\n      }\n\n      if (charset !== false) {\n        if (!charset) {\n          charset = document.characterSet || document.charset;\n        }\n\n        if (charset) {\n          charset = ';charset=' + charset;\n        }\n      } else {\n        charset = '';\n      }\n\n      if (config.bom) {\n        output = \"\\uFEFF\" + output;\n      }\n\n      _saveAs(new Blob([output], {\n        type: 'text/csv' + charset\n      }), _filename(config), true);\n    },\n    filename: '*',\n    extension: '.csv',\n    exportOptions: {},\n    fieldSeparator: ',',\n    fieldBoundary: '\"',\n    escapeChar: '\"',\n    charset: null,\n    header: true,\n    footer: false\n  }; //\n  // Excel (xlsx) export\n  //\n\n  DataTable.ext.buttons.excelHtml5 = {\n    className: 'buttons-excel buttons-html5',\n    available: function available() {\n      return window.FileReader !== undefined && _jsZip() !== undefined && !_isSafari() && _serialiser;\n    },\n    text: function text(dt) {\n      return dt.i18n('buttons.excel', 'Excel');\n    },\n    action: function action(e, dt, button, config) {\n      var rowPos = 0;\n\n      var getXml = function getXml(type) {\n        var str = excelStrings[type]; //str = str.replace( /xmlns:/g, 'xmlns_' ).replace( /mc:/g, 'mc_' );\n\n        return $.parseXML(str);\n      };\n\n      var rels = getXml('xl/worksheets/sheet1.xml');\n      var relsGet = rels.getElementsByTagName(\"sheetData\")[0];\n      var xlsx = {\n        _rels: {\n          \".rels\": getXml('_rels/.rels')\n        },\n        xl: {\n          _rels: {\n            \"workbook.xml.rels\": getXml('xl/_rels/workbook.xml.rels')\n          },\n          \"workbook.xml\": getXml('xl/workbook.xml'),\n          \"styles.xml\": getXml('xl/styles.xml'),\n          \"worksheets\": {\n            \"sheet1.xml\": rels\n          }\n        },\n        \"[Content_Types].xml\": getXml('[Content_Types].xml')\n      };\n      var data = dt.buttons.exportData(config.exportOptions);\n      var currentRow, rowNode;\n\n      var addRow = function addRow(row) {\n        currentRow = rowPos + 1;\n        rowNode = _createNode(rels, \"row\", {\n          attr: {\n            r: currentRow\n          }\n        });\n\n        for (var i = 0, ien = row.length; i < ien; i++) {\n          // Concat both the Cell Columns as a letter and the Row of the cell.\n          var cellId = createCellPos(i) + '' + currentRow;\n          var cell;\n\n          if (row[i] === null || row[i] === undefined) {\n            row[i] = '';\n          } // Detect numbers - don't match numbers with leading zeros or a negative\n          // anywhere but the start\n\n\n          if (typeof row[i] === 'number' || row[i].match && $.trim(row[i]).match(/^-?\\d+(\\.\\d+)?$/) && !$.trim(row[i]).match(/^0\\d+/)) {\n            cell = _createNode(rels, 'c', {\n              attr: {\n                t: 'n',\n                r: cellId\n              },\n              children: [_createNode(rels, 'v', {\n                text: row[i]\n              })]\n            });\n          } else {\n            // Replace non standard characters for text output\n            var text = !row[i].replace ? row[i] : row[i].replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g, '');\n            cell = _createNode(rels, 'c', {\n              attr: {\n                t: 'inlineStr',\n                r: cellId\n              },\n              children: {\n                row: _createNode(rels, 'is', {\n                  children: {\n                    row: _createNode(rels, 't', {\n                      text: text\n                    })\n                  }\n                })\n              }\n            });\n          }\n\n          rowNode.appendChild(cell);\n        }\n\n        relsGet.appendChild(rowNode);\n        rowPos++;\n      };\n\n      $('sheets sheet', xlsx.xl['workbook.xml']).attr('name', _sheetname(config));\n\n      if (config.customizeData) {\n        config.customizeData(data);\n      }\n\n      if (config.header) {\n        addRow(data.header, rowPos);\n        $('row c', rels).attr('s', '2'); // bold\n      }\n\n      for (var n = 0, ie = data.body.length; n < ie; n++) {\n        addRow(data.body[n], rowPos);\n      }\n\n      if (config.footer && data.footer) {\n        addRow(data.footer, rowPos);\n        $('row:last c', rels).attr('s', '2'); // bold\n      } // Set column widths\n\n\n      var cols = _createNode(rels, 'cols');\n\n      $('worksheet', rels).prepend(cols);\n\n      for (var i = 0, ien = data.header.length; i < ien; i++) {\n        cols.appendChild(_createNode(rels, 'col', {\n          attr: {\n            min: i + 1,\n            max: i + 1,\n            width: _excelColWidth(data, i),\n            customWidth: 1\n          }\n        }));\n      } // Let the developer customise the document if they want to\n\n\n      if (config.customize) {\n        config.customize(xlsx);\n      }\n\n      var jszip = _jsZip();\n\n      var zip = new jszip();\n      var zipConfig = {\n        type: 'blob',\n        mimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n      };\n\n      _addToZip(zip, xlsx);\n\n      if (zip.generateAsync) {\n        // JSZip 3+\n        zip.generateAsync(zipConfig).then(function (blob) {\n          _saveAs(blob, _filename(config));\n        });\n      } else {\n        // JSZip 2.5\n        _saveAs(zip.generate(zipConfig), _filename(config));\n      }\n    },\n    filename: '*',\n    extension: '.xlsx',\n    exportOptions: {},\n    header: true,\n    footer: false\n  }; //\n  // PDF export - using pdfMake - http://pdfmake.org\n  //\n\n  DataTable.ext.buttons.pdfHtml5 = {\n    className: 'buttons-pdf buttons-html5',\n    available: function available() {\n      return window.FileReader !== undefined && _pdfMake();\n    },\n    text: function text(dt) {\n      return dt.i18n('buttons.pdf', 'PDF');\n    },\n    action: function action(e, dt, button, config) {\n      var newLine = _newLine(config);\n\n      var data = dt.buttons.exportData(config.exportOptions);\n      var rows = [];\n\n      if (config.header) {\n        rows.push($.map(data.header, function (d) {\n          return {\n            text: typeof d === 'string' ? d : d + '',\n            style: 'tableHeader'\n          };\n        }));\n      }\n\n      for (var i = 0, ien = data.body.length; i < ien; i++) {\n        rows.push($.map(data.body[i], function (d) {\n          return {\n            text: typeof d === 'string' ? d : d + '',\n            style: i % 2 ? 'tableBodyEven' : 'tableBodyOdd'\n          };\n        }));\n      }\n\n      if (config.footer && data.footer) {\n        rows.push($.map(data.footer, function (d) {\n          return {\n            text: typeof d === 'string' ? d : d + '',\n            style: 'tableFooter'\n          };\n        }));\n      }\n\n      var doc = {\n        pageSize: config.pageSize,\n        pageOrientation: config.orientation,\n        content: [{\n          table: {\n            headerRows: 1,\n            body: rows\n          },\n          layout: 'noBorders'\n        }],\n        styles: {\n          tableHeader: {\n            bold: true,\n            fontSize: 11,\n            color: 'white',\n            fillColor: '#2d4154',\n            alignment: 'center'\n          },\n          tableBodyEven: {},\n          tableBodyOdd: {\n            fillColor: '#f3f3f3'\n          },\n          tableFooter: {\n            bold: true,\n            fontSize: 11,\n            color: 'white',\n            fillColor: '#2d4154'\n          },\n          title: {\n            alignment: 'center',\n            fontSize: 15\n          },\n          message: {}\n        },\n        defaultStyle: {\n          fontSize: 10\n        }\n      };\n\n      if (config.message) {\n        doc.content.unshift({\n          text: typeof config.message == 'function' ? config.message(dt, button, config) : config.message,\n          style: 'message',\n          margin: [0, 0, 0, 12]\n        });\n      }\n\n      if (config.title) {\n        doc.content.unshift({\n          text: _title(config, false),\n          style: 'title',\n          margin: [0, 0, 0, 12]\n        });\n      }\n\n      if (config.customize) {\n        config.customize(doc, config);\n      }\n\n      var pdf = _pdfMake().createPdf(doc);\n\n      if (config.download === 'open' && !_isSafari()) {\n        pdf.open();\n      } else {\n        pdf.getBuffer(function (buffer) {\n          var blob = new Blob([buffer], {\n            type: 'application/pdf'\n          });\n\n          _saveAs(blob, _filename(config));\n        });\n      }\n    },\n    title: '*',\n    filename: '*',\n    extension: '.pdf',\n    exportOptions: {},\n    orientation: 'portrait',\n    pageSize: 'A4',\n    header: true,\n    footer: false,\n    message: null,\n    customize: null,\n    download: 'download'\n  };\n  return DataTable.Buttons;\n});","map":{"version":3,"sources":["/Users/david/Winner-Stock/app/javascript/dataTables/buttons/buttons.html5.js"],"names":["factory","define","amd","$","window","document","exports","module","root","jszip","pdfmake","fn","dataTable","require","Buttons","jQuery","undefined","DataTable","_jsZip","JSZip","_pdfMake","pdfMake","_saveAs","view","navigator","test","userAgent","doc","get_URL","URL","webkitURL","save_link","createElementNS","can_use_save_link","click","node","event","MouseEvent","dispatchEvent","is_safari","webkit_req_fs","webkitRequestFileSystem","req_fs","requestFileSystem","mozRequestFileSystem","throw_outside","ex","setImmediate","setTimeout","force_saveable_type","fs_min_size","arbitrary_revoke_timeout","revoke","file","revoker","revokeObjectURL","remove","dispatch","filesaver","event_types","concat","i","length","listener","call","auto_bom","blob","type","Blob","FileSaver","name","no_auto_bom","blob_changed","object_url","target_view","dispatch_all","split","fs_error","FileReader","reader","onloadend","base64Data","result","location","href","slice","search","readyState","DONE","readAsDataURL","INIT","createObjectURL","new_tab","open","abortable","func","apply","arguments","create_if_not_found","create","exclusive","download","chrome","webkitSlice","size","TEMPORARY","fs","getDirectory","dir","save","getFile","createWriter","writer","onwriteend","toURL","onerror","error","code","ABORT_ERR","forEach","write","abort","WRITING","NOT_FOUND_ERR","FS_proto","prototype","saveAs","msSaveOrOpenBlob","onwritestart","onprogress","onwrite","onabort","self","content","fileSave","_filename","config","incExtension","filename","title","indexOf","trim","replace","text","extension","_sheetname","sheetName","_title","_newLine","newline","match","_exportData","dt","newLine","data","buttons","exportData","exportOptions","boundary","fieldBoundary","separator","fieldSeparator","reBoundary","RegExp","escapeChar","join","a","s","ien","header","footer","body","push","str","rows","_isSafari","createCellPos","n","ordA","charCodeAt","ordZ","len","String","fromCharCode","Math","floor","_serialiser","XMLSerializer","_ieExcel","t","_addToZip","zip","obj","serializeToString","parseXML","excelStrings","each","val","isPlainObject","newDir","folder","worksheet","childNodes","attrs","attributes","attrName","nodeName","attrValue","nodeValue","value","removeAttribute","attr","createAttribute","setAttributeNode","_createNode","opts","tempNode","createElement","children","key","appendChild","createTextNode","_excelColWidth","col","max","toString","ext","copyHtml5","className","i18n","action","e","button","output","hiddenDiv","css","height","width","overflow","position","top","left","customize","textarea","appendTo","queryCommandSupported","table","container","focus","select","successful","execCommand","info","_","message","append","closest","close","off","on","keyCode","csvHtml5","bom","available","charset","characterSet","excelHtml5","rowPos","getXml","rels","relsGet","getElementsByTagName","xlsx","_rels","xl","currentRow","rowNode","addRow","row","r","cellId","cell","customizeData","ie","cols","prepend","min","customWidth","zipConfig","mimeType","generateAsync","then","generate","pdfHtml5","map","d","style","pageSize","pageOrientation","orientation","headerRows","layout","styles","tableHeader","bold","fontSize","color","fillColor","alignment","tableBodyEven","tableBodyOdd","tableFooter","defaultStyle","unshift","margin","pdf","createPdf","getBuffer","buffer"],"mappings":"AAAA;;;;;;;AAQC,WAAUA,OAAV,EAAmB;AACnB,MAAK,OAAOC,MAAP,KAAkB,UAAlB,IAAgCA,MAAM,CAACC,GAA5C,EAAkD;AACjD;AACAD,IAAAA,MAAM,CAAE,CAAC,QAAD,EAAW,gBAAX,EAA6B,wBAA7B,CAAF,EAA0D,UAAWE,CAAX,EAAe;AAC9E,aAAOH,OAAO,CAAEG,CAAF,EAAKC,MAAL,EAAaC,QAAb,CAAd;AACA,KAFK,CAAN;AAGA,GALD,MAMK,IAAK,OAAOC,OAAP,KAAmB,QAAxB,EAAmC;AACvC;AACAC,IAAAA,MAAM,CAACD,OAAP,GAAiB,UAAUE,IAAV,EAAgBL,CAAhB,EAAmBM,KAAnB,EAA0BC,OAA1B,EAAmC;AACnD,UAAK,CAAEF,IAAP,EAAc;AACbA,QAAAA,IAAI,GAAGJ,MAAP;AACA;;AAED,UAAK,CAAED,CAAF,IAAO,CAAEA,CAAC,CAACQ,EAAF,CAAKC,SAAnB,EAA+B;AAC9BT,QAAAA,CAAC,GAAGU,OAAO,CAAC,gBAAD,CAAP,CAA0BL,IAA1B,EAAgCL,CAAhC,EAAmCA,CAAvC;AACA;;AAED,UAAK,CAAEA,CAAC,CAACQ,EAAF,CAAKC,SAAL,CAAeE,OAAtB,EAAgC;AAC/BD,QAAAA,OAAO,CAAC,wBAAD,CAAP,CAAkCL,IAAlC,EAAwCL,CAAxC;AACA;;AAED,aAAOH,OAAO,CAAEG,CAAF,EAAKK,IAAL,EAAWA,IAAI,CAACH,QAAhB,EAA0BI,KAA1B,EAAiCC,OAAjC,CAAd;AACA,KAdD;AAeA,GAjBI,MAkBA;AACJ;AACAV,IAAAA,OAAO,CAAEe,MAAF,EAAUX,MAAV,EAAkBC,QAAlB,CAAP;AACA;AACD,CA7BA,EA6BC,UAAUF,CAAV,EAAaC,MAAb,EAAqBC,QAArB,EAA+BI,KAA/B,EAAsCC,OAAtC,EAA+CM,SAA/C,EAA2D;AAC7D;;AACA,MAAIC,SAAS,GAAGd,CAAC,CAACQ,EAAF,CAAKC,SAArB,CAF6D,CAI7D;AACA;;AACA,WAASM,MAAT,GAAmB;AAClB,WAAOT,KAAK,IAAIL,MAAM,CAACe,KAAvB;AACA;;AACD,WAASC,QAAT,GAAqB;AACpB,WAAOV,OAAO,IAAIN,MAAM,CAACiB,OAAzB;AACA;AAGD;;;;AAIA;;;AAEA,MAAIC,OAAO,GAAI,UAASC,IAAT,EAAe;AAC7B,iBAD6B,CAE7B;;AACA,QAAI,OAAOC,SAAP,KAAqB,WAArB,IAAoC,eAAeC,IAAf,CAAoBD,SAAS,CAACE,SAA9B,CAAxC,EAAkF;AACjF;AACA;;AACD,QACGC,GAAG,GAAGJ,IAAI,CAAClB,QADd,CAEG;AAFH;AAAA,QAGGuB,OAAO,GAAG,SAAVA,OAAU,GAAW;AACtB,aAAOL,IAAI,CAACM,GAAL,IAAYN,IAAI,CAACO,SAAjB,IAA8BP,IAArC;AACA,KALF;AAAA,QAMGQ,SAAS,GAAGJ,GAAG,CAACK,eAAJ,CAAoB,8BAApB,EAAoD,GAApD,CANf;AAAA,QAOGC,iBAAiB,IAAG,cAAcF,SAAjB,CAPpB;AAAA,QAQGG,KAAK,GAAG,SAARA,KAAQ,CAASC,IAAT,EAAe;AACxB,UAAIC,KAAK,GAAG,IAAIC,UAAJ,CAAe,OAAf,CAAZ;AACAF,MAAAA,IAAI,CAACG,aAAL,CAAmBF,KAAnB;AACA,KAXF;AAAA,QAYGG,SAAS,GAAG,2BAA2Bd,IAA3B,CAAgCD,SAAS,CAACE,SAA1C,CAZf;AAAA,QAaGc,aAAa,GAAGjB,IAAI,CAACkB,uBAbxB;AAAA,QAcGC,MAAM,GAAGnB,IAAI,CAACoB,iBAAL,IAA0BH,aAA1B,IAA2CjB,IAAI,CAACqB,oBAd5D;AAAA,QAeGC,aAAa,GAAG,SAAhBA,aAAgB,CAASC,EAAT,EAAa;AAC9B,OAACvB,IAAI,CAACwB,YAAL,IAAqBxB,IAAI,CAACyB,UAA3B,EAAuC,YAAW;AACjD,cAAMF,EAAN;AACA,OAFD,EAEG,CAFH;AAGA,KAnBF;AAAA,QAoBGG,mBAAmB,GAAG,0BApBzB;AAAA,QAqBGC,WAAW,GAAG,CArBjB,CAsBC;AAtBD;AAAA,QAuBGC,wBAAwB,GAAG,OAAO,EAvBrC,CAuBwC;AAvBxC;AAAA,QAwBGC,MAAM,GAAG,SAATA,MAAS,CAASC,IAAT,EAAe;AACzB,UAAIC,OAAO,GAAG,SAAVA,OAAU,GAAW;AACxB,YAAI,OAAOD,IAAP,KAAgB,QAApB,EAA8B;AAAE;AAC/BzB,UAAAA,OAAO,GAAG2B,eAAV,CAA0BF,IAA1B;AACA,SAFD,MAEO;AAAE;AACRA,UAAAA,IAAI,CAACG,MAAL;AACA;AACD,OAND;AAOA;;;;;;;;;;;;;;;;;;AAgBAR,MAAAA,UAAU,CAACM,OAAD,EAAUH,wBAAV,CAAV;AACA,KAjDF;AAAA,QAkDGM,QAAQ,GAAG,SAAXA,QAAW,CAASC,SAAT,EAAoBC,WAApB,EAAiCvB,KAAjC,EAAwC;AACpDuB,MAAAA,WAAW,GAAG,GAAGC,MAAH,CAAUD,WAAV,CAAd;AACA,UAAIE,CAAC,GAAGF,WAAW,CAACG,MAApB;;AACA,aAAOD,CAAC,EAAR,EAAY;AACX,YAAIE,QAAQ,GAAGL,SAAS,CAAC,OAAOC,WAAW,CAACE,CAAD,CAAnB,CAAxB;;AACA,YAAI,OAAOE,QAAP,KAAoB,UAAxB,EAAoC;AACnC,cAAI;AACHA,YAAAA,QAAQ,CAACC,IAAT,CAAcN,SAAd,EAAyBtB,KAAK,IAAIsB,SAAlC;AACA,WAFD,CAEE,OAAOZ,EAAP,EAAW;AACZD,YAAAA,aAAa,CAACC,EAAD,CAAb;AACA;AACD;AACD;AACD,KA/DF;AAAA,QAgEGmB,QAAQ,GAAG,SAAXA,QAAW,CAASC,IAAT,EAAe;AAC3B;AACA,UAAI,6EAA6EzC,IAA7E,CAAkFyC,IAAI,CAACC,IAAvF,CAAJ,EAAkG;AACjG,eAAO,IAAIC,IAAJ,CAAS,CAAC,QAAD,EAAWF,IAAX,CAAT,EAA2B;AAACC,UAAAA,IAAI,EAAED,IAAI,CAACC;AAAZ,SAA3B,CAAP;AACA;;AACD,aAAOD,IAAP;AACA,KAtEF;AAAA,QAuEGG,SAAS,GAAG,SAAZA,SAAY,CAASH,IAAT,EAAeI,IAAf,EAAqBC,WAArB,EAAkC;AAC/C,UAAI,CAACA,WAAL,EAAkB;AACjBL,QAAAA,IAAI,GAAGD,QAAQ,CAACC,IAAD,CAAf;AACA,OAH8C,CAI/C;;;AACA,UACGR,SAAS,GAAG,IADf;AAAA,UAEGS,IAAI,GAAGD,IAAI,CAACC,IAFf;AAAA,UAGGK,YAAY,GAAG,KAHlB;AAAA,UAIGC,UAJH;AAAA,UAKGC,WALH;AAAA,UAMGC,YAAY,GAAG,SAAfA,YAAe,GAAW;AAC3BlB,QAAAA,QAAQ,CAACC,SAAD,EAAY,qCAAqCkB,KAArC,CAA2C,GAA3C,CAAZ,CAAR;AACA,OARF,CASC;AATD;AAAA,UAUGC,QAAQ,GAAG,SAAXA,QAAW,GAAW;AACvB,YAAIH,WAAW,IAAInC,SAAf,IAA4B,OAAOuC,UAAP,KAAsB,WAAtD,EAAmE;AAClE;AACA,cAAIC,MAAM,GAAG,IAAID,UAAJ,EAAb;;AACAC,UAAAA,MAAM,CAACC,SAAP,GAAmB,YAAW;AAC7B,gBAAIC,UAAU,GAAGF,MAAM,CAACG,MAAxB;AACAR,YAAAA,WAAW,CAACS,QAAZ,CAAqBC,IAArB,GAA4B,yBAAyBH,UAAU,CAACI,KAAX,CAAiBJ,UAAU,CAACK,MAAX,CAAkB,MAAlB,CAAjB,CAArD;AACA5B,YAAAA,SAAS,CAAC6B,UAAV,GAAuB7B,SAAS,CAAC8B,IAAjC;AACAb,YAAAA,YAAY;AACZ,WALD;;AAMAI,UAAAA,MAAM,CAACU,aAAP,CAAqBvB,IAArB;AACAR,UAAAA,SAAS,CAAC6B,UAAV,GAAuB7B,SAAS,CAACgC,IAAjC;AACA;AACA,SAbsB,CAcvB;;;AACA,YAAIlB,YAAY,IAAI,CAACC,UAArB,EAAiC;AAChCA,UAAAA,UAAU,GAAG7C,OAAO,GAAG+D,eAAV,CAA0BzB,IAA1B,CAAb;AACA;;AACD,YAAIQ,WAAJ,EAAiB;AAChBA,UAAAA,WAAW,CAACS,QAAZ,CAAqBC,IAArB,GAA4BX,UAA5B;AACA,SAFD,MAEO;AACN,cAAImB,OAAO,GAAGrE,IAAI,CAACsE,IAAL,CAAUpB,UAAV,EAAsB,QAAtB,CAAd;;AACA,cAAImB,OAAO,KAAK5E,SAAZ,IAAyBuB,SAA7B,EAAwC;AACvC;AACAhB,YAAAA,IAAI,CAAC4D,QAAL,CAAcC,IAAd,GAAqBX,UAArB;AACA;AACD;;AACDf,QAAAA,SAAS,CAAC6B,UAAV,GAAuB7B,SAAS,CAAC8B,IAAjC;AACAb,QAAAA,YAAY;AACZvB,QAAAA,MAAM,CAACqB,UAAD,CAAN;AACA,OAxCF;AAAA,UAyCGqB,SAAS,GAAG,SAAZA,SAAY,CAASC,IAAT,EAAe;AAC5B,eAAO,YAAW;AACjB,cAAIrC,SAAS,CAAC6B,UAAV,KAAyB7B,SAAS,CAAC8B,IAAvC,EAA6C;AAC5C,mBAAOO,IAAI,CAACC,KAAL,CAAW,IAAX,EAAiBC,SAAjB,CAAP;AACA;AACD,SAJD;AAKA,OA/CF;AAAA,UAgDGC,mBAAmB,GAAG;AAACC,QAAAA,MAAM,EAAE,IAAT;AAAeC,QAAAA,SAAS,EAAE;AAA1B,OAhDzB;AAAA,UAiDGf,KAjDH;;AAmDA3B,MAAAA,SAAS,CAAC6B,UAAV,GAAuB7B,SAAS,CAACgC,IAAjC;;AACA,UAAI,CAACpB,IAAL,EAAW;AACVA,QAAAA,IAAI,GAAG,UAAP;AACA;;AACD,UAAIrC,iBAAJ,EAAuB;AACtBwC,QAAAA,UAAU,GAAG7C,OAAO,GAAG+D,eAAV,CAA0BzB,IAA1B,CAAb;AACAlB,QAAAA,UAAU,CAAC,YAAW;AACrBjB,UAAAA,SAAS,CAACqD,IAAV,GAAiBX,UAAjB;AACA1C,UAAAA,SAAS,CAACsE,QAAV,GAAqB/B,IAArB;AACApC,UAAAA,KAAK,CAACH,SAAD,CAAL;AACA4C,UAAAA,YAAY;AACZvB,UAAAA,MAAM,CAACqB,UAAD,CAAN;AACAf,UAAAA,SAAS,CAAC6B,UAAV,GAAuB7B,SAAS,CAAC8B,IAAjC;AACA,SAPS,CAAV;AAQA;AACA,OAvE8C,CAwE/C;AACA;AACA;AACA;AACA;;;AACA,UAAIjE,IAAI,CAAC+E,MAAL,IAAenC,IAAf,IAAuBA,IAAI,KAAKlB,mBAApC,EAAyD;AACxDoC,QAAAA,KAAK,GAAGnB,IAAI,CAACmB,KAAL,IAAcnB,IAAI,CAACqC,WAA3B;AACArC,QAAAA,IAAI,GAAGmB,KAAK,CAACrB,IAAN,CAAWE,IAAX,EAAiB,CAAjB,EAAoBA,IAAI,CAACsC,IAAzB,EAA+BvD,mBAA/B,CAAP;AACAuB,QAAAA,YAAY,GAAG,IAAf;AACA,OAjF8C,CAkF/C;AACA;AACA;;;AACA,UAAIhC,aAAa,IAAI8B,IAAI,KAAK,UAA9B,EAA0C;AACzCA,QAAAA,IAAI,IAAI,WAAR;AACA;;AACD,UAAIH,IAAI,KAAKlB,mBAAT,IAAgCT,aAApC,EAAmD;AAClDkC,QAAAA,WAAW,GAAGnD,IAAd;AACA;;AACD,UAAI,CAACmB,MAAL,EAAa;AACZmC,QAAAA,QAAQ;AACR;AACA;;AACD3B,MAAAA,WAAW,IAAIgB,IAAI,CAACsC,IAApB;AACA9D,MAAAA,MAAM,CAACnB,IAAI,CAACkF,SAAN,EAAiBvD,WAAjB,EAA8B4C,SAAS,CAAC,UAASY,EAAT,EAAa;AAC1DA,QAAAA,EAAE,CAAClG,IAAH,CAAQmG,YAAR,CAAqB,OAArB,EAA8BT,mBAA9B,EAAmDJ,SAAS,CAAC,UAASc,GAAT,EAAc;AAC1E,cAAIC,IAAI,GAAG,SAAPA,IAAO,GAAW;AACrBD,YAAAA,GAAG,CAACE,OAAJ,CAAYxC,IAAZ,EAAkB4B,mBAAlB,EAAuCJ,SAAS,CAAC,UAASzC,IAAT,EAAe;AAC/DA,cAAAA,IAAI,CAAC0D,YAAL,CAAkBjB,SAAS,CAAC,UAASkB,MAAT,EAAiB;AAC5CA,gBAAAA,MAAM,CAACC,UAAP,GAAoB,UAAS7E,KAAT,EAAgB;AACnCsC,kBAAAA,WAAW,CAACS,QAAZ,CAAqBC,IAArB,GAA4B/B,IAAI,CAAC6D,KAAL,EAA5B;AACAxD,kBAAAA,SAAS,CAAC6B,UAAV,GAAuB7B,SAAS,CAAC8B,IAAjC;AACA/B,kBAAAA,QAAQ,CAACC,SAAD,EAAY,UAAZ,EAAwBtB,KAAxB,CAAR;AACAgB,kBAAAA,MAAM,CAACC,IAAD,CAAN;AACA,iBALD;;AAMA2D,gBAAAA,MAAM,CAACG,OAAP,GAAiB,YAAW;AAC3B,sBAAIC,KAAK,GAAGJ,MAAM,CAACI,KAAnB;;AACA,sBAAIA,KAAK,CAACC,IAAN,KAAeD,KAAK,CAACE,SAAzB,EAAoC;AACnCzC,oBAAAA,QAAQ;AACR;AACD,iBALD;;AAMA,kDAAkCD,KAAlC,CAAwC,GAAxC,EAA6C2C,OAA7C,CAAqD,UAASnF,KAAT,EAAgB;AACpE4E,kBAAAA,MAAM,CAAC,OAAO5E,KAAR,CAAN,GAAuBsB,SAAS,CAAC,OAAOtB,KAAR,CAAhC;AACA,iBAFD;AAGA4E,gBAAAA,MAAM,CAACQ,KAAP,CAAatD,IAAb;;AACAR,gBAAAA,SAAS,CAAC+D,KAAV,GAAkB,YAAW;AAC5BT,kBAAAA,MAAM,CAACS,KAAP;AACA/D,kBAAAA,SAAS,CAAC6B,UAAV,GAAuB7B,SAAS,CAAC8B,IAAjC;AACA,iBAHD;;AAIA9B,gBAAAA,SAAS,CAAC6B,UAAV,GAAuB7B,SAAS,CAACgE,OAAjC;AACA,eAtB0B,CAA3B,EAsBI7C,QAtBJ;AAuBA,aAxB+C,CAAhD,EAwBIA,QAxBJ;AAyBA,WA1BD;;AA2BA+B,UAAAA,GAAG,CAACE,OAAJ,CAAYxC,IAAZ,EAAkB;AAAC6B,YAAAA,MAAM,EAAE;AAAT,WAAlB,EAAmCL,SAAS,CAAC,UAASzC,IAAT,EAAe;AAC3D;AACAA,YAAAA,IAAI,CAACG,MAAL;AACAqD,YAAAA,IAAI;AACJ,WAJ2C,CAA5C,EAIIf,SAAS,CAAC,UAAShD,EAAT,EAAa;AAC1B,gBAAIA,EAAE,CAACuE,IAAH,KAAYvE,EAAE,CAAC6E,aAAnB,EAAkC;AACjCd,cAAAA,IAAI;AACJ,aAFD,MAEO;AACNhC,cAAAA,QAAQ;AACR;AACD,WANY,CAJb;AAWA,SAvC2D,CAA5D,EAuCIA,QAvCJ;AAwCA,OAzC4C,CAAvC,EAyCFA,QAzCE,CAAN;AA0CA,KAjNF;AAAA,QAkNG+C,QAAQ,GAAGvD,SAAS,CAACwD,SAlNxB;AAAA,QAmNGC,MAAM,GAAG,SAATA,MAAS,CAAS5D,IAAT,EAAeI,IAAf,EAAqBC,WAArB,EAAkC;AAC5C,aAAO,IAAIF,SAAJ,CAAcH,IAAd,EAAoBI,IAApB,EAA0BC,WAA1B,CAAP;AACA,KArNF,CAN6B,CA6N7B;;;AACA,QAAI,OAAO/C,SAAP,KAAqB,WAArB,IAAoCA,SAAS,CAACuG,gBAAlD,EAAoE;AACnE,aAAO,UAAS7D,IAAT,EAAeI,IAAf,EAAqBC,WAArB,EAAkC;AACxC,YAAI,CAACA,WAAL,EAAkB;AACjBL,UAAAA,IAAI,GAAGD,QAAQ,CAACC,IAAD,CAAf;AACA;;AACD,eAAO1C,SAAS,CAACuG,gBAAV,CAA2B7D,IAA3B,EAAiCI,IAAI,IAAI,UAAzC,CAAP;AACA,OALD;AAMA;;AAEDsD,IAAAA,QAAQ,CAACH,KAAT,GAAiB,YAAW;AAC3B,UAAI/D,SAAS,GAAG,IAAhB;AACAA,MAAAA,SAAS,CAAC6B,UAAV,GAAuB7B,SAAS,CAAC8B,IAAjC;AACA/B,MAAAA,QAAQ,CAACC,SAAD,EAAY,OAAZ,CAAR;AACA,KAJD;;AAKAkE,IAAAA,QAAQ,CAACrC,UAAT,GAAsBqC,QAAQ,CAAClC,IAAT,GAAgB,CAAtC;AACAkC,IAAAA,QAAQ,CAACF,OAAT,GAAmB,CAAnB;AACAE,IAAAA,QAAQ,CAACpC,IAAT,GAAgB,CAAhB;AAEAoC,IAAAA,QAAQ,CAACR,KAAT,GACAQ,QAAQ,CAACI,YAAT,GACAJ,QAAQ,CAACK,UAAT,GACAL,QAAQ,CAACM,OAAT,GACAN,QAAQ,CAACO,OAAT,GACAP,QAAQ,CAACT,OAAT,GACAS,QAAQ,CAACX,UAAT,GACC,IAPD;AASA,WAAOa,MAAP;AACA,GA1Pc,CA2PX,OAAOM,IAAP,KAAgB,WAAhB,IAA+BA,IAA/B,IACA,OAAOhI,MAAP,KAAkB,WAAlB,IAAiCA,MADjC,IAEA,KAAKiI,OA7PM,CAAf,CApB6D,CAqR7D;AACA;;;AACApH,EAAAA,SAAS,CAACqH,QAAV,GAAqBhH,OAArB;AAGA;;;;AAIA;;;;;;;AAMA,MAAIiH,SAAS,GAAG,SAAZA,SAAY,CAAWC,MAAX,EAAmBC,YAAnB,EAChB;AACC;AACA,QAAIC,QAAQ,GAAGF,MAAM,CAACE,QAAP,KAAoB,GAApB,IAA2BF,MAAM,CAACG,KAAP,KAAiB,GAA5C,IAAmDH,MAAM,CAACG,KAAP,KAAiB3H,SAApE,GACdwH,MAAM,CAACG,KADO,GAEdH,MAAM,CAACE,QAFR;;AAIA,QAAK,OAAOA,QAAP,KAAoB,UAAzB,EAAsC;AACrCA,MAAAA,QAAQ,GAAGA,QAAQ,EAAnB;AACA;;AAED,QAAKA,QAAQ,CAACE,OAAT,CAAkB,GAAlB,MAA4B,CAAC,CAAlC,EAAsC;AACrCF,MAAAA,QAAQ,GAAGvI,CAAC,CAAC0I,IAAF,CAAQH,QAAQ,CAACI,OAAT,CAAkB,GAAlB,EAAuB3I,CAAC,CAAC,OAAD,CAAD,CAAW4I,IAAX,EAAvB,CAAR,CAAX;AACA,KAZF,CAcC;;;AACAL,IAAAA,QAAQ,GAAGA,QAAQ,CAACI,OAAT,CAAiB,yCAAjB,EAA4D,EAA5D,CAAX;AAEA,WAAOL,YAAY,KAAKzH,SAAjB,IAA8ByH,YAAY,KAAK,IAA/C,GACNC,QAAQ,GAACF,MAAM,CAACQ,SADV,GAENN,QAFD;AAGA,GArBD;AAuBA;;;;;;;AAKA,MAAIO,UAAU,GAAG,SAAbA,UAAa,CAAWT,MAAX,EACjB;AACC,QAAIU,SAAS,GAAG,QAAhB;;AAEA,QAAKV,MAAM,CAACU,SAAZ,EAAwB;AACvBA,MAAAA,SAAS,GAAGV,MAAM,CAACU,SAAP,CAAiBJ,OAAjB,CAAyB,mBAAzB,EAA8C,EAA9C,CAAZ;AACA;;AAEF,WAAOI,SAAP;AACC,GATD;AAWA;;;;;;;AAKA,MAAIC,MAAM,GAAG,SAATA,MAAS,CAAWX,MAAX,EACb;AACC,QAAIG,KAAK,GAAGH,MAAM,CAACG,KAAnB;;AAEA,QAAK,OAAOA,KAAP,KAAiB,UAAtB,EAAmC;AAClCA,MAAAA,KAAK,GAAGA,KAAK,EAAb;AACA;;AAED,WAAOA,KAAK,CAACC,OAAN,CAAe,GAAf,MAAyB,CAAC,CAA1B,GACND,KAAK,CAACG,OAAN,CAAe,GAAf,EAAoB3I,CAAC,CAAC,OAAD,CAAD,CAAW4I,IAAX,MAAqB,eAAzC,CADM,GAENJ,KAFD;AAGA,GAXD;AAaA;;;;;;;;AAMA,MAAIS,QAAQ,GAAG,SAAXA,QAAW,CAAWZ,MAAX,EACf;AACC,WAAOA,MAAM,CAACa,OAAP,GACNb,MAAM,CAACa,OADD,GAEN7H,SAAS,CAACE,SAAV,CAAoB4H,KAApB,CAA0B,SAA1B,IACC,MADD,GAEC,IAJF;AAKA,GAPD;AASA;;;;;;;;;;AAQA,MAAIC,WAAW,GAAG,SAAdA,WAAc,CAAWC,EAAX,EAAehB,MAAf,EAClB;AACC,QAAIiB,OAAO,GAAGL,QAAQ,CAAEZ,MAAF,CAAtB;;AACA,QAAIkB,IAAI,GAAGF,EAAE,CAACG,OAAH,CAAWC,UAAX,CAAuBpB,MAAM,CAACqB,aAA9B,CAAX;AACA,QAAIC,QAAQ,GAAGtB,MAAM,CAACuB,aAAtB;AACA,QAAIC,SAAS,GAAGxB,MAAM,CAACyB,cAAvB;AACA,QAAIC,UAAU,GAAG,IAAIC,MAAJ,CAAYL,QAAZ,EAAsB,GAAtB,CAAjB;AACA,QAAIM,UAAU,GAAG5B,MAAM,CAAC4B,UAAP,KAAsBpJ,SAAtB,GAChBwH,MAAM,CAAC4B,UADS,GAEhB,IAFD;;AAGA,QAAIC,IAAI,GAAG,SAAPA,IAAO,CAAWC,CAAX,EAAe;AACzB,UAAIC,CAAC,GAAG,EAAR,CADyB,CAGzB;AACA;;AACA,WAAM,IAAI1G,CAAC,GAAC,CAAN,EAAS2G,GAAG,GAACF,CAAC,CAACxG,MAArB,EAA8BD,CAAC,GAAC2G,GAAhC,EAAsC3G,CAAC,EAAvC,EAA4C;AAC3C,YAAKA,CAAC,GAAG,CAAT,EAAa;AACZ0G,UAAAA,CAAC,IAAIP,SAAL;AACA;;AAEDO,QAAAA,CAAC,IAAIT,QAAQ,GACZA,QAAQ,GAAG,CAAC,KAAKQ,CAAC,CAACzG,CAAD,CAAP,EAAYiF,OAAZ,CAAqBoB,UAArB,EAAiCE,UAAU,GAACN,QAA5C,CAAX,GAAoEA,QADxD,GAEZQ,CAAC,CAACzG,CAAD,CAFF;AAGA;;AAED,aAAO0G,CAAP;AACA,KAhBD;;AAkBA,QAAIE,MAAM,GAAGjC,MAAM,CAACiC,MAAP,GAAgBJ,IAAI,CAAEX,IAAI,CAACe,MAAP,CAAJ,GAAoBhB,OAApC,GAA8C,EAA3D;AACA,QAAIiB,MAAM,GAAGlC,MAAM,CAACkC,MAAP,IAAiBhB,IAAI,CAACgB,MAAtB,GAA+BjB,OAAO,GAACY,IAAI,CAAEX,IAAI,CAACgB,MAAP,CAA3C,GAA6D,EAA1E;AACA,QAAIC,IAAI,GAAG,EAAX;;AAEA,SAAM,IAAI9G,CAAC,GAAC,CAAN,EAAS2G,GAAG,GAACd,IAAI,CAACiB,IAAL,CAAU7G,MAA7B,EAAsCD,CAAC,GAAC2G,GAAxC,EAA8C3G,CAAC,EAA/C,EAAoD;AACnD8G,MAAAA,IAAI,CAACC,IAAL,CAAWP,IAAI,CAAEX,IAAI,CAACiB,IAAL,CAAU9G,CAAV,CAAF,CAAf;AACA;;AAED,WAAO;AACNgH,MAAAA,GAAG,EAAEJ,MAAM,GAAGE,IAAI,CAACN,IAAL,CAAWZ,OAAX,CAAT,GAAgCiB,MAD/B;AAENI,MAAAA,IAAI,EAAEH,IAAI,CAAC7G;AAFL,KAAP;AAIA,GAxCD;AA0CA;;;;;;;;;AAOA,MAAIiH,SAAS,GAAG,SAAZA,SAAY,GAChB;AACC,WAAOvJ,SAAS,CAACE,SAAV,CAAoBkH,OAApB,CAA4B,QAA5B,MAA0C,CAAC,CAA3C,IACNpH,SAAS,CAACE,SAAV,CAAoBkH,OAApB,CAA4B,QAA5B,MAA0C,CAAC,CADrC,IAENpH,SAAS,CAACE,SAAV,CAAoBkH,OAApB,CAA4B,OAA5B,MAAyC,CAAC,CAF3C;AAGA,GALD;AAOA;;;;;;;AAKA,WAASoC,aAAT,CAAwBC,CAAxB,EAA2B;AAC1B,QAAIC,IAAI,GAAG,IAAIC,UAAJ,CAAe,CAAf,CAAX;AACA,QAAIC,IAAI,GAAG,IAAID,UAAJ,CAAe,CAAf,CAAX;AACA,QAAIE,GAAG,GAAGD,IAAI,GAAGF,IAAP,GAAc,CAAxB;AACA,QAAIX,CAAC,GAAG,EAAR;;AAEA,WAAOU,CAAC,IAAI,CAAZ,EAAgB;AACfV,MAAAA,CAAC,GAAGe,MAAM,CAACC,YAAP,CAAoBN,CAAC,GAAGI,GAAJ,GAAUH,IAA9B,IAAsCX,CAA1C;AACAU,MAAAA,CAAC,GAAGO,IAAI,CAACC,KAAL,CAAWR,CAAC,GAAGI,GAAf,IAAsB,CAA1B;AACA;;AAED,WAAOd,CAAP;AACA;;AAED,MAAI;AACH,QAAImB,WAAW,GAAG,IAAIC,aAAJ,EAAlB;;AACA,QAAIC,QAAJ;AACA,GAHD,CAIA,OAAOC,CAAP,EAAU,CAAE;AAEZ;;;;;;;;;;AAQA,WAASC,SAAT,CAAoBC,GAApB,EAAyBC,GAAzB,EAA+B;AAC9B,QAAKJ,QAAQ,KAAK5K,SAAlB,EAA8B;AAC7B;AACA;AACA4K,MAAAA,QAAQ,GAAGF,WAAW,CACpBO,iBADS,CAET9L,CAAC,CAAC+L,QAAF,CAAYC,YAAY,CAAC,0BAAD,CAAxB,CAFS,EAITvD,OAJS,CAIA,SAJA,MAIgB,CAAC,CAJ5B;AAKA;;AAEDzI,IAAAA,CAAC,CAACiM,IAAF,CAAQJ,GAAR,EAAa,UAAW1H,IAAX,EAAiB+H,GAAjB,EAAuB;AACnC,UAAKlM,CAAC,CAACmM,aAAF,CAAiBD,GAAjB,CAAL,EAA8B;AAC7B,YAAIE,MAAM,GAAGR,GAAG,CAACS,MAAJ,CAAYlI,IAAZ,CAAb;;AACAwH,QAAAA,SAAS,CAAES,MAAF,EAAUF,GAAV,CAAT;AACA,OAHD,MAIK;AACJ,YAAKT,QAAL,EAAgB;AACf;AACA;AACA;AACA;AACA;AACA,cAAIa,SAAS,GAAGJ,GAAG,CAACK,UAAJ,CAAe,CAAf,CAAhB;AACA,cAAI7I,CAAJ,EAAO2G,GAAP;AACA,cAAImC,KAAK,GAAG,EAAZ;;AAEA,eAAM9I,CAAC,GAAC4I,SAAS,CAACG,UAAV,CAAqB9I,MAArB,GAA4B,CAApC,EAAwCD,CAAC,IAAE,CAA3C,EAA+CA,CAAC,EAAhD,EAAqD;AACpD,gBAAIgJ,QAAQ,GAAGJ,SAAS,CAACG,UAAV,CAAqB/I,CAArB,EAAwBiJ,QAAvC;AACA,gBAAIC,SAAS,GAAGN,SAAS,CAACG,UAAV,CAAqB/I,CAArB,EAAwBmJ,SAAxC;;AAEA,gBAAKH,QAAQ,CAACjE,OAAT,CAAkB,GAAlB,MAA4B,CAAC,CAAlC,EAAsC;AACrC+D,cAAAA,KAAK,CAAC/B,IAAN,CAAY;AAAEtG,gBAAAA,IAAI,EAAEuI,QAAR;AAAkBI,gBAAAA,KAAK,EAAEF;AAAzB,eAAZ;AAEAN,cAAAA,SAAS,CAACS,eAAV,CAA2BL,QAA3B;AACA;AACD;;AAED,eAAMhJ,CAAC,GAAC,CAAF,EAAK2G,GAAG,GAACmC,KAAK,CAAC7I,MAArB,EAA8BD,CAAC,GAAC2G,GAAhC,EAAsC3G,CAAC,EAAvC,EAA4C;AAC3C,gBAAIsJ,IAAI,GAAGd,GAAG,CAACe,eAAJ,CAAqBT,KAAK,CAAC9I,CAAD,CAAL,CAASS,IAAT,CAAcwE,OAAd,CAAuB,GAAvB,EAA4B,wBAA5B,CAArB,CAAX;AACAqE,YAAAA,IAAI,CAACF,KAAL,GAAaN,KAAK,CAAC9I,CAAD,CAAL,CAASoJ,KAAtB;AACAR,YAAAA,SAAS,CAACY,gBAAV,CAA4BF,IAA5B;AACA;AACD;;AAED,YAAItC,GAAG,GAAGa,WAAW,CAACO,iBAAZ,CAA8BI,GAA9B,CAAV,CA7BI,CA+BJ;;;AACA,YAAKT,QAAL,EAAgB;AACf;AACA,cAAKf,GAAG,CAACjC,OAAJ,CAAa,OAAb,MAA2B,CAAC,CAAjC,EAAqC;AACpCiC,YAAAA,GAAG,GAAG,4DAA0DA,GAAhE;AACA,WAJc,CAMf;;;AACAA,UAAAA,GAAG,GAAGA,GAAG,CAAC/B,OAAJ,CAAa,yBAAb,EAAwC,GAAxC,CAAN;AACA,SAxCG,CA0CJ;AACA;;;AACA+B,QAAAA,GAAG,GAAGA,GAAG,CACP/B,OADI,CACK,iBADL,EACwB,OADxB,EAEJA,OAFI,CAEK,kBAFL,EAEyB,QAFzB,CAAN;AAIAiD,QAAAA,GAAG,CAAC1I,IAAJ,CAAUiB,IAAV,EAAgBuG,GAAhB;AACA;AACD,KAvDD;AAwDA;AAED;;;;;;;;;;;;AAUA,WAASyC,WAAT,CAAsB3L,GAAtB,EAA2BmL,QAA3B,EAAqCS,IAArC,EAA4C;AAC3C,QAAIC,QAAQ,GAAG7L,GAAG,CAAC8L,aAAJ,CAAmBX,QAAnB,CAAf;;AAEA,QAAKS,IAAL,EAAY;AACX,UAAKA,IAAI,CAACJ,IAAV,EAAiB;AAChBhN,QAAAA,CAAC,CAACqN,QAAD,CAAD,CAAYL,IAAZ,CAAkBI,IAAI,CAACJ,IAAvB;AACA;;AAED,UAAII,IAAI,CAACG,QAAT,EAAoB;AACnBvN,QAAAA,CAAC,CAACiM,IAAF,CAAQmB,IAAI,CAACG,QAAb,EAAuB,UAAWC,GAAX,EAAgBV,KAAhB,EAAwB;AAC9CO,UAAAA,QAAQ,CAACI,WAAT,CAAsBX,KAAtB;AACA,SAFD;AAGA;;AAED,UAAIM,IAAI,CAACxE,IAAT,EAAgB;AACfyE,QAAAA,QAAQ,CAACI,WAAT,CAAsBjM,GAAG,CAACkM,cAAJ,CAAoBN,IAAI,CAACxE,IAAzB,CAAtB;AACA;AACD;;AAED,WAAOyE,QAAP;AACA;AAED;;;;;;;;AAMA,WAASM,cAAT,CAAyBpE,IAAzB,EAA+BqE,GAA/B,EAAqC;AACpC,QAAIC,GAAG,GAAGtE,IAAI,CAACe,MAAL,CAAYsD,GAAZ,EAAiBjK,MAA3B;AACA,QAAIuH,GAAJ;;AAEA,QAAK3B,IAAI,CAACgB,MAAL,IAAehB,IAAI,CAACgB,MAAL,CAAYqD,GAAZ,EAAiBjK,MAAjB,GAA0BkK,GAA9C,EAAoD;AACnDA,MAAAA,GAAG,GAAGtE,IAAI,CAACgB,MAAL,CAAYqD,GAAZ,EAAiBjK,MAAvB;AACA;;AAED,SAAM,IAAID,CAAC,GAAC,CAAN,EAAS2G,GAAG,GAACd,IAAI,CAACiB,IAAL,CAAU7G,MAA7B,EAAsCD,CAAC,GAAC2G,GAAxC,EAA8C3G,CAAC,EAA/C,EAAoD;AACnDwH,MAAAA,GAAG,GAAG3B,IAAI,CAACiB,IAAL,CAAU9G,CAAV,EAAakK,GAAb,EAAkBE,QAAlB,GAA6BnK,MAAnC;;AAEA,UAAKuH,GAAG,GAAG2C,GAAX,EAAiB;AAChBA,QAAAA,GAAG,GAAG3C,GAAN;AACA,OALkD,CAOnD;;;AACA,UAAK2C,GAAG,GAAG,EAAX,EAAgB;AACf;AACA;AACD,KAnBmC,CAqBpC;;;AACA,WAAOA,GAAG,GAAG,CAAN,GAAUA,GAAV,GAAgB,CAAvB;AACA,GA/kB4D,CAilB7D;;;AACA,MAAI7B,YAAY,GAAG;AAClB,mBACC,4DACA,sFADA,GAEC,8IAFD,GAGA,kBALiB;AAOlB,kCACC,4DACA,sFADA,GAEC,+IAFD,GAGC,iIAHD,GAIA,kBAZiB;AAclB,2BACC,4DACA,8EADA,GAEC,2DAFD,GAGC,qGAHD,GAIC,uDAJD,GAKC,mIALD,GAMC,2IAND,GAOC,6HAPD,GAQA,UAvBiB;AAyBlB,uBACC,4DACA,4JADA,GAEC,8EAFD,GAGC,8DAHD,GAIC,aAJD,GAKE,iGALF,GAMC,cAND,GAOC,UAPD,GAQE,0CARF,GASC,WATD,GAUA,aApCiB;AAsClB,gCACC,4DACA,mUADA,GAEC,cAFD,GAGA,cA1CiB;AA4ClB,qBACC,2CACA,sPADA,GAEC,wCAFD,GAGE,QAHF,GAIG,iBAJH,GAKG,wBALH,GAME,SANF,GAOE,QAPF,GAQG,iBARH,GASG,wBATH,GAUG,0BAVH,GAWE,SAXF,GAYE,QAZF,GAaG,iBAbH,GAcG,wBAdH,GAeG,OAfH,GAgBE,SAhBF,GAiBE,QAjBF,GAkBG,iBAlBH,GAmBG,wBAnBH,GAoBG,OApBH,GAqBE,SArBF,GAsBE,QAtBF,GAuBG,iBAvBH,GAwBG,wBAxBH,GAyBG,OAzBH,GA0BE,SA1BF,GA2BC,UA3BD,GA4BC,mBA5BD,GA6BE,QA7BF,GA8BG,oCA9BH,GA+BE,SA/BF,GAgCE,SAhCF,GAgCa;AACX,YAjCF,GAkCG,mCAlCH,GAmCI,4BAnCJ,GAoCI,0BApCJ,GAqCG,gBArCH,GAsCE,SAtCF,GAuCE,QAvCF,GAwCG,mCAxCH,GAyCI,4BAzCJ,GA0CI,0BA1CJ,GA2CG,gBA3CH,GA4CE,SA5CF,GA6CE,QA7CF,GA8CG,mCA9CH,GA+CI,4BA/CJ,GAgDI,0BAhDJ,GAiDG,gBAjDH,GAkDE,SAlDF,GAmDE,QAnDF,GAoDG,mCApDH,GAqDI,4BArDJ,GAsDI,0BAtDJ,GAuDG,gBAvDH,GAwDE,SAxDF,GAyDC,UAzDD,GA0DC,qBA1DD,GA2DE,UA3DF,GA4DG,UA5DH,GA6DG,WA7DH,GA8DG,SA9DH,GA+DG,YA/DH,GAgEG,cAhEH,GAiEE,WAjEF,GAkEE,kDAlEF,GAmEG,qBAnEH,GAoEI,oBApEJ,GAqEG,SArEH,GAsEG,sBAtEH,GAuEI,oBAvEJ,GAwEG,UAxEH,GAyEG,oBAzEH,GA0EI,oBA1EJ,GA2EG,QA3EH,GA4EG,uBA5EH,GA6EI,oBA7EJ,GA8EG,WA9EH,GA+EG,cA/EH,GAgFE,WAhFF,GAiFC,YAjFD,GAkFC,0BAlFD,GAmFE,wDAnFF,GAoFC,iBApFD,GAqFC,sBArFD,GAsFE,mGAtFF,GAuFE,mGAvFF,GAwFE,mGAxFF,GAyFE,mGAzFF,GA0FE,mGA1FF,GA2FE,mGA3FF,GA4FE,mGA5FF,GA6FE,mGA7FF,GA8FE,mGA9FF,GA+FE,mGA/FF,GAgGE,mGAhGF,GAiGE,mGAjGF,GAkGE,mGAlGF,GAmGE,mGAnGF,GAoGE,mGApGF,GAqGE,mGArGF,GAsGE,mGAtGF,GAuGE,mGAvGF,GAwGE,mGAxGF,GAyGE,mGAzGF,GA0GE,mGA1GF,GA2GE,mGA3GF,GA4GE,mGA5GF,GA6GE,mGA7GF,GA8GE,mGA9GF,GA+GE,mGA/GF,GAgHE,mGAhHF,GAiHE,mGAjHF,GAkHE,mGAlHF,GAmHE,mGAnHF,GAoHE,mGApHF,GAqHE,mGArHF,GAsHE,mGAtHF,GAuHE,mGAvHF,GAwHE,mGAxHF,GAyHE,mGAzHF,GA0HE,mGA1HF,GA2HE,mGA3HF,GA4HE,mGA5HF,GA6HE,mGA7HF,GA8HE,mGA9HF,GA+HE,mGA/HF,GAgIE,mGAhIF,GAiIE,mGAjIF,GAkIE,mGAlIF,GAmIE,mGAnIF,GAoIE,mGApIF,GAqIE,mGArIF,GAsIE,mGAtIF,GAuIE,mGAvIF,GAwIE,8HAxIF,GAyIG,gCAzIH,GA0IE,OA1IF,GA2IE,8HA3IF,GA4IG,kCA5IH,GA6IE,OA7IF,GA8IE,8HA9IF,GA+IG,iCA/IH,GAgJE,OAhJF,GAiJE,8HAjJF,GAkJG,gCAlJH,GAmJE,OAnJF,GAoJE,8HApJF,GAqJG,gCArJH,GAsJE,OAtJF,GAuJE,8HAvJF,GAwJG,2BAxJH,GAyJE,OAzJF,GA0JC,YA1JD,GA2JC,wBA3JD,GA4JE,oDA5JF,GA6JC,eA7JD,GA8JC,oBA9JD,GA+JC,uGA/JD,GAgKA;AA7MiB,GAAnB,CAllB6D,CAiyB7D;AACA;;AAIA;;;AAIA;AACA;AACA;;AACAlL,EAAAA,SAAS,CAACiN,GAAV,CAAcvE,OAAd,CAAsBwE,SAAtB,GAAkC;AACjCC,IAAAA,SAAS,EAAE,4BADsB;AAGjCrF,IAAAA,IAAI,EAAE,cAAWS,EAAX,EAAgB;AACrB,aAAOA,EAAE,CAAC6E,IAAH,CAAS,cAAT,EAAyB,MAAzB,CAAP;AACA,KALgC;AAOjCC,IAAAA,MAAM,EAAE,gBAAWC,CAAX,EAAc/E,EAAd,EAAkBgF,MAAlB,EAA0BhG,MAA1B,EAAmC;AAC1C,UAAIoB,UAAU,GAAGL,WAAW,CAAEC,EAAF,EAAMhB,MAAN,CAA5B;;AACA,UAAIiG,MAAM,GAAG7E,UAAU,CAACiB,GAAxB;AACA,UAAI6D,SAAS,GAAGvO,CAAC,CAAC,QAAD,CAAD,CACdwO,GADc,CACT;AACLC,QAAAA,MAAM,EAAE,CADH;AAELC,QAAAA,KAAK,EAAE,CAFF;AAGLC,QAAAA,QAAQ,EAAE,QAHL;AAILC,QAAAA,QAAQ,EAAE,OAJL;AAKLC,QAAAA,GAAG,EAAE,CALA;AAMLC,QAAAA,IAAI,EAAE;AAND,OADS,CAAhB;;AAUA,UAAKzG,MAAM,CAAC0G,SAAZ,EAAwB;AACvBT,QAAAA,MAAM,GAAGjG,MAAM,CAAC0G,SAAP,CAAkBT,MAAlB,EAA0BjG,MAA1B,CAAT;AACA;;AAED,UAAI2G,QAAQ,GAAGhP,CAAC,CAAC,sBAAD,CAAD,CACbkM,GADa,CACRoC,MADQ,EAEbW,QAFa,CAEHV,SAFG,CAAf,CAjB0C,CAqB1C;;AACA,UAAKrO,QAAQ,CAACgP,qBAAT,CAA+B,MAA/B,CAAL,EAA8C;AAC7CX,QAAAA,SAAS,CAACU,QAAV,CAAoB5F,EAAE,CAAC8F,KAAH,GAAWC,SAAX,EAApB;AACAJ,QAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYK,KAAZ;AACAL,QAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYM,MAAZ;;AAEA,YAAI;AACH,cAAIC,UAAU,GAAGrP,QAAQ,CAACsP,WAAT,CAAsB,MAAtB,CAAjB;AACAjB,UAAAA,SAAS,CAAClL,MAAV;;AAEA,cAAIkM,UAAJ,EAAgB;AACflG,YAAAA,EAAE,CAACG,OAAH,CAAWiG,IAAX,CACCpG,EAAE,CAAC6E,IAAH,CAAS,mBAAT,EAA8B,mBAA9B,CADD,EAEC7E,EAAE,CAAC6E,IAAH,CAAS,qBAAT,EAAgC;AAC/B,iBAAG,6BAD4B;AAE/BwB,cAAAA,CAAC,EAAE;AAF4B,aAAhC,EAGGjG,UAAU,CAACkB,IAHd,CAFD,EAMC,IAND;AAQA;AACA;AACD,SAfD,CAgBA,OAAOe,CAAP,EAAU,CAAE;AACZ,OA5CyC,CA8C1C;;;AACA,UAAIiE,OAAO,GAAG3P,CAAC,CAAC,WAASqJ,EAAE,CAAC6E,IAAH,CAAS,kBAAT,EACvB,8GACA,gDAFuB,CAAT,GAEqC,SAFtC,CAAD,CAIZ0B,MAJY,CAIJrB,SAJI,CAAd;AAMAlF,MAAAA,EAAE,CAACG,OAAH,CAAWiG,IAAX,CAAiBpG,EAAE,CAAC6E,IAAH,CAAS,mBAAT,EAA8B,mBAA9B,CAAjB,EAAsEyB,OAAtE,EAA+E,CAA/E,EArD0C,CAuD1C;AACA;;AACAX,MAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYK,KAAZ;AACAL,MAAAA,QAAQ,CAAC,CAAD,CAAR,CAAYM,MAAZ,GA1D0C,CA4D1C;;AACA,UAAIF,SAAS,GAAGpP,CAAC,CAAC2P,OAAD,CAAD,CAAWE,OAAX,CAAmB,iBAAnB,CAAhB;;AACA,UAAIC,KAAK,GAAG,SAARA,KAAQ,GAAY;AACvBV,QAAAA,SAAS,CAACW,GAAV,CAAe,oBAAf;AACA/P,QAAAA,CAAC,CAACE,QAAD,CAAD,CAAY6P,GAAZ,CAAiB,eAAjB;AACA1G,QAAAA,EAAE,CAACG,OAAH,CAAWiG,IAAX,CAAiB,KAAjB;AACA,OAJD;;AAMAL,MAAAA,SAAS,CAACY,EAAV,CAAc,oBAAd,EAAoCF,KAApC;AACA9P,MAAAA,CAAC,CAACE,QAAD,CAAD,CACE8P,EADF,CACM,sBADN,EAC8B,UAAU5B,CAAV,EAAa;AACzC,YAAKA,CAAC,CAAC6B,OAAF,KAAc,EAAnB,EAAwB;AAAE;AACzBH,UAAAA,KAAK;AACL;AACD,OALF,EAMEE,EANF,CAMM,oCANN,EAM4C,YAAY;AACtDF,QAAAA,KAAK;AACL,OARF;AASA,KArFgC;AAuFjCpG,IAAAA,aAAa,EAAE,EAvFkB;AAyFjCI,IAAAA,cAAc,EAAE,IAzFiB;AA2FjCF,IAAAA,aAAa,EAAE,EA3FkB;AA6FjCU,IAAAA,MAAM,EAAE,IA7FyB;AA+FjCC,IAAAA,MAAM,EAAE;AA/FyB,GAAlC,CA7yB6D,CA+4B7D;AACA;AACA;;AACAzJ,EAAAA,SAAS,CAACiN,GAAV,CAAcvE,OAAd,CAAsB0G,QAAtB,GAAiC;AAChCC,IAAAA,GAAG,EAAE,KAD2B;AAGhClC,IAAAA,SAAS,EAAE,2BAHqB;AAKhCmC,IAAAA,SAAS,EAAE,qBAAY;AACtB,aAAOnQ,MAAM,CAAC0E,UAAP,KAAsB9D,SAAtB,IAAmCZ,MAAM,CAACgE,IAAjD;AACA,KAP+B;AAShC2E,IAAAA,IAAI,EAAE,cAAWS,EAAX,EAAgB;AACrB,aAAOA,EAAE,CAAC6E,IAAH,CAAS,aAAT,EAAwB,KAAxB,CAAP;AACA,KAX+B;AAahCC,IAAAA,MAAM,EAAE,gBAAWC,CAAX,EAAc/E,EAAd,EAAkBgF,MAAlB,EAA0BhG,MAA1B,EAAmC;AAC1C;AACA,UAAIiG,MAAM,GAAGlF,WAAW,CAAEC,EAAF,EAAMhB,MAAN,CAAX,CAA0BqC,GAAvC;;AACA,UAAI2F,OAAO,GAAGhI,MAAM,CAACgI,OAArB;;AAEA,UAAKhI,MAAM,CAAC0G,SAAZ,EAAwB;AACvBT,QAAAA,MAAM,GAAGjG,MAAM,CAAC0G,SAAP,CAAkBT,MAAlB,EAA0BjG,MAA1B,CAAT;AACA;;AAED,UAAKgI,OAAO,KAAK,KAAjB,EAAyB;AACxB,YAAK,CAAEA,OAAP,EAAiB;AAChBA,UAAAA,OAAO,GAAGnQ,QAAQ,CAACoQ,YAAT,IAAyBpQ,QAAQ,CAACmQ,OAA5C;AACA;;AAED,YAAKA,OAAL,EAAe;AACdA,UAAAA,OAAO,GAAG,cAAYA,OAAtB;AACA;AACD,OARD,MASK;AACJA,QAAAA,OAAO,GAAG,EAAV;AACA;;AAED,UAAKhI,MAAM,CAAC8H,GAAZ,EAAkB;AACjB7B,QAAAA,MAAM,GAAG,WAAWA,MAApB;AACA;;AAEDnN,MAAAA,OAAO,CACN,IAAI8C,IAAJ,CAAU,CAACqK,MAAD,CAAV,EAAoB;AAACtK,QAAAA,IAAI,EAAE,aAAWqM;AAAlB,OAApB,CADM,EAENjI,SAAS,CAAEC,MAAF,CAFH,EAGN,IAHM,CAAP;AAKA,KA5C+B;AA8ChCE,IAAAA,QAAQ,EAAE,GA9CsB;AAgDhCM,IAAAA,SAAS,EAAE,MAhDqB;AAkDhCa,IAAAA,aAAa,EAAE,EAlDiB;AAoDhCI,IAAAA,cAAc,EAAE,GApDgB;AAsDhCF,IAAAA,aAAa,EAAE,GAtDiB;AAwDhCK,IAAAA,UAAU,EAAE,GAxDoB;AA0DhCoG,IAAAA,OAAO,EAAE,IA1DuB;AA4DhC/F,IAAAA,MAAM,EAAE,IA5DwB;AA8DhCC,IAAAA,MAAM,EAAE;AA9DwB,GAAjC,CAl5B6D,CAm9B7D;AACA;AACA;;AACAzJ,EAAAA,SAAS,CAACiN,GAAV,CAAcvE,OAAd,CAAsB+G,UAAtB,GAAmC;AAClCtC,IAAAA,SAAS,EAAE,6BADuB;AAGlCmC,IAAAA,SAAS,EAAE,qBAAY;AACtB,aAAOnQ,MAAM,CAAC0E,UAAP,KAAsB9D,SAAtB,IAAmCE,MAAM,OAAOF,SAAhD,IAA6D,CAAE+J,SAAS,EAAxE,IAA8EW,WAArF;AACA,KALiC;AAOlC3C,IAAAA,IAAI,EAAE,cAAWS,EAAX,EAAgB;AACrB,aAAOA,EAAE,CAAC6E,IAAH,CAAS,eAAT,EAA0B,OAA1B,CAAP;AACA,KATiC;AAWlCC,IAAAA,MAAM,EAAE,gBAAWC,CAAX,EAAc/E,EAAd,EAAkBgF,MAAlB,EAA0BhG,MAA1B,EAAmC;AAC1C,UAAImI,MAAM,GAAG,CAAb;;AACA,UAAIC,MAAM,GAAG,SAATA,MAAS,CAAWzM,IAAX,EAAkB;AAC9B,YAAI0G,GAAG,GAAGsB,YAAY,CAAEhI,IAAF,CAAtB,CAD8B,CAG9B;;AAEA,eAAOhE,CAAC,CAAC+L,QAAF,CAAYrB,GAAZ,CAAP;AACA,OAND;;AAOA,UAAIgG,IAAI,GAAGD,MAAM,CAAC,0BAAD,CAAjB;AACA,UAAIE,OAAO,GAAGD,IAAI,CAACE,oBAAL,CAA2B,WAA3B,EAAyC,CAAzC,CAAd;AAEA,UAAIC,IAAI,GAAG;AACVC,QAAAA,KAAK,EAAE;AACN,mBAASL,MAAM,CAAC,aAAD;AADT,SADG;AAIVM,QAAAA,EAAE,EAAE;AACHD,UAAAA,KAAK,EAAE;AACN,iCAAqBL,MAAM,CAAC,4BAAD;AADrB,WADJ;AAIH,0BAAgBA,MAAM,CAAC,iBAAD,CAJnB;AAKH,wBAAcA,MAAM,CAAC,eAAD,CALjB;AAMH,wBAAc;AACb,0BAAcC;AADD;AANX,SAJM;AAeV,+BAAuBD,MAAM,CAAC,qBAAD;AAfnB,OAAX;AAkBA,UAAIlH,IAAI,GAAGF,EAAE,CAACG,OAAH,CAAWC,UAAX,CAAuBpB,MAAM,CAACqB,aAA9B,CAAX;AACA,UAAIsH,UAAJ,EAAgBC,OAAhB;;AACA,UAAIC,MAAM,GAAG,SAATA,MAAS,CAAWC,GAAX,EAAiB;AAC7BH,QAAAA,UAAU,GAAGR,MAAM,GAAC,CAApB;AACAS,QAAAA,OAAO,GAAG9D,WAAW,CAAEuD,IAAF,EAAQ,KAAR,EAAe;AAAE1D,UAAAA,IAAI,EAAE;AAACoE,YAAAA,CAAC,EAACJ;AAAH;AAAR,SAAf,CAArB;;AAEA,aAAM,IAAItN,CAAC,GAAC,CAAN,EAAS2G,GAAG,GAAC8G,GAAG,CAACxN,MAAvB,EAAgCD,CAAC,GAAC2G,GAAlC,EAAwC3G,CAAC,EAAzC,EAA8C;AAC7C;AACA,cAAI2N,MAAM,GAAGxG,aAAa,CAACnH,CAAD,CAAb,GAAmB,EAAnB,GAAwBsN,UAArC;AACA,cAAIM,IAAJ;;AAEA,cAAKH,GAAG,CAACzN,CAAD,CAAH,KAAW,IAAX,IAAmByN,GAAG,CAACzN,CAAD,CAAH,KAAW7C,SAAnC,EAA+C;AAC9CsQ,YAAAA,GAAG,CAACzN,CAAD,CAAH,GAAS,EAAT;AACA,WAP4C,CAS7C;AACA;;;AACA,cAAK,OAAOyN,GAAG,CAACzN,CAAD,CAAV,KAAkB,QAAlB,IACHyN,GAAG,CAACzN,CAAD,CAAH,CAAOyF,KAAP,IACAnJ,CAAC,CAAC0I,IAAF,CAAOyI,GAAG,CAACzN,CAAD,CAAV,EAAeyF,KAAf,CAAqB,iBAArB,CADA,IAEA,CAAEnJ,CAAC,CAAC0I,IAAF,CAAOyI,GAAG,CAACzN,CAAD,CAAV,EAAeyF,KAAf,CAAqB,OAArB,CAHJ,EAIE;AACDmI,YAAAA,IAAI,GAAGnE,WAAW,CAAEuD,IAAF,EAAQ,GAAR,EAAa;AAC9B1D,cAAAA,IAAI,EAAE;AACLtB,gBAAAA,CAAC,EAAE,GADE;AAEL0F,gBAAAA,CAAC,EAAEC;AAFE,eADwB;AAK9B9D,cAAAA,QAAQ,EAAE,CACTJ,WAAW,CAAEuD,IAAF,EAAQ,GAAR,EAAa;AAAE9H,gBAAAA,IAAI,EAAEuI,GAAG,CAACzN,CAAD;AAAX,eAAb,CADF;AALoB,aAAb,CAAlB;AASA,WAdD,MAeK;AACJ;AACA,gBAAIkF,IAAI,GAAG,CAAEuI,GAAG,CAACzN,CAAD,CAAH,CAAOiF,OAAT,GACVwI,GAAG,CAACzN,CAAD,CADO,GAEVyN,GAAG,CAACzN,CAAD,CAAH,CAAOiF,OAAP,CAAe,wCAAf,EAAyD,EAAzD,CAFD;AAIA2I,YAAAA,IAAI,GAAGnE,WAAW,CAAEuD,IAAF,EAAQ,GAAR,EAAa;AAC9B1D,cAAAA,IAAI,EAAE;AACLtB,gBAAAA,CAAC,EAAE,WADE;AAEL0F,gBAAAA,CAAC,EAAEC;AAFE,eADwB;AAK9B9D,cAAAA,QAAQ,EAAC;AACR4D,gBAAAA,GAAG,EAAEhE,WAAW,CAAEuD,IAAF,EAAQ,IAAR,EAAc;AAC7BnD,kBAAAA,QAAQ,EAAE;AACT4D,oBAAAA,GAAG,EAAEhE,WAAW,CAAEuD,IAAF,EAAQ,GAAR,EAAa;AAC5B9H,sBAAAA,IAAI,EAAEA;AADsB,qBAAb;AADP;AADmB,iBAAd;AADR;AALqB,aAAb,CAAlB;AAeA;;AAEDqI,UAAAA,OAAO,CAACxD,WAAR,CAAqB6D,IAArB;AACA;;AACDX,QAAAA,OAAO,CAAClD,WAAR,CAAoBwD,OAApB;AACAT,QAAAA,MAAM;AACN,OAzDD;;AA2DAxQ,MAAAA,CAAC,CAAE,cAAF,EAAkB6Q,IAAI,CAACE,EAAL,CAAQ,cAAR,CAAlB,CAAD,CAA6C/D,IAA7C,CAAmD,MAAnD,EAA2DlE,UAAU,CAAET,MAAF,CAArE;;AAEA,UAAKA,MAAM,CAACkJ,aAAZ,EAA4B;AAC3BlJ,QAAAA,MAAM,CAACkJ,aAAP,CAAsBhI,IAAtB;AACA;;AAED,UAAKlB,MAAM,CAACiC,MAAZ,EAAqB;AACpB4G,QAAAA,MAAM,CAAE3H,IAAI,CAACe,MAAP,EAAekG,MAAf,CAAN;AACAxQ,QAAAA,CAAC,CAAC,OAAD,EAAU0Q,IAAV,CAAD,CAAiB1D,IAAjB,CAAuB,GAAvB,EAA4B,GAA5B,EAFoB,CAEe;AACnC;;AAED,WAAM,IAAIlC,CAAC,GAAC,CAAN,EAAS0G,EAAE,GAACjI,IAAI,CAACiB,IAAL,CAAU7G,MAA5B,EAAqCmH,CAAC,GAAC0G,EAAvC,EAA4C1G,CAAC,EAA7C,EAAkD;AACjDoG,QAAAA,MAAM,CAAE3H,IAAI,CAACiB,IAAL,CAAUM,CAAV,CAAF,EAAgB0F,MAAhB,CAAN;AACA;;AAED,UAAKnI,MAAM,CAACkC,MAAP,IAAiBhB,IAAI,CAACgB,MAA3B,EAAoC;AACnC2G,QAAAA,MAAM,CAAE3H,IAAI,CAACgB,MAAP,EAAeiG,MAAf,CAAN;AACAxQ,QAAAA,CAAC,CAAC,YAAD,EAAe0Q,IAAf,CAAD,CAAsB1D,IAAtB,CAA4B,GAA5B,EAAiC,GAAjC,EAFmC,CAEK;AACxC,OA7GyC,CA+G1C;;;AACA,UAAIyE,IAAI,GAAGtE,WAAW,CAAEuD,IAAF,EAAQ,MAAR,CAAtB;;AACA1Q,MAAAA,CAAC,CAAC,WAAD,EAAc0Q,IAAd,CAAD,CAAqBgB,OAArB,CAA8BD,IAA9B;;AAEA,WAAM,IAAI/N,CAAC,GAAC,CAAN,EAAS2G,GAAG,GAACd,IAAI,CAACe,MAAL,CAAY3G,MAA/B,EAAwCD,CAAC,GAAC2G,GAA1C,EAAgD3G,CAAC,EAAjD,EAAsD;AACrD+N,QAAAA,IAAI,CAAChE,WAAL,CAAkBN,WAAW,CAAEuD,IAAF,EAAQ,KAAR,EAAe;AAC3C1D,UAAAA,IAAI,EAAE;AACL2E,YAAAA,GAAG,EAAEjO,CAAC,GAAC,CADF;AAELmK,YAAAA,GAAG,EAAEnK,CAAC,GAAC,CAFF;AAGLgL,YAAAA,KAAK,EAAEf,cAAc,CAAEpE,IAAF,EAAQ7F,CAAR,CAHhB;AAILkO,YAAAA,WAAW,EAAE;AAJR;AADqC,SAAf,CAA7B;AAQA,OA5HyC,CA8H1C;;;AACA,UAAKvJ,MAAM,CAAC0G,SAAZ,EAAwB;AACvB1G,QAAAA,MAAM,CAAC0G,SAAP,CAAkB8B,IAAlB;AACA;;AAED,UAAIvQ,KAAK,GAAGS,MAAM,EAAlB;;AACA,UAAI6K,GAAG,GAAG,IAAItL,KAAJ,EAAV;AACA,UAAIuR,SAAS,GAAG;AACf7N,QAAAA,IAAI,EAAE,MADS;AAEf8N,QAAAA,QAAQ,EAAE;AAFK,OAAhB;;AAKAnG,MAAAA,SAAS,CAAEC,GAAF,EAAOiF,IAAP,CAAT;;AAEA,UAAKjF,GAAG,CAACmG,aAAT,EAAyB;AACxB;AACAnG,QAAAA,GAAG,CACDmG,aADF,CACiBF,SADjB,EAEEG,IAFF,CAEQ,UAAWjO,IAAX,EAAkB;AACxB5C,UAAAA,OAAO,CAAE4C,IAAF,EAAQqE,SAAS,CAAEC,MAAF,CAAjB,CAAP;AACA,SAJF;AAKA,OAPD,MAQK;AACJ;AACAlH,QAAAA,OAAO,CACNyK,GAAG,CAACqG,QAAJ,CAAcJ,SAAd,CADM,EAENzJ,SAAS,CAAEC,MAAF,CAFH,CAAP;AAIA;AACD,KAtKiC;AAwKlCE,IAAAA,QAAQ,EAAE,GAxKwB;AA0KlCM,IAAAA,SAAS,EAAE,OA1KuB;AA4KlCa,IAAAA,aAAa,EAAE,EA5KmB;AA8KlCY,IAAAA,MAAM,EAAE,IA9K0B;AAgLlCC,IAAAA,MAAM,EAAE;AAhL0B,GAAnC,CAt9B6D,CAyoC7D;AACA;AACA;;AACAzJ,EAAAA,SAAS,CAACiN,GAAV,CAAcvE,OAAd,CAAsB0I,QAAtB,GAAiC;AAChCjE,IAAAA,SAAS,EAAE,2BADqB;AAGhCmC,IAAAA,SAAS,EAAE,qBAAY;AACtB,aAAOnQ,MAAM,CAAC0E,UAAP,KAAsB9D,SAAtB,IAAmCI,QAAQ,EAAlD;AACA,KAL+B;AAOhC2H,IAAAA,IAAI,EAAE,cAAWS,EAAX,EAAgB;AACrB,aAAOA,EAAE,CAAC6E,IAAH,CAAS,aAAT,EAAwB,KAAxB,CAAP;AACA,KAT+B;AAWhCC,IAAAA,MAAM,EAAE,gBAAWC,CAAX,EAAc/E,EAAd,EAAkBgF,MAAlB,EAA0BhG,MAA1B,EAAmC;AAC1C,UAAIiB,OAAO,GAAGL,QAAQ,CAAEZ,MAAF,CAAtB;;AACA,UAAIkB,IAAI,GAAGF,EAAE,CAACG,OAAH,CAAWC,UAAX,CAAuBpB,MAAM,CAACqB,aAA9B,CAAX;AACA,UAAIiB,IAAI,GAAG,EAAX;;AAEA,UAAKtC,MAAM,CAACiC,MAAZ,EAAqB;AACpBK,QAAAA,IAAI,CAACF,IAAL,CAAWzK,CAAC,CAACmS,GAAF,CAAO5I,IAAI,CAACe,MAAZ,EAAoB,UAAW8H,CAAX,EAAe;AAC7C,iBAAO;AACNxJ,YAAAA,IAAI,EAAE,OAAOwJ,CAAP,KAAa,QAAb,GAAwBA,CAAxB,GAA4BA,CAAC,GAAC,EAD9B;AAENC,YAAAA,KAAK,EAAE;AAFD,WAAP;AAIA,SALU,CAAX;AAMA;;AAED,WAAM,IAAI3O,CAAC,GAAC,CAAN,EAAS2G,GAAG,GAACd,IAAI,CAACiB,IAAL,CAAU7G,MAA7B,EAAsCD,CAAC,GAAC2G,GAAxC,EAA8C3G,CAAC,EAA/C,EAAoD;AACnDiH,QAAAA,IAAI,CAACF,IAAL,CAAWzK,CAAC,CAACmS,GAAF,CAAO5I,IAAI,CAACiB,IAAL,CAAU9G,CAAV,CAAP,EAAqB,UAAW0O,CAAX,EAAe;AAC9C,iBAAO;AACNxJ,YAAAA,IAAI,EAAE,OAAOwJ,CAAP,KAAa,QAAb,GAAwBA,CAAxB,GAA4BA,CAAC,GAAC,EAD9B;AAENC,YAAAA,KAAK,EAAE3O,CAAC,GAAG,CAAJ,GAAQ,eAAR,GAA0B;AAF3B,WAAP;AAIA,SALU,CAAX;AAMA;;AAED,UAAK2E,MAAM,CAACkC,MAAP,IAAiBhB,IAAI,CAACgB,MAA3B,EAAmC;AAClCI,QAAAA,IAAI,CAACF,IAAL,CAAWzK,CAAC,CAACmS,GAAF,CAAO5I,IAAI,CAACgB,MAAZ,EAAoB,UAAW6H,CAAX,EAAe;AAC7C,iBAAO;AACNxJ,YAAAA,IAAI,EAAE,OAAOwJ,CAAP,KAAa,QAAb,GAAwBA,CAAxB,GAA4BA,CAAC,GAAC,EAD9B;AAENC,YAAAA,KAAK,EAAE;AAFD,WAAP;AAIA,SALU,CAAX;AAMA;;AAED,UAAI7Q,GAAG,GAAG;AACT8Q,QAAAA,QAAQ,EAAEjK,MAAM,CAACiK,QADR;AAETC,QAAAA,eAAe,EAAElK,MAAM,CAACmK,WAFf;AAGTtK,QAAAA,OAAO,EAAE,CACR;AACCiH,UAAAA,KAAK,EAAE;AACNsD,YAAAA,UAAU,EAAE,CADN;AAENjI,YAAAA,IAAI,EAAEG;AAFA,WADR;AAKC+H,UAAAA,MAAM,EAAE;AALT,SADQ,CAHA;AAYTC,QAAAA,MAAM,EAAE;AACPC,UAAAA,WAAW,EAAE;AACZC,YAAAA,IAAI,EAAE,IADM;AAEZC,YAAAA,QAAQ,EAAE,EAFE;AAGZC,YAAAA,KAAK,EAAE,OAHK;AAIZC,YAAAA,SAAS,EAAE,SAJC;AAKZC,YAAAA,SAAS,EAAE;AALC,WADN;AAQPC,UAAAA,aAAa,EAAE,EARR;AASPC,UAAAA,YAAY,EAAE;AACbH,YAAAA,SAAS,EAAE;AADE,WATP;AAYPI,UAAAA,WAAW,EAAE;AACZP,YAAAA,IAAI,EAAE,IADM;AAEZC,YAAAA,QAAQ,EAAE,EAFE;AAGZC,YAAAA,KAAK,EAAE,OAHK;AAIZC,YAAAA,SAAS,EAAE;AAJC,WAZN;AAkBPxK,UAAAA,KAAK,EAAE;AACNyK,YAAAA,SAAS,EAAE,QADL;AAENH,YAAAA,QAAQ,EAAE;AAFJ,WAlBA;AAsBPnD,UAAAA,OAAO,EAAE;AAtBF,SAZC;AAoCT0D,QAAAA,YAAY,EAAE;AACbP,UAAAA,QAAQ,EAAE;AADG;AApCL,OAAV;;AAyCA,UAAKzK,MAAM,CAACsH,OAAZ,EAAsB;AAClBnO,QAAAA,GAAG,CAAC0G,OAAJ,CAAYoL,OAAZ,CAAqB;AACnB1K,UAAAA,IAAI,EAAE,OAAOP,MAAM,CAACsH,OAAd,IAAyB,UAAzB,GAAsCtH,MAAM,CAACsH,OAAP,CAAetG,EAAf,EAAmBgF,MAAnB,EAA2BhG,MAA3B,CAAtC,GAA2EA,MAAM,CAACsH,OADrE;AAEnB0C,UAAAA,KAAK,EAAE,SAFY;AAGnBkB,UAAAA,MAAM,EAAE,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,EAAX;AAHW,SAArB;AAKH;;AAED,UAAKlL,MAAM,CAACG,KAAZ,EAAoB;AACnBhH,QAAAA,GAAG,CAAC0G,OAAJ,CAAYoL,OAAZ,CAAqB;AACpB1K,UAAAA,IAAI,EAAEI,MAAM,CAAEX,MAAF,EAAU,KAAV,CADQ;AAEpBgK,UAAAA,KAAK,EAAE,OAFa;AAGpBkB,UAAAA,MAAM,EAAE,CAAE,CAAF,EAAK,CAAL,EAAQ,CAAR,EAAW,EAAX;AAHY,SAArB;AAKA;;AAED,UAAKlL,MAAM,CAAC0G,SAAZ,EAAwB;AACvB1G,QAAAA,MAAM,CAAC0G,SAAP,CAAkBvN,GAAlB,EAAuB6G,MAAvB;AACA;;AAED,UAAImL,GAAG,GAAGvS,QAAQ,GAAGwS,SAAX,CAAsBjS,GAAtB,CAAV;;AAEA,UAAK6G,MAAM,CAACnC,QAAP,KAAoB,MAApB,IAA8B,CAAE0E,SAAS,EAA9C,EAAmD;AAClD4I,QAAAA,GAAG,CAAC9N,IAAJ;AACA,OAFD,MAGK;AACJ8N,QAAAA,GAAG,CAACE,SAAJ,CAAe,UAAUC,MAAV,EAAkB;AAChC,cAAI5P,IAAI,GAAG,IAAIE,IAAJ,CAAU,CAAC0P,MAAD,CAAV,EAAoB;AAAC3P,YAAAA,IAAI,EAAC;AAAN,WAApB,CAAX;;AAEA7C,UAAAA,OAAO,CAAE4C,IAAF,EAAQqE,SAAS,CAAEC,MAAF,CAAjB,CAAP;AACA,SAJD;AAKA;AACD,KApH+B;AAsHhCG,IAAAA,KAAK,EAAE,GAtHyB;AAwHhCD,IAAAA,QAAQ,EAAE,GAxHsB;AA0HhCM,IAAAA,SAAS,EAAE,MA1HqB;AA4HhCa,IAAAA,aAAa,EAAE,EA5HiB;AA8HhC8I,IAAAA,WAAW,EAAE,UA9HmB;AAgIhCF,IAAAA,QAAQ,EAAE,IAhIsB;AAkIhChI,IAAAA,MAAM,EAAE,IAlIwB;AAoIhCC,IAAAA,MAAM,EAAE,KApIwB;AAsIhCoF,IAAAA,OAAO,EAAE,IAtIuB;AAwIhCZ,IAAAA,SAAS,EAAE,IAxIqB;AA0IhC7I,IAAAA,QAAQ,EAAE;AA1IsB,GAAjC;AA8IA,SAAOpF,SAAS,CAACH,OAAjB;AACC,CAxzCA,CAAD","sourcesContent":["/*!\n * HTML5 export buttons for Buttons and DataTables.\n * 2016 SpryMedia Ltd - datatables.net/license\n *\n * FileSaver.js (1.1.20160328) - MIT license\n * Copyright Â© 2016 Eli Grey - http://eligrey.com\n */\n\n(function( factory ){\n\tif ( typeof define === 'function' && define.amd ) {\n\t\t// AMD\n\t\tdefine( ['jquery', 'datatables.net', 'datatables.net-buttons'], function ( $ ) {\n\t\t\treturn factory( $, window, document );\n\t\t} );\n\t}\n\telse if ( typeof exports === 'object' ) {\n\t\t// CommonJS\n\t\tmodule.exports = function (root, $, jszip, pdfmake) {\n\t\t\tif ( ! root ) {\n\t\t\t\troot = window;\n\t\t\t}\n\n\t\t\tif ( ! $ || ! $.fn.dataTable ) {\n\t\t\t\t$ = require('datatables.net')(root, $).$;\n\t\t\t}\n\n\t\t\tif ( ! $.fn.dataTable.Buttons ) {\n\t\t\t\trequire('datatables.net-buttons')(root, $);\n\t\t\t}\n\n\t\t\treturn factory( $, root, root.document, jszip, pdfmake );\n\t\t};\n\t}\n\telse {\n\t\t// Browser\n\t\tfactory( jQuery, window, document );\n\t}\n}(function( $, window, document, jszip, pdfmake, undefined ) {\n'use strict';\nvar DataTable = $.fn.dataTable;\n\n// Allow the constructor to pass in JSZip and PDFMake from external requires.\n// Otherwise, use globally defined variables, if they are available.\nfunction _jsZip () {\n\treturn jszip || window.JSZip;\n}\nfunction _pdfMake () {\n\treturn pdfmake || window.pdfMake;\n}\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * FileSaver.js dependency\n */\n\n/*jslint bitwise: true, indent: 4, laxbreak: true, laxcomma: true, smarttabs: true, plusplus: true */\n\nvar _saveAs = (function(view) {\n\t\"use strict\";\n\t// IE <10 is explicitly unsupported\n\tif (typeof navigator !== \"undefined\" && /MSIE [1-9]\\./.test(navigator.userAgent)) {\n\t\treturn;\n\t}\n\tvar\n\t\t  doc = view.document\n\t\t  // only get URL when necessary in case Blob.js hasn't overridden it yet\n\t\t, get_URL = function() {\n\t\t\treturn view.URL || view.webkitURL || view;\n\t\t}\n\t\t, save_link = doc.createElementNS(\"http://www.w3.org/1999/xhtml\", \"a\")\n\t\t, can_use_save_link = \"download\" in save_link\n\t\t, click = function(node) {\n\t\t\tvar event = new MouseEvent(\"click\");\n\t\t\tnode.dispatchEvent(event);\n\t\t}\n\t\t, is_safari = /Version\\/[\\d\\.]+.*Safari/.test(navigator.userAgent)\n\t\t, webkit_req_fs = view.webkitRequestFileSystem\n\t\t, req_fs = view.requestFileSystem || webkit_req_fs || view.mozRequestFileSystem\n\t\t, throw_outside = function(ex) {\n\t\t\t(view.setImmediate || view.setTimeout)(function() {\n\t\t\t\tthrow ex;\n\t\t\t}, 0);\n\t\t}\n\t\t, force_saveable_type = \"application/octet-stream\"\n\t\t, fs_min_size = 0\n\t\t// the Blob API is fundamentally broken as there is no \"downloadfinished\" event to subscribe to\n\t\t, arbitrary_revoke_timeout = 1000 * 40 // in ms\n\t\t, revoke = function(file) {\n\t\t\tvar revoker = function() {\n\t\t\t\tif (typeof file === \"string\") { // file is an object URL\n\t\t\t\t\tget_URL().revokeObjectURL(file);\n\t\t\t\t} else { // file is a File\n\t\t\t\t\tfile.remove();\n\t\t\t\t}\n\t\t\t};\n\t\t\t/* // Take note W3C:\n\t\t\tvar\n\t\t\t  uri = typeof file === \"string\" ? file : file.toURL()\n\t\t\t, revoker = function(evt) {\n\t\t\t\t// idealy DownloadFinishedEvent.data would be the URL requested\n\t\t\t\tif (evt.data === uri) {\n\t\t\t\t\tif (typeof file === \"string\") { // file is an object URL\n\t\t\t\t\t\tget_URL().revokeObjectURL(file);\n\t\t\t\t\t} else { // file is a File\n\t\t\t\t\t\tfile.remove();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t;\n\t\t\tview.addEventListener(\"downloadfinished\", revoker);\n\t\t\t*/\n\t\t\tsetTimeout(revoker, arbitrary_revoke_timeout);\n\t\t}\n\t\t, dispatch = function(filesaver, event_types, event) {\n\t\t\tevent_types = [].concat(event_types);\n\t\t\tvar i = event_types.length;\n\t\t\twhile (i--) {\n\t\t\t\tvar listener = filesaver[\"on\" + event_types[i]];\n\t\t\t\tif (typeof listener === \"function\") {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tlistener.call(filesaver, event || filesaver);\n\t\t\t\t\t} catch (ex) {\n\t\t\t\t\t\tthrow_outside(ex);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t, auto_bom = function(blob) {\n\t\t\t// prepend BOM for UTF-8 XML and text/* types (including HTML)\n\t\t\tif (/^\\s*(?:text\\/\\S*|application\\/xml|\\S*\\/\\S*\\+xml)\\s*;.*charset\\s*=\\s*utf-8/i.test(blob.type)) {\n\t\t\t\treturn new Blob([\"\\ufeff\", blob], {type: blob.type});\n\t\t\t}\n\t\t\treturn blob;\n\t\t}\n\t\t, FileSaver = function(blob, name, no_auto_bom) {\n\t\t\tif (!no_auto_bom) {\n\t\t\t\tblob = auto_bom(blob);\n\t\t\t}\n\t\t\t// First try a.download, then web filesystem, then object URLs\n\t\t\tvar\n\t\t\t\t  filesaver = this\n\t\t\t\t, type = blob.type\n\t\t\t\t, blob_changed = false\n\t\t\t\t, object_url\n\t\t\t\t, target_view\n\t\t\t\t, dispatch_all = function() {\n\t\t\t\t\tdispatch(filesaver, \"writestart progress write writeend\".split(\" \"));\n\t\t\t\t}\n\t\t\t\t// on any filesys errors revert to saving with object URLs\n\t\t\t\t, fs_error = function() {\n\t\t\t\t\tif (target_view && is_safari && typeof FileReader !== \"undefined\") {\n\t\t\t\t\t\t// Safari doesn't allow downloading of blob urls\n\t\t\t\t\t\tvar reader = new FileReader();\n\t\t\t\t\t\treader.onloadend = function() {\n\t\t\t\t\t\t\tvar base64Data = reader.result;\n\t\t\t\t\t\t\ttarget_view.location.href = \"data:attachment/file\" + base64Data.slice(base64Data.search(/[,;]/));\n\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\t\t\tdispatch_all();\n\t\t\t\t\t\t};\n\t\t\t\t\t\treader.readAsDataURL(blob);\n\t\t\t\t\t\tfilesaver.readyState = filesaver.INIT;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// don't create more object URLs than needed\n\t\t\t\t\tif (blob_changed || !object_url) {\n\t\t\t\t\t\tobject_url = get_URL().createObjectURL(blob);\n\t\t\t\t\t}\n\t\t\t\t\tif (target_view) {\n\t\t\t\t\t\ttarget_view.location.href = object_url;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar new_tab = view.open(object_url, \"_blank\");\n\t\t\t\t\t\tif (new_tab === undefined && is_safari) {\n\t\t\t\t\t\t\t//Apple do not allow window.open, see http://bit.ly/1kZffRI\n\t\t\t\t\t\t\tview.location.href = object_url\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\tdispatch_all();\n\t\t\t\t\trevoke(object_url);\n\t\t\t\t}\n\t\t\t\t, abortable = function(func) {\n\t\t\t\t\treturn function() {\n\t\t\t\t\t\tif (filesaver.readyState !== filesaver.DONE) {\n\t\t\t\t\t\t\treturn func.apply(this, arguments);\n\t\t\t\t\t\t}\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t\t, create_if_not_found = {create: true, exclusive: false}\n\t\t\t\t, slice\n\t\t\t;\n\t\t\tfilesaver.readyState = filesaver.INIT;\n\t\t\tif (!name) {\n\t\t\t\tname = \"download\";\n\t\t\t}\n\t\t\tif (can_use_save_link) {\n\t\t\t\tobject_url = get_URL().createObjectURL(blob);\n\t\t\t\tsetTimeout(function() {\n\t\t\t\t\tsave_link.href = object_url;\n\t\t\t\t\tsave_link.download = name;\n\t\t\t\t\tclick(save_link);\n\t\t\t\t\tdispatch_all();\n\t\t\t\t\trevoke(object_url);\n\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t});\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// Object and web filesystem URLs have a problem saving in Google Chrome when\n\t\t\t// viewed in a tab, so I force save with application/octet-stream\n\t\t\t// http://code.google.com/p/chromium/issues/detail?id=91158\n\t\t\t// Update: Google errantly closed 91158, I submitted it again:\n\t\t\t// https://code.google.com/p/chromium/issues/detail?id=389642\n\t\t\tif (view.chrome && type && type !== force_saveable_type) {\n\t\t\t\tslice = blob.slice || blob.webkitSlice;\n\t\t\t\tblob = slice.call(blob, 0, blob.size, force_saveable_type);\n\t\t\t\tblob_changed = true;\n\t\t\t}\n\t\t\t// Since I can't be sure that the guessed media type will trigger a download\n\t\t\t// in WebKit, I append .download to the filename.\n\t\t\t// https://bugs.webkit.org/show_bug.cgi?id=65440\n\t\t\tif (webkit_req_fs && name !== \"download\") {\n\t\t\t\tname += \".download\";\n\t\t\t}\n\t\t\tif (type === force_saveable_type || webkit_req_fs) {\n\t\t\t\ttarget_view = view;\n\t\t\t}\n\t\t\tif (!req_fs) {\n\t\t\t\tfs_error();\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tfs_min_size += blob.size;\n\t\t\treq_fs(view.TEMPORARY, fs_min_size, abortable(function(fs) {\n\t\t\t\tfs.root.getDirectory(\"saved\", create_if_not_found, abortable(function(dir) {\n\t\t\t\t\tvar save = function() {\n\t\t\t\t\t\tdir.getFile(name, create_if_not_found, abortable(function(file) {\n\t\t\t\t\t\t\tfile.createWriter(abortable(function(writer) {\n\t\t\t\t\t\t\t\twriter.onwriteend = function(event) {\n\t\t\t\t\t\t\t\t\ttarget_view.location.href = file.toURL();\n\t\t\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\t\t\t\t\tdispatch(filesaver, \"writeend\", event);\n\t\t\t\t\t\t\t\t\trevoke(file);\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\twriter.onerror = function() {\n\t\t\t\t\t\t\t\t\tvar error = writer.error;\n\t\t\t\t\t\t\t\t\tif (error.code !== error.ABORT_ERR) {\n\t\t\t\t\t\t\t\t\t\tfs_error();\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\"writestart progress write abort\".split(\" \").forEach(function(event) {\n\t\t\t\t\t\t\t\t\twriter[\"on\" + event] = filesaver[\"on\" + event];\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\twriter.write(blob);\n\t\t\t\t\t\t\t\tfilesaver.abort = function() {\n\t\t\t\t\t\t\t\t\twriter.abort();\n\t\t\t\t\t\t\t\t\tfilesaver.readyState = filesaver.DONE;\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tfilesaver.readyState = filesaver.WRITING;\n\t\t\t\t\t\t\t}), fs_error);\n\t\t\t\t\t\t}), fs_error);\n\t\t\t\t\t};\n\t\t\t\t\tdir.getFile(name, {create: false}, abortable(function(file) {\n\t\t\t\t\t\t// delete file if it already exists\n\t\t\t\t\t\tfile.remove();\n\t\t\t\t\t\tsave();\n\t\t\t\t\t}), abortable(function(ex) {\n\t\t\t\t\t\tif (ex.code === ex.NOT_FOUND_ERR) {\n\t\t\t\t\t\t\tsave();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tfs_error();\n\t\t\t\t\t\t}\n\t\t\t\t\t}));\n\t\t\t\t}), fs_error);\n\t\t\t}), fs_error);\n\t\t}\n\t\t, FS_proto = FileSaver.prototype\n\t\t, saveAs = function(blob, name, no_auto_bom) {\n\t\t\treturn new FileSaver(blob, name, no_auto_bom);\n\t\t}\n\t;\n\t// IE 10+ (native saveAs)\n\tif (typeof navigator !== \"undefined\" && navigator.msSaveOrOpenBlob) {\n\t\treturn function(blob, name, no_auto_bom) {\n\t\t\tif (!no_auto_bom) {\n\t\t\t\tblob = auto_bom(blob);\n\t\t\t}\n\t\t\treturn navigator.msSaveOrOpenBlob(blob, name || \"download\");\n\t\t};\n\t}\n\n\tFS_proto.abort = function() {\n\t\tvar filesaver = this;\n\t\tfilesaver.readyState = filesaver.DONE;\n\t\tdispatch(filesaver, \"abort\");\n\t};\n\tFS_proto.readyState = FS_proto.INIT = 0;\n\tFS_proto.WRITING = 1;\n\tFS_proto.DONE = 2;\n\n\tFS_proto.error =\n\tFS_proto.onwritestart =\n\tFS_proto.onprogress =\n\tFS_proto.onwrite =\n\tFS_proto.onabort =\n\tFS_proto.onerror =\n\tFS_proto.onwriteend =\n\t\tnull;\n\n\treturn saveAs;\n}(\n\t   typeof self !== \"undefined\" && self\n\t|| typeof window !== \"undefined\" && window\n\t|| this.content\n));\n\n\n// Expose file saver on the DataTables API. Can't attach to `DataTables.Buttons`\n// since this file can be loaded before Button's core!\nDataTable.fileSave = _saveAs;\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * Local (private) functions\n */\n\n/**\n * Get the file name for an exported file.\n *\n * @param {object}\tconfig Button configuration\n * @param {boolean} incExtension Include the file name extension\n */\nvar _filename = function ( config, incExtension )\n{\n\t// Backwards compatibility\n\tvar filename = config.filename === '*' && config.title !== '*' && config.title !== undefined ?\n\t\tconfig.title :\n\t\tconfig.filename;\n\n\tif ( typeof filename === 'function' ) {\n\t\tfilename = filename();\n\t}\n\n\tif ( filename.indexOf( '*' ) !== -1 ) {\n\t\tfilename = $.trim( filename.replace( '*', $('title').text() ) );\n\t}\n\n\t// Strip characters which the OS will object to\n\tfilename = filename.replace(/[^a-zA-Z0-9_\\u00A1-\\uFFFF\\.,\\-_ !\\(\\)]/g, \"\");\n\n\treturn incExtension === undefined || incExtension === true ?\n\t\tfilename+config.extension :\n\t\tfilename;\n};\n\n/**\n * Get the sheet name for Excel exports.\n *\n * @param {object}\tconfig Button configuration\n */\nvar _sheetname = function ( config )\n{\n\tvar sheetName = 'Sheet1';\n\n\tif ( config.sheetName ) {\n\t\tsheetName = config.sheetName.replace(/[\\[\\]\\*\\/\\\\\\?\\:]/g, '');\n\t}\n\nreturn sheetName;\n};\n\n/**\n * Get the title for an exported file.\n *\n * @param {object} config\tButton configuration\n */\nvar _title = function ( config )\n{\n\tvar title = config.title;\n\n\tif ( typeof title === 'function' ) {\n\t\ttitle = title();\n\t}\n\n\treturn title.indexOf( '*' ) !== -1 ?\n\t\ttitle.replace( '*', $('title').text() || 'Exported data' ) :\n\t\ttitle;\n};\n\n/**\n * Get the newline character(s)\n *\n * @param {object}\tconfig Button configuration\n * @return {string}\t\t\t\tNewline character\n */\nvar _newLine = function ( config )\n{\n\treturn config.newline ?\n\t\tconfig.newline :\n\t\tnavigator.userAgent.match(/Windows/) ?\n\t\t\t'\\r\\n' :\n\t\t\t'\\n';\n};\n\n/**\n * Combine the data from the `buttons.exportData` method into a string that\n * will be used in the export file.\n *\n * @param\t{DataTable.Api} dt\t\t DataTables API instance\n * @param\t{object}\t\t\t\tconfig Button configuration\n * @return {object}\t\t\t\t\t\t\t The data to export\n */\nvar _exportData = function ( dt, config )\n{\n\tvar newLine = _newLine( config );\n\tvar data = dt.buttons.exportData( config.exportOptions );\n\tvar boundary = config.fieldBoundary;\n\tvar separator = config.fieldSeparator;\n\tvar reBoundary = new RegExp( boundary, 'g' );\n\tvar escapeChar = config.escapeChar !== undefined ?\n\t\tconfig.escapeChar :\n\t\t'\\\\';\n\tvar join = function ( a ) {\n\t\tvar s = '';\n\n\t\t// If there is a field boundary, then we might need to escape it in\n\t\t// the source data\n\t\tfor ( var i=0, ien=a.length ; i<ien ; i++ ) {\n\t\t\tif ( i > 0 ) {\n\t\t\t\ts += separator;\n\t\t\t}\n\n\t\t\ts += boundary ?\n\t\t\t\tboundary + ('' + a[i]).replace( reBoundary, escapeChar+boundary ) + boundary :\n\t\t\t\ta[i];\n\t\t}\n\n\t\treturn s;\n\t};\n\n\tvar header = config.header ? join( data.header )+newLine : '';\n\tvar footer = config.footer && data.footer ? newLine+join( data.footer ) : '';\n\tvar body = [];\n\n\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\n\t\tbody.push( join( data.body[i] ) );\n\t}\n\n\treturn {\n\t\tstr: header + body.join( newLine ) + footer,\n\t\trows: body.length\n\t};\n};\n\n/**\n * Safari's data: support for creating and downloading files is really poor, so\n * various options need to be disabled in it. See\n * https://bugs.webkit.org/show_bug.cgi?id=102914\n *\n * @return {Boolean} `true` if Safari\n */\nvar _isSafari = function ()\n{\n\treturn navigator.userAgent.indexOf('Safari') !== -1 &&\n\t\tnavigator.userAgent.indexOf('Chrome') === -1 &&\n\t\tnavigator.userAgent.indexOf('Opera') === -1;\n};\n\n/**\n * Convert from numeric position to letter for column names in Excel\n * @param  {int} n Column number\n * @return {string} Column letter(s) name\n */\nfunction createCellPos( n ){\n\tvar ordA = 'A'.charCodeAt(0);\n\tvar ordZ = 'Z'.charCodeAt(0);\n\tvar len = ordZ - ordA + 1;\n\tvar s = \"\";\n\n\twhile( n >= 0 ) {\n\t\ts = String.fromCharCode(n % len + ordA) + s;\n\t\tn = Math.floor(n / len) - 1;\n\t}\n\n\treturn s;\n}\n\ntry {\n\tvar _serialiser = new XMLSerializer();\n\tvar _ieExcel;\n}\ncatch (t) {}\n\n/**\n * Recursively add XML files from an object's structure to a ZIP file. This\n * allows the XSLX file to be easily defined with an object's structure matching\n * the files structure.\n *\n * @param {JSZip} zip ZIP package\n * @param {object} obj Object to add (recursive)\n */\nfunction _addToZip( zip, obj ) {\n\tif ( _ieExcel === undefined ) {\n\t\t// Detect if we are dealing with IE's _awful_ serialiser by seeing if it\n\t\t// drop attributes\n\t\t_ieExcel = _serialiser\n\t\t\t.serializeToString(\n\t\t\t\t$.parseXML( excelStrings['xl/worksheets/sheet1.xml'] )\n\t\t\t)\n\t\t\t.indexOf( 'xmlns:r' ) === -1;\n\t}\n\n\t$.each( obj, function ( name, val ) {\n\t\tif ( $.isPlainObject( val ) ) {\n\t\t\tvar newDir = zip.folder( name );\n\t\t\t_addToZip( newDir, val );\n\t\t}\n\t\telse {\n\t\t\tif ( _ieExcel ) {\n\t\t\t\t// IE's XML serialiser will drop some name space attributes from\n\t\t\t\t// from the root node, so we need to save them. Do this by\n\t\t\t\t// replacing the namespace nodes with a regular attribute that\n\t\t\t\t// we convert back when serialised. Edge does not have this\n\t\t\t\t// issue\n\t\t\t\tvar worksheet = val.childNodes[0];\n\t\t\t\tvar i, ien;\n\t\t\t\tvar attrs = [];\n\n\t\t\t\tfor ( i=worksheet.attributes.length-1 ; i>=0 ; i-- ) {\n\t\t\t\t\tvar attrName = worksheet.attributes[i].nodeName;\n\t\t\t\t\tvar attrValue = worksheet.attributes[i].nodeValue;\n\n\t\t\t\t\tif ( attrName.indexOf( ':' ) !== -1 ) {\n\t\t\t\t\t\tattrs.push( { name: attrName, value: attrValue } );\n\n\t\t\t\t\t\tworksheet.removeAttribute( attrName );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfor ( i=0, ien=attrs.length ; i<ien ; i++ ) {\n\t\t\t\t\tvar attr = val.createAttribute( attrs[i].name.replace( ':', '_dt_b_namespace_token_' ) );\n\t\t\t\t\tattr.value = attrs[i].value;\n\t\t\t\t\tworksheet.setAttributeNode( attr );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvar str = _serialiser.serializeToString(val);\n\n\t\t\t// Fix IE's XML\n\t\t\tif ( _ieExcel ) {\n\t\t\t\t// IE doesn't include the XML declaration\n\t\t\t\tif ( str.indexOf( '<?xml' ) === -1 ) {\n\t\t\t\t\tstr = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+str;\n\t\t\t\t}\n\n\t\t\t\t// Return namespace attributes to being as such\n\t\t\t\tstr = str.replace( /_dt_b_namespace_token_/g, ':' );\n\t\t\t}\n\n\t\t\t// Both IE and Edge will put empty name space attributes onto the\n\t\t\t// rows and columns making them useless\n\t\t\tstr = str\n\t\t\t\t.replace( /<row xmlns=\"\" /g, '<row ' )\n\t\t\t\t.replace( /<cols xmlns=\"\">/g, '<cols>' );\n\n\t\t\tzip.file( name, str );\n\t\t}\n\t} );\n}\n\n/**\n * Create an XML node and add any children, attributes, etc without needing to\n * be verbose in the DOM.\n *\n * @param  {object} doc      XML document\n * @param  {string} nodeName Node name\n * @param  {object} opts     Options - can be `attr` (attributes), `children`\n *   (child nodes) and `text` (text content)\n * @return {node}            Created node\n */\nfunction _createNode( doc, nodeName, opts ) {\n\tvar tempNode = doc.createElement( nodeName );\n\n\tif ( opts ) {\n\t\tif ( opts.attr ) {\n\t\t\t$(tempNode).attr( opts.attr );\n\t\t}\n\n\t\tif( opts.children ) {\n\t\t\t$.each( opts.children, function ( key, value ) {\n\t\t\t\ttempNode.appendChild( value );\n\t\t\t});\n\t\t}\n\n\t\tif( opts.text ) {\n\t\t\ttempNode.appendChild( doc.createTextNode( opts.text ) );\n\t\t}\n\t}\n\n\treturn tempNode;\n}\n\n/**\n * Get the width for an Excel column based on the contents of that column\n * @param  {object} data Data for export\n * @param  {int}    col  Column index\n * @return {int}         Column width\n */\nfunction _excelColWidth( data, col ) {\n\tvar max = data.header[col].length;\n\tvar len;\n\n\tif ( data.footer && data.footer[col].length > max ) {\n\t\tmax = data.footer[col].length;\n\t}\n\n\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\n\t\tlen = data.body[i][col].toString().length;\n\n\t\tif ( len > max ) {\n\t\t\tmax = len;\n\t\t}\n\n\t\t// Max width rather than having potentially massive column widths\n\t\tif ( max > 40 ) {\n\t\t\tbreak;\n\t\t}\n\t}\n\n\t// And a min width\n\treturn max > 5 ? max : 5;\n}\n\n// Excel - Pre-defined strings to build a basic XLSX file\nvar excelStrings = {\n\t\"_rels/.rels\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'+\n\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument\" Target=\"xl/workbook.xml\"/>'+\n\t\t'</Relationships>',\n\n\t\"xl/_rels/workbook.xml.rels\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Relationships xmlns=\"http://schemas.openxmlformats.org/package/2006/relationships\">'+\n\t\t\t'<Relationship Id=\"rId1\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet\" Target=\"worksheets/sheet1.xml\"/>'+\n\t\t\t'<Relationship Id=\"rId2\" Type=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles\" Target=\"styles.xml\"/>'+\n\t\t'</Relationships>',\n\n\t\"[Content_Types].xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<Types xmlns=\"http://schemas.openxmlformats.org/package/2006/content-types\">'+\n\t\t\t'<Default Extension=\"xml\" ContentType=\"application/xml\" />'+\n\t\t\t'<Default Extension=\"rels\" ContentType=\"application/vnd.openxmlformats-package.relationships+xml\" />'+\n\t\t\t'<Default Extension=\"jpeg\" ContentType=\"image/jpeg\" />'+\n\t\t\t'<Override PartName=\"/xl/workbook.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml\" />'+\n\t\t\t'<Override PartName=\"/xl/worksheets/sheet1.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml\" />'+\n\t\t\t'<Override PartName=\"/xl/styles.xml\" ContentType=\"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml\" />'+\n\t\t'</Types>',\n\n\t\"xl/workbook.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<workbook xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\">'+\n\t\t\t'<fileVersion appName=\"xl\" lastEdited=\"5\" lowestEdited=\"5\" rupBuild=\"24816\"/>'+\n\t\t\t'<workbookPr showInkAnnotation=\"0\" autoCompressPictures=\"0\"/>'+\n\t\t\t'<bookViews>'+\n\t\t\t\t'<workbookView xWindow=\"0\" yWindow=\"0\" windowWidth=\"25600\" windowHeight=\"19020\" tabRatio=\"500\"/>'+\n\t\t\t'</bookViews>'+\n\t\t\t'<sheets>'+\n\t\t\t\t'<sheet name=\"\" sheetId=\"1\" r:id=\"rId1\"/>'+\n\t\t\t'</sheets>'+\n\t\t'</workbook>',\n\n\t\"xl/worksheets/sheet1.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>'+\n\t\t'<worksheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:r=\"http://schemas.openxmlformats.org/officeDocument/2006/relationships\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'+\n\t\t\t'<sheetData/>'+\n\t\t'</worksheet>',\n\n\t\"xl/styles.xml\":\n\t\t'<?xml version=\"1.0\" encoding=\"UTF-8\"?>'+\n\t\t'<styleSheet xmlns=\"http://schemas.openxmlformats.org/spreadsheetml/2006/main\" xmlns:mc=\"http://schemas.openxmlformats.org/markup-compatibility/2006\" mc:Ignorable=\"x14ac\" xmlns:x14ac=\"http://schemas.microsoft.com/office/spreadsheetml/2009/9/ac\">'+\n\t\t\t'<fonts count=\"5\" x14ac:knownFonts=\"1\">'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<color rgb=\"FFFFFFFF\" />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<b />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<i />'+\n\t\t\t\t'</font>'+\n\t\t\t\t'<font>'+\n\t\t\t\t\t'<sz val=\"11\" />'+\n\t\t\t\t\t'<name val=\"Calibri\" />'+\n\t\t\t\t\t'<u />'+\n\t\t\t\t'</font>'+\n\t\t\t'</fonts>'+\n\t\t\t'<fills count=\"6\">'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"none\" />'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill/>'+ // Excel appears to use this as a dotted background regardless of values\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"FFD9D9D9\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"FFD99795\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"ffc6efce\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t\t'<fill>'+\n\t\t\t\t\t'<patternFill patternType=\"solid\">'+\n\t\t\t\t\t\t'<fgColor rgb=\"ffc6cfef\" />'+\n\t\t\t\t\t\t'<bgColor indexed=\"64\" />'+\n\t\t\t\t\t'</patternFill>'+\n\t\t\t\t'</fill>'+\n\t\t\t'</fills>'+\n\t\t\t'<borders count=\"2\">'+\n\t\t\t\t'<border>'+\n\t\t\t\t\t'<left />'+\n\t\t\t\t\t'<right />'+\n\t\t\t\t\t'<top />'+\n\t\t\t\t\t'<bottom />'+\n\t\t\t\t\t'<diagonal />'+\n\t\t\t\t'</border>'+\n\t\t\t\t'<border diagonalUp=\"false\" diagonalDown=\"false\">'+\n\t\t\t\t\t'<left style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</left>'+\n\t\t\t\t\t'<right style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</right>'+\n\t\t\t\t\t'<top style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</top>'+\n\t\t\t\t\t'<bottom style=\"thin\">'+\n\t\t\t\t\t\t'<color auto=\"1\" />'+\n\t\t\t\t\t'</bottom>'+\n\t\t\t\t\t'<diagonal />'+\n\t\t\t\t'</border>'+\n\t\t\t'</borders>'+\n\t\t\t'<cellStyleXfs count=\"1\">'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" />'+\n\t\t\t'</cellStyleXfs>'+\n\t\t\t'<cellXfs count=\"56\">'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"0\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"2\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"3\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"4\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"1\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"2\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"3\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"4\" fillId=\"5\" borderId=\"1\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\"/>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"left\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"center\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"right\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment horizontal=\"fill\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment textRotation=\"90\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t\t'<xf numFmtId=\"0\" fontId=\"0\" fillId=\"0\" borderId=\"0\" applyFont=\"1\" applyFill=\"1\" applyBorder=\"1\" xfId=\"0\" applyAlignment=\"1\">'+\n\t\t\t\t\t'<alignment wrapText=\"1\"/>'+\n\t\t\t\t'</xf>'+\n\t\t\t'</cellXfs>'+\n\t\t\t'<cellStyles count=\"1\">'+\n\t\t\t\t'<cellStyle name=\"Normal\" xfId=\"0\" builtinId=\"0\" />'+\n\t\t\t'</cellStyles>'+\n\t\t\t'<dxfs count=\"0\" />'+\n\t\t\t'<tableStyles count=\"0\" defaultTableStyle=\"TableStyleMedium9\" defaultPivotStyle=\"PivotStyleMedium4\" />'+\n\t\t'</styleSheet>'\n};\n// Note we could use 3 `for` loops for the styles, but when gzipped there is\n// virtually no difference in size, since the above can be easily compressed\n\n\n\n/* * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *\n * Buttons\n */\n\n//\n// Copy to clipboard\n//\nDataTable.ext.buttons.copyHtml5 = {\n\tclassName: 'buttons-copy buttons-html5',\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.copy', 'Copy' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tvar exportData = _exportData( dt, config );\n\t\tvar output = exportData.str;\n\t\tvar hiddenDiv = $('<div/>')\n\t\t\t.css( {\n\t\t\t\theight: 1,\n\t\t\t\twidth: 1,\n\t\t\t\toverflow: 'hidden',\n\t\t\t\tposition: 'fixed',\n\t\t\t\ttop: 0,\n\t\t\t\tleft: 0\n\t\t\t} );\n\n\t\tif ( config.customize ) {\n\t\t\toutput = config.customize( output, config );\n\t\t}\n\n\t\tvar textarea = $('<textarea readonly/>')\n\t\t\t.val( output )\n\t\t\t.appendTo( hiddenDiv );\n\n\t\t// For browsers that support the copy execCommand, try to use it\n\t\tif ( document.queryCommandSupported('copy') ) {\n\t\t\thiddenDiv.appendTo( dt.table().container() );\n\t\t\ttextarea[0].focus();\n\t\t\ttextarea[0].select();\n\n\t\t\ttry {\n\t\t\t\tvar successful = document.execCommand( 'copy' );\n\t\t\t\thiddenDiv.remove();\n\n\t\t\t\tif (successful) {\n\t\t\t\t\tdt.buttons.info(\n\t\t\t\t\t\tdt.i18n( 'buttons.copyTitle', 'Copy to clipboard' ),\n\t\t\t\t\t\tdt.i18n( 'buttons.copySuccess', {\n\t\t\t\t\t\t\t1: 'Copied one row to clipboard',\n\t\t\t\t\t\t\t_: 'Copied %d rows to clipboard'\n\t\t\t\t\t\t}, exportData.rows ),\n\t\t\t\t\t\t2000\n\t\t\t\t\t);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (t) {}\n\t\t}\n\n\t\t// Otherwise we show the text box and instruct the user to use it\n\t\tvar message = $('<span>'+dt.i18n( 'buttons.copyKeys',\n\t\t\t\t'Press <i>ctrl</i> or <i>\\u2318</i> + <i>C</i> to copy the table data<br>to your system clipboard.<br><br>'+\n\t\t\t\t'To cancel, click this message or press escape.' )+'</span>'\n\t\t\t)\n\t\t\t.append( hiddenDiv );\n\n\t\tdt.buttons.info( dt.i18n( 'buttons.copyTitle', 'Copy to clipboard' ), message, 0 );\n\n\t\t// Select the text so when the user activates their system clipboard\n\t\t// it will copy that text\n\t\ttextarea[0].focus();\n\t\ttextarea[0].select();\n\n\t\t// Event to hide the message when the user is done\n\t\tvar container = $(message).closest('.dt-button-info');\n\t\tvar close = function () {\n\t\t\tcontainer.off( 'click.buttons-copy' );\n\t\t\t$(document).off( '.buttons-copy' );\n\t\t\tdt.buttons.info( false );\n\t\t};\n\n\t\tcontainer.on( 'click.buttons-copy', close );\n\t\t$(document)\n\t\t\t.on( 'keydown.buttons-copy', function (e) {\n\t\t\t\tif ( e.keyCode === 27 ) { // esc\n\t\t\t\t\tclose();\n\t\t\t\t}\n\t\t\t} )\n\t\t\t.on( 'copy.buttons-copy cut.buttons-copy', function () {\n\t\t\t\tclose();\n\t\t\t} );\n\t},\n\n\texportOptions: {},\n\n\tfieldSeparator: '\\t',\n\n\tfieldBoundary: '',\n\n\theader: true,\n\n\tfooter: false\n};\n\n//\n// CSV export\n//\nDataTable.ext.buttons.csvHtml5 = {\n\tbom: false,\n\n\tclassName: 'buttons-csv buttons-html5',\n\n\tavailable: function () {\n\t\treturn window.FileReader !== undefined && window.Blob;\n\t},\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.csv', 'CSV' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\t// Set the text\n\t\tvar output = _exportData( dt, config ).str;\n\t\tvar charset = config.charset;\n\n\t\tif ( config.customize ) {\n\t\t\toutput = config.customize( output, config );\n\t\t}\n\n\t\tif ( charset !== false ) {\n\t\t\tif ( ! charset ) {\n\t\t\t\tcharset = document.characterSet || document.charset;\n\t\t\t}\n\n\t\t\tif ( charset ) {\n\t\t\t\tcharset = ';charset='+charset;\n\t\t\t}\n\t\t}\n\t\telse {\n\t\t\tcharset = '';\n\t\t}\n\n\t\tif ( config.bom ) {\n\t\t\toutput = '\\ufeff' + output;\n\t\t}\n\n\t\t_saveAs(\n\t\t\tnew Blob( [output], {type: 'text/csv'+charset} ),\n\t\t\t_filename( config ),\n\t\t\ttrue\n\t\t);\n\t},\n\n\tfilename: '*',\n\n\textension: '.csv',\n\n\texportOptions: {},\n\n\tfieldSeparator: ',',\n\n\tfieldBoundary: '\"',\n\n\tescapeChar: '\"',\n\n\tcharset: null,\n\n\theader: true,\n\n\tfooter: false\n};\n\n//\n// Excel (xlsx) export\n//\nDataTable.ext.buttons.excelHtml5 = {\n\tclassName: 'buttons-excel buttons-html5',\n\n\tavailable: function () {\n\t\treturn window.FileReader !== undefined && _jsZip() !== undefined && ! _isSafari() && _serialiser;\n\t},\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.excel', 'Excel' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tvar rowPos = 0;\n\t\tvar getXml = function ( type ) {\n\t\t\tvar str = excelStrings[ type ];\n\n\t\t\t//str = str.replace( /xmlns:/g, 'xmlns_' ).replace( /mc:/g, 'mc_' );\n\n\t\t\treturn $.parseXML( str );\n\t\t};\n\t\tvar rels = getXml('xl/worksheets/sheet1.xml');\n\t\tvar relsGet = rels.getElementsByTagName( \"sheetData\" )[0];\n\n\t\tvar xlsx = {\n\t\t\t_rels: {\n\t\t\t\t\".rels\": getXml('_rels/.rels')\n\t\t\t},\n\t\t\txl: {\n\t\t\t\t_rels: {\n\t\t\t\t\t\"workbook.xml.rels\": getXml('xl/_rels/workbook.xml.rels')\n\t\t\t\t},\n\t\t\t\t\"workbook.xml\": getXml('xl/workbook.xml'),\n\t\t\t\t\"styles.xml\": getXml('xl/styles.xml'),\n\t\t\t\t\"worksheets\": {\n\t\t\t\t\t\"sheet1.xml\": rels\n\t\t\t\t}\n\n\t\t\t},\n\t\t\t\"[Content_Types].xml\": getXml('[Content_Types].xml')\n\t\t};\n\n\t\tvar data = dt.buttons.exportData( config.exportOptions );\n\t\tvar currentRow, rowNode;\n\t\tvar addRow = function ( row ) {\n\t\t\tcurrentRow = rowPos+1;\n\t\t\trowNode = _createNode( rels, \"row\", { attr: {r:currentRow} } );\n\n\t\t\tfor ( var i=0, ien=row.length ; i<ien ; i++ ) {\n\t\t\t\t// Concat both the Cell Columns as a letter and the Row of the cell.\n\t\t\t\tvar cellId = createCellPos(i) + '' + currentRow;\n\t\t\t\tvar cell;\n\n\t\t\t\tif ( row[i] === null || row[i] === undefined ) {\n\t\t\t\t\trow[i] = '';\n\t\t\t\t}\n\n\t\t\t\t// Detect numbers - don't match numbers with leading zeros or a negative\n\t\t\t\t// anywhere but the start\n\t\t\t\tif ( typeof row[i] === 'number' || (\n\t\t\t\t\t\trow[i].match &&\n\t\t\t\t\t\t$.trim(row[i]).match(/^-?\\d+(\\.\\d+)?$/) &&\n\t\t\t\t\t\t! $.trim(row[i]).match(/^0\\d+/) )\n\t\t\t\t) {\n\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\tt: 'n',\n\t\t\t\t\t\t\tr: cellId\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchildren: [\n\t\t\t\t\t\t\t_createNode( rels, 'v', { text: row[i] } )\n\t\t\t\t\t\t]\n\t\t\t\t\t} );\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Replace non standard characters for text output\n\t\t\t\t\tvar text = ! row[i].replace ?\n\t\t\t\t\t\trow[i] :\n\t\t\t\t\t\trow[i].replace(/[\\x00-\\x09\\x0B\\x0C\\x0E-\\x1F\\x7F-\\x9F]/g, '');\n\n\t\t\t\t\tcell = _createNode( rels, 'c', {\n\t\t\t\t\t\tattr: {\n\t\t\t\t\t\t\tt: 'inlineStr',\n\t\t\t\t\t\t\tr: cellId\n\t\t\t\t\t\t},\n\t\t\t\t\t\tchildren:{\n\t\t\t\t\t\t\trow: _createNode( rels, 'is', {\n\t\t\t\t\t\t\t\tchildren: {\n\t\t\t\t\t\t\t\t\trow: _createNode( rels, 't', {\n\t\t\t\t\t\t\t\t\t\ttext: text\n\t\t\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} )\n\t\t\t\t\t\t}\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\trowNode.appendChild( cell );\n\t\t\t}\n\t\t\trelsGet.appendChild(rowNode);\n\t\t\trowPos++;\n\t\t};\n\n\t\t$( 'sheets sheet', xlsx.xl['workbook.xml'] ).attr( 'name', _sheetname( config ) );\n\n\t\tif ( config.customizeData ) {\n\t\t\tconfig.customizeData( data );\n\t\t}\n\n\t\tif ( config.header ) {\n\t\t\taddRow( data.header, rowPos );\n\t\t\t$('row c', rels).attr( 's', '2' ); // bold\n\t\t}\n\n\t\tfor ( var n=0, ie=data.body.length ; n<ie ; n++ ) {\n\t\t\taddRow( data.body[n], rowPos );\n\t\t}\n\n\t\tif ( config.footer && data.footer ) {\n\t\t\taddRow( data.footer, rowPos);\n\t\t\t$('row:last c', rels).attr( 's', '2' ); // bold\n\t\t}\n\n\t\t// Set column widths\n\t\tvar cols = _createNode( rels, 'cols' );\n\t\t$('worksheet', rels).prepend( cols );\n\n\t\tfor ( var i=0, ien=data.header.length ; i<ien ; i++ ) {\n\t\t\tcols.appendChild( _createNode( rels, 'col', {\n\t\t\t\tattr: {\n\t\t\t\t\tmin: i+1,\n\t\t\t\t\tmax: i+1,\n\t\t\t\t\twidth: _excelColWidth( data, i ),\n\t\t\t\t\tcustomWidth: 1\n\t\t\t\t}\n\t\t\t} ) );\n\t\t}\n\n\t\t// Let the developer customise the document if they want to\n\t\tif ( config.customize ) {\n\t\t\tconfig.customize( xlsx );\n\t\t}\n\n\t\tvar jszip = _jsZip();\n\t\tvar zip = new jszip();\n\t\tvar zipConfig = {\n\t\t\ttype: 'blob',\n\t\t\tmimeType: 'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet'\n\t\t};\n\n\t\t_addToZip( zip, xlsx );\n\n\t\tif ( zip.generateAsync ) {\n\t\t\t// JSZip 3+\n\t\t\tzip\n\t\t\t\t.generateAsync( zipConfig )\n\t\t\t\t.then( function ( blob ) {\n\t\t\t\t\t_saveAs( blob, _filename( config ) );\n\t\t\t\t} );\n\t\t}\n\t\telse {\n\t\t\t// JSZip 2.5\n\t\t\t_saveAs(\n\t\t\t\tzip.generate( zipConfig ),\n\t\t\t\t_filename( config )\n\t\t\t);\n\t\t}\n\t},\n\n\tfilename: '*',\n\n\textension: '.xlsx',\n\n\texportOptions: {},\n\n\theader: true,\n\n\tfooter: false\n};\n\n//\n// PDF export - using pdfMake - http://pdfmake.org\n//\nDataTable.ext.buttons.pdfHtml5 = {\n\tclassName: 'buttons-pdf buttons-html5',\n\n\tavailable: function () {\n\t\treturn window.FileReader !== undefined && _pdfMake();\n\t},\n\n\ttext: function ( dt ) {\n\t\treturn dt.i18n( 'buttons.pdf', 'PDF' );\n\t},\n\n\taction: function ( e, dt, button, config ) {\n\t\tvar newLine = _newLine( config );\n\t\tvar data = dt.buttons.exportData( config.exportOptions );\n\t\tvar rows = [];\n\n\t\tif ( config.header ) {\n\t\t\trows.push( $.map( data.header, function ( d ) {\n\t\t\t\treturn {\n\t\t\t\t\ttext: typeof d === 'string' ? d : d+'',\n\t\t\t\t\tstyle: 'tableHeader'\n\t\t\t\t};\n\t\t\t} ) );\n\t\t}\n\n\t\tfor ( var i=0, ien=data.body.length ; i<ien ; i++ ) {\n\t\t\trows.push( $.map( data.body[i], function ( d ) {\n\t\t\t\treturn {\n\t\t\t\t\ttext: typeof d === 'string' ? d : d+'',\n\t\t\t\t\tstyle: i % 2 ? 'tableBodyEven' : 'tableBodyOdd'\n\t\t\t\t};\n\t\t\t} ) );\n\t\t}\n\n\t\tif ( config.footer && data.footer) {\n\t\t\trows.push( $.map( data.footer, function ( d ) {\n\t\t\t\treturn {\n\t\t\t\t\ttext: typeof d === 'string' ? d : d+'',\n\t\t\t\t\tstyle: 'tableFooter'\n\t\t\t\t};\n\t\t\t} ) );\n\t\t}\n\n\t\tvar doc = {\n\t\t\tpageSize: config.pageSize,\n\t\t\tpageOrientation: config.orientation,\n\t\t\tcontent: [\n\t\t\t\t{\n\t\t\t\t\ttable: {\n\t\t\t\t\t\theaderRows: 1,\n\t\t\t\t\t\tbody: rows\n\t\t\t\t\t},\n\t\t\t\t\tlayout: 'noBorders'\n\t\t\t\t}\n\t\t\t],\n\t\t\tstyles: {\n\t\t\t\ttableHeader: {\n\t\t\t\t\tbold: true,\n\t\t\t\t\tfontSize: 11,\n\t\t\t\t\tcolor: 'white',\n\t\t\t\t\tfillColor: '#2d4154',\n\t\t\t\t\talignment: 'center'\n\t\t\t\t},\n\t\t\t\ttableBodyEven: {},\n\t\t\t\ttableBodyOdd: {\n\t\t\t\t\tfillColor: '#f3f3f3'\n\t\t\t\t},\n\t\t\t\ttableFooter: {\n\t\t\t\t\tbold: true,\n\t\t\t\t\tfontSize: 11,\n\t\t\t\t\tcolor: 'white',\n\t\t\t\t\tfillColor: '#2d4154'\n\t\t\t\t},\n\t\t\t\ttitle: {\n\t\t\t\t\talignment: 'center',\n\t\t\t\t\tfontSize: 15\n\t\t\t\t},\n\t\t\t\tmessage: {}\n\t\t\t},\n\t\t\tdefaultStyle: {\n\t\t\t\tfontSize: 10\n\t\t\t}\n\t\t};\n\n\t\tif ( config.message ) {\n      doc.content.unshift( {\n        text: typeof config.message == 'function' ? config.message(dt, button, config) : config.message,\n        style: 'message',\n        margin: [ 0, 0, 0, 12 ]\n      } );\n\t\t}\n\n\t\tif ( config.title ) {\n\t\t\tdoc.content.unshift( {\n\t\t\t\ttext: _title( config, false ),\n\t\t\t\tstyle: 'title',\n\t\t\t\tmargin: [ 0, 0, 0, 12 ]\n\t\t\t} );\n\t\t}\n\n\t\tif ( config.customize ) {\n\t\t\tconfig.customize( doc, config );\n\t\t}\n\n\t\tvar pdf = _pdfMake().createPdf( doc );\n\n\t\tif ( config.download === 'open' && ! _isSafari() ) {\n\t\t\tpdf.open();\n\t\t}\n\t\telse {\n\t\t\tpdf.getBuffer( function (buffer) {\n\t\t\t\tvar blob = new Blob( [buffer], {type:'application/pdf'} );\n\n\t\t\t\t_saveAs( blob, _filename( config ) );\n\t\t\t} );\n\t\t}\n\t},\n\n\ttitle: '*',\n\n\tfilename: '*',\n\n\textension: '.pdf',\n\n\texportOptions: {},\n\n\torientation: 'portrait',\n\n\tpageSize: 'A4',\n\n\theader: true,\n\n\tfooter: false,\n\n\tmessage: null,\n\n\tcustomize: null,\n\n\tdownload: 'download'\n};\n\n\nreturn DataTable.Buttons;\n}));\n"]},"metadata":{},"sourceType":"module"}